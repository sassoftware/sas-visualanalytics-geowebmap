(function(){var e={"esri/layers/graphics/sources/support/MemorySourceWorker":1343,"esri/core/libs/quickselect/quickselect":1409,"esri/core/libs/rbush/rbush":1414,"esri/layers/graphics/data/FeatureStore":1427,"esri/layers/graphics/data/executeTileQuery":1433,"esri/layers/graphics/data/BoundsStore":1443,"esri/layers/graphics/sources/support/clientSideDefaults":1470,"esri/layers/graphics/sources/support/sourceUtils":1647},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1343:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(0),i(11),i(4),i(29),i(76),i(412),i(1427),i(1397),i(1402),i(1470),i(1647),i(413),i(440),i(66)],void 0===(r=function(e,t,i,n,r,o,s,a,u,l,d,h,c,f,p,m){Object.defineProperty(t,"__esModule",{value:!0});var y=s.WGS84,g={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:s.WGS84},_={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};function v(e){return o.isPoint(e)?null!=e.z:!!e.hasZ}function b(e){return o.isPoint(e)?null!=e.m:!!e.hasM}var I=function(){function e(){this._queryEngine=null,this._nextObjectId=null}return e.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null},e.prototype.load=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r,o,s,a,c,v,b,I,x,F,B,M,E,j,w,T,S,Y,P,X,q,O,R,D;return i.__generator(this,(function(G){switch(G.label){case 0:if(t=[],r=e.features,o=this._inferLayerProperties(r,e.fields),s=e.fields||[],a=null!=e.hasM?e.hasM:o.hasM,c=null!=e.hasZ?e.hasZ:o.hasZ,v=!e.spatialReference&&!o.spatialReference,b=v?y:e.spatialReference||o.spatialReference,I=v?g:null,x=e.geometryType||o.geometryType,F=e.objectIdField||o.objectIdField,B=e.timeInfo,v&&t.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!x)throw new n("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!F)throw new n("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");for(o.objectIdField&&F!==o.objectIdField&&(t.push({name:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'+F+'" doesn\'t match the field name "'+o.objectIdField+'", found in the provided fields'}),F=o.objectIdField),F&&!o.objectIdField&&(M=null,s.some((function(e){return e.name===F&&(M=e,!0)}))?(M.type="esriFieldTypeOID",M.editable=!1,M.nullable=!1):s.unshift({alias:F,name:F,type:"esriFieldTypeOID",editable:!1,nullable:!1})),E=0,j=s;E<j.length;E++){if(null==(Y=j[E]).name&&(Y.name=Y.alias),null==Y.alias&&(Y.alias=Y.name),!Y.name)throw new n("feature-layer:invalid-field-name","field name is missing",{field:Y});if(Y.name===F&&(Y.type="esriFieldTypeOID"),-1===p.kebabDict.jsonValues.indexOf(Y.type))throw new n("feature-layer:invalid-field-type",'invalid type for field "'+Y.name+'"',{field:Y})}for(w={},this._requiredFields=[],T=0,S=s;T<S.length;T++)"esriFieldTypeOID"!==(Y=S[T]).type&&"esriFieldTypeGlobalID"!==Y.type&&(Y.editable=null==Y.editable||!!Y.editable,Y.nullable=null==Y.nullable||!!Y.nullable,P=m.getFieldDefaultValue(Y),Y.nullable||void 0!==P?w[Y.name]=P:this._requiredFields.push(Y));return this._fieldsIndex=new f(s),this._createDefaultAttributes=h.createDefaultAttributesFunction(w,F),B&&(B.startTimeField&&((X=this._fieldsIndex.get(B.startTimeField))?(B.startTimeField=X.name,X.type="esriFieldTypeDate"):B.startTimeField=null),B.endTimeField&&((q=this._fieldsIndex.get(B.endTimeField))?(B.endTimeField=q.name,q.type="esriFieldTypeDate"):B.endTimeField=null),B.trackIdField&&((O=this._fieldsIndex.get(B.trackIdField))?B.trackIdField=O.name:(B.trackIdField=null,t.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:B}}))),B.startTimeField||B.endTimeField||(t.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:B}}),B=null)),R={warnings:t,featureErrors:[],layerDefinition:i.__assign(i.__assign({},_),{drawingInfo:h.createDrawingInfo(x),templates:h.createDefaultTemplate(w),extent:I,geometryType:x,objectIdField:F,fields:s,hasZ:!!c,hasM:!!a,timeInfo:B}),assignedObjectIds:{}},this._queryEngine=new d.default({fields:s,geometryType:x,hasM:a,hasZ:c,objectIdField:F,spatialReference:b,featureStore:new u.default({geometryType:x,hasM:a,hasZ:c}),timeInfo:B}),r&&r.length?(D=r.reduce((function(e,t){var i=t.attributes&&t.attributes[F];return null==i||isNaN(i)||!isFinite(i)?e:Math.max(e,i)}),0),this._nextObjectId=1+D,[4,l.checkProjectionSupport(r,b)]):(this._nextObjectId=1,[2,R]);case 1:return G.sent(),[2,this._loadInitialFeatures(R,r)]}}))}))},e.prototype.applyEdits=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,n,o;return i.__generator(this,(function(i){switch(i.label){case 0:return t=this._queryEngine,n=t.spatialReference,o=t.geometryType,[4,r.all([c.loadGeometryEngineForSimplify(n,o),l.checkProjectionSupport(e.adds,n),l.checkProjectionSupport(e.updates,n)])];case 1:return i.sent(),[2,this._applyEdits(e)]}}))}))},e.prototype.queryFeatures=function(e,t){return void 0===t&&(t={}),i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return[2,this._queryEngine.executeQuery(e,t.signal)]}))}))},e.prototype.queryFeatureCount=function(e,t){return void 0===t&&(t={}),i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return[2,this._queryEngine.executeQueryForCount(e,t.signal)]}))}))},e.prototype.queryObjectIds=function(e,t){return void 0===t&&(t={}),i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return[2,this._queryEngine.executeQueryForIds(e,t.signal)]}))}))},e.prototype.queryExtent=function(e,t){return void 0===t&&(t={}),i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(i){return[2,this._queryEngine.executeQueryForExtent(e,t.signal)]}))}))},e.prototype._inferLayerProperties=function(e,t){for(var i=void 0,n=void 0,r=null,s=null,a=null,u=0,l=e;u<l.length;u++){var d=l[u].geometry;if(d&&(r||(r=o.getJsonType(d)),s||(s=d.spatialReference),null==i&&(i=v(d)),null==n&&(n=b(d)),r&&s&&null!=i&&null!=n))break}if(t&&t.length){var h=null;t.some((function(e){var t="esriFieldTypeOID"===e.type,i=!e.type&&e.name&&"objectid"===e.name.toLowerCase();return h=e,t||i}))&&(a=h.name)}return{geometryType:r,spatialReference:s,objectIdField:a,hasM:n,hasZ:i}},e.prototype._loadInitialFeatures=function(e,t){for(var i=this._queryEngine,n=i.geometryType,r=i.hasM,s=i.hasZ,u=i.objectIdField,d=i.spatialReference,h=i.featureStore,f=[],p=0,m=t;p<m.length;p++){var y=m[p];if(null!=y.uid&&(e.assignedObjectIds[y.uid]=-1),y.geometry&&n!==o.getJsonType(y.geometry))e.featureErrors.push(c.createFeatureEditErrorResult("Incorrect geometry type."));else{var g=this._createDefaultAttributes(),_=c.mixAttributes(this._fieldsIndex,this._requiredFields,g,y.attributes,!0,e.warnings);_?e.featureErrors.push(_):(this._assignObjectId(g,y.attributes,!0),y.attributes=g,null!=y.uid&&(e.assignedObjectIds[y.uid]=y.attributes[u]),y.geometry&&(y.geometry=l.project(y.geometry,y.geometry.spatialReference,d)),f.push(y))}}if(h.addMany(a.convertFromFeatures([],f,n,s,r,u)),e.layerDefinition.extent=this._queryEngine.fullExtent,e.layerDefinition.timeInfo){var v=this._queryEngine.timeExtent,b=v.start,I=v.end;e.layerDefinition.timeInfo.timeExtent=[b,I]}return e},e.prototype._applyEdits=function(e){var t=e.adds,i=e.updates,n=e.deletes,r={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t&&t.length&&this._applyAddEdits(r,t),i&&i.length&&this._applyUpdateEdits(r,i),n&&n.length){for(var o=0,s=n;o<s.length;o++){var a=s[o];r.deleteResults.push(c.createFeatureEditSuccessResult(a))}this._queryEngine.featureStore.removeManyById(n)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:r}},e.prototype._applyAddEdits=function(e,t){for(var i=e.addResults,n=this._queryEngine,r=n.geometryType,s=n.hasM,u=n.hasZ,d=n.objectIdField,h=n.spatialReference,f=n.featureStore,p=[],m=0,y=t;m<y.length;m++){var g=y[m];if(g.geometry&&r!==o.getJsonType(g.geometry))i.push(c.createFeatureEditErrorResult("Incorrect geometry type."));else{var _=this._createDefaultAttributes(),v=c.mixAttributes(this._fieldsIndex,this._requiredFields,_,g.attributes);if(v)i.push(v);else{if(this._assignObjectId(_,g.attributes),g.attributes=_,null!=g.uid){var b=g.attributes[d];e.uidToObjectId[g.uid]=b}g.geometry&&(g.geometry=l.project(c.simplify(g.geometry,h),g.geometry.spatialReference,h)),p.push(g),i.push(c.createFeatureEditSuccessResult(g.attributes[d]))}}}f.addMany(a.convertFromFeatures([],p,r,u,s,d))},e.prototype._applyUpdateEdits=function(e,t){for(var i=e.updateResults,n=this._queryEngine,r=n.geometryType,s=n.hasM,u=n.hasZ,d=n.objectIdField,h=n.spatialReference,f=n.featureStore,p=0,m=t;p<m.length;p++){var y=m[p],g=y.attributes,_=y.geometry,v=g&&g[d];if(null!=v)if(f.has(v)){var b=a.convertToFeature(f.getFeature(v),r,u,s);if(_){if(r!==o.getJsonType(_)){i.push(c.createFeatureEditErrorResult("Incorrect geometry type."));continue}b.geometry=l.project(c.simplify(_,h),_.spatialReference,h)}if(g){var I=c.mixAttributes(this._fieldsIndex,this._requiredFields,b.attributes,g);if(I){i.push(I);continue}}f.add(a.convertFromFeature(b,r,u,s,d)),i.push(c.createFeatureEditSuccessResult(v))}else i.push(c.createFeatureEditErrorResult("Feature with object id "+v+" missing"));else i.push(c.createFeatureEditErrorResult("Identifier field "+d+" missing"))}},e.prototype._assignObjectId=function(e,t,i){void 0===i&&(i=!1);var n=this._queryEngine.objectIdField;i&&t&&isFinite(t[n])?e[n]=t[n]:e[n]=this._nextObjectId++},e}();t.default=I}.apply(null,n))||(e.exports=r)},1409:function(e,t,i){var n;void 0===(n=function(){"use strict";function e(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function t(e,t){return e<t?-1:e>t?1:0}return function(i,n,r,o,s){!function t(i,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,u=n-r+1,l=Math.log(a),d=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*d*(a-d)/a)*(u-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-u*d/a+h)),Math.min(o,Math.floor(n+(a-u)*d/a+h)),s)}var c=i[n],f=r,p=o;for(e(i,r,n),s(i[o],c)>0&&e(i,r,o);f<p;){for(e(i,f,p),f++,p--;s(i[f],c)<0;)f++;for(;s(i[p],c)>0;)p--}0===s(i[r],c)?e(i,r,p):e(i,++p,o),p<=n&&(r=p+1),n<=p&&(o=p-1)}}(i,n,r||0,o||i.length-1,s||t)}}.apply(null,[]))||(e.exports=n)},1414:function(e,t,i){var n,r;n=[i(1409)],void 0===(r=function(e){"use strict";function t(e,i){if(!(this instanceof t))return new t(e,i);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}function i(e,t,i){if(!i)return t.indexOf(e);for(var n=0;n<t.length;n++)if(i(e,t[n]))return n;return-1}function n(e,t){r(e,0,e.children.length,t,e)}function r(e,t,i,n,r){r||(r=c(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,a=t;a<i;a++)s=e.children[a],o(r,e.leaf?n(s):s);return r}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function s(e,t){return e.minX-t.minX}function a(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function l(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function h(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function c(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function f(t,i,n,r,o){for(var s,a=[i,n];a.length;)(n=a.pop())-(i=a.pop())<=r||(s=i+Math.ceil((n-i)/r/2)*r,e(t,s,i,n,o),a.push(i,s,s,n))}return t.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],n=this.toBBox;if(!h(e,t))return i;for(var r,o,s,a,u=[];t;){for(r=0,o=t.children.length;r<o;r++)s=t.children[r],h(e,a=t.leaf?n(s):s)&&(t.leaf?i.push(s):d(e,a)?this._all(s,i):u.push(s));t=u.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!h(e,t))return!1;for(var n,r,o,s,a=[];t;){for(n=0,r=t.children.length;n<r;n++)if(o=t.children[n],h(e,s=t.leaf?i(o):o)){if(t.leaf||d(e,s))return!0;a.push(o)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=c([]),this},remove:function(e,t){if(!e)return this;for(var n,r,o,s,a=this.data,u=this.toBBox(e),l=[],h=[];a||l.length;){if(a||(a=l.pop(),r=l[l.length-1],n=h.pop(),s=!0),a.leaf&&-1!==(o=i(e,a.children,t)))return a.children.splice(o,1),l.push(a),this._condense(l),this;s||a.leaf||!d(a,u)?r?(n++,a=r.children[n],s=!1):a=null:(l.push(a),h.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(e){return e},compareMinX:s,compareMinY:a,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,r){var o,s=i-t+1,a=this._maxEntries;if(s<=a)return n(o=c(e.slice(t,i+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(o=c([])).leaf=!1,o.height=r;var u,l,d,h,p=Math.ceil(s/a),m=p*Math.ceil(Math.sqrt(a));for(f(e,t,i,m,this.compareMinX),u=t;u<=i;u+=m)for(f(e,u,d=Math.min(u+m-1,i),p,this.compareMinY),l=u;l<=d;l+=p)h=Math.min(l+p-1,d),o.children.push(this._build(e,l,h,r-1));return n(o,this.toBBox),o},_chooseSubtree:function(e,t,i,n){for(var r,o,s,a,l,d,h,c,f,p;n.push(t),!t.leaf&&n.length-1!==i;){for(h=c=1/0,r=0,o=t.children.length;r<o;r++)l=u(s=t.children[r]),f=e,p=s,(d=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l)<c?(c=d,h=l<h?l:h,a=s):d===c&&l<h&&(h=l,a=s);t=a||t.children[0]}return t},_insert:function(e,t,i){var n=this.toBBox,r=i?e:n(e),s=[],a=this._chooseSubtree(r,this.data,t,s);for(a.children.push(e),o(a,r);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(r,s,t)},_split:function(e,t){var i=e[t],r=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,r);var s=this._chooseSplitIndex(i,o,r),a=c(i.children.splice(s,i.children.length-s));a.height=i.height,a.leaf=i.leaf,n(i,this.toBBox),n(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(e,t){this.data=c([e,t]),this.data.height=e.height+1,this.data.leaf=!1,n(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var n,o,s,a,l,d,h,c,f,p,m,y,g,_;for(d=h=1/0,n=t;n<=i-t;n++)f=o=r(e,0,n,this.toBBox),p=s=r(e,n,i,this.toBBox),void 0,void 0,void 0,void 0,m=Math.max(f.minX,p.minX),y=Math.max(f.minY,p.minY),g=Math.min(f.maxX,p.maxX),_=Math.min(f.maxY,p.maxY),a=Math.max(0,g-m)*Math.max(0,_-y),l=u(o)+u(s),a<d?(d=a,c=n,h=l<h?l:h):a===d&&l<h&&(h=l,c=n);return c},_chooseSplitAxis:function(e,t,i){var n=e.leaf?this.compareMinX:s,r=e.leaf?this.compareMinY:a;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,r)&&e.children.sort(n)},_allDistMargin:function(e,t,i,n){e.children.sort(n);var s,a,u=this.toBBox,d=r(e,0,t,u),h=r(e,i-t,i,u),c=l(d)+l(h);for(s=t;s<i-t;s++)a=e.children[s],o(d,e.leaf?u(a):a),c+=l(d);for(s=i-t-1;s>=t;s--)a=e.children[s],o(h,e.leaf?u(a):a),c+=l(h);return c},_adjustParentBBoxes:function(e,t,i){for(var n=i;n>=0;n--)o(t[n],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():n(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},t}.apply(null,n))||(e.exports=r)},1427:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(0),i(11),i(38),i(5),i(2),i(37),i(34),i(76),i(412),i(1443),i(1433),i(1429)],void 0===(r=function(e,t,i,n,r,o,s,a,u,l,d,h,c,f){Object.defineProperty(t,"__esModule",{value:!0});var p=o.getLogger("esri.layers.graphics.data.FeatureStore"),m=function(){function e(e){this.geometryInfo=e,this._boundsStore=new h.BoundsStore,this._featuresById=new Map,this._markedIds=new Set,this.events=new r,this.featureAdapter=f.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){var e=this;if(!this.numFeatures)return null;var t=u.create(u.NEGATIVE_INFINITY);return this._featuresById.forEach((function(i){var n=e._boundsStore.get(i.objectId);n&&(t[0]=Math.min(n[0],t[0]),t[1]=Math.min(n[1],t[1]),t[2]=Math.max(n[2],t[2]),t[3]=Math.max(n[3],t[3]))})),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storeStatistics",{get:function(){var e=0;return this._featuresById.forEach((function(t){t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e),this._emitChanged()},e.prototype.addMany=function(e){for(var t=0,i=e;t<i.length;t++){var n=i[t];this._add(n)}this._emitChanged()},e.prototype.clear=function(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null},e.prototype.removeManyById=function(e){this._boundsStore.invalidateIndex();for(var t=0,i=e;t<i.length;t++){var n=i[t],r=this._featuresById.get(n);r&&this._remove(r)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,i){for(var n=0,r=e;n<r.length;n++){var o=r[n],s=this._boundsStore.get(o.objectId);s&&t(a.fromRect(i,s))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach((function(t){return e(t)}))},e.prototype.forEachInBounds=function(e,t){var i=this;this._boundsStore.forEachInBounds(e,(function(e){t(i._featuresById.get(e))}))},e.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex(),this._markedIds.clear()},e.prototype.sweep=function(){var e=this,t=!1;this._featuresById.forEach((function(i,n){e._markedIds.has(n)||(t=!0,e._remove(i))})),this._markedIds.clear(),t&&this._emitChanged()},e.prototype.executeTileQuery=function(e,t,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,a,d,h,f,p,m,y,g,_,v,b;return i.__generator(this,(function(i){return r=n.returnGeometry,o=n.returnCentroid,s=n.returnOutline,a=n.pixelBuffer,d=new Set,h=[],f=a*e.resolution,p=u.pad(e.bounds,f,u.create()),c.createTileFeatures(h,d,this.geometryInfo,this,p,r,o,s,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),("esriGeometryPoint"===this.geometryType||o)&&(m=l.getInfo(t))&&(y=m.valid,g=y[0],_=y[1],p[0]<g&&(v=u.fromValues(_-f,p[1],_,p[3]),c.createTileFeatures(h,d,this.geometryInfo,this,v,r,o,s,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[_,e.bounds[3]]})),p[2]>_&&(b=u.fromValues(g,p[1],g+f,p[3]),c.createTileFeatures(h,d,this.geometryInfo,this,b,r,o,s,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[g-_+e.bounds[0],e.bounds[3]]}))),h.sort((function(e,t){return e.localId-t.localId})),[2,{features:h,objectIds:d}]}))}))},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e){if(e){var t=e.objectId;if(null!=t){var i,r=this._featuresById.get(t);if(this._markedIds.add(t),r?(e.localId=r.localId,i=this._boundsStore.get(t),this._boundsStore.delete(t)):s.isSome(this.onFeatureAdd)&&this.onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);i=d.getBoundsOptimizedGeometry(i||u.create(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(t,i),this._featuresById.set(t,e)}else p.error(new n("featurestore:invalid-feature","feature id is missing",{feature:e}))}},e.prototype._remove=function(e){return s.isSome(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e},e}();t.default=m}.apply(null,n))||(e.exports=r)},1433:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(34),i(412),i(414),i(1402),i(1405)],void 0===(r=function(e,t,i,n,r,o,s){Object.defineProperty(t,"__esModule",{value:!0});var a=new r.default,u={esriGeometryPoint:n.convertToPoint,esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};t.executeTileQueryForIds=function(e,t,n){var r=n.pixelBuffer*t.resolution,o=i.pad(t.bounds,r,i.create()),s=[];return e.featureStore.forEachInBounds(o,(function(t){return s.push(e.featureAdapter.getObjectId(t))})),s},t.createTileFeatures=function(e,t,i,n,r,h,c,f,p){var m=u[i.geometryType],y=l[i.geometryType],g="esriGeometryPolygon"===i.geometryType&&!f,_=i.hasZ?i.hasM?4:3:i.hasM?3:2;c&&!h?n.forEachInBounds(r,(function(n){return function(e,t,i,n,r){if(!t.has(i.objectId)){var a=s.getCentroid(n,i,r),u=i.attributes;a&&(t.add(i.objectId),e.push(new o.Feature(u,i.localId,null,a)))}}(e,t,n,i,p)})):h&&!c?n.forEachInBounds(r,(function(i){return function(e,t,i,n,r,s,u,l){if(!t.has(i.objectId)){var h=i.attributes,c=n(d(a,i.geometry,r,s,l,u),!1,!1);c&&(t.add(i.objectId),e.push(new o.Feature(h,i.localId,c,null)))}}(e,t,i,m,_,y,p,g)})):n.forEachInBounds(r,(function(n){return function(e,t,i,n,r,u,l,h,c){if(!t.has(i.objectId)){var f=s.getCentroid(n,i,r),p=i.attributes,m=u(d(a,i.geometry,l,h,c,r),!1,!1);m&&f&&(t.add(i.objectId),e.push(new o.Feature(p,i.localId,m,f)))}}(e,t,n,i,p,m,_,y,g)}))};var l={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};function d(e,t,i,r,o,s){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var a,u,l,d,h=t.coords,c=t.lengths;if(!c.length)return e.coords[0]=n.quantizeX(s,h[0]),e.coords[1]=n.quantizeY(s,h[1]),e.coords.length=i,e;for(var f=0,p=0,m=p,y=0,g=c;y<g.length;y++){var _=g[y];if(!(_<r))if(p=m,l=a=n.quantizeX(s,h[f]),d=u=n.quantizeY(s,h[f+1]),e.coords[p]=l,e.coords[p+1]=d,f+=i,1!==_){var v=(l=n.quantizeX(s,h[f]))-a,b=(d=n.quantizeY(s,h[f+1]))-u,I=b/v;p+=2,e.coords[p]=v,e.coords[p+1]=b,a=l,u=d,f+=i;for(var x=2;x<_;x++){if(l=n.quantizeX(s,h[f]),d=n.quantizeY(s,h[f+1]),l!==a||d!==u){var F=l-a,B=d-u,M=B/F;I!==M&&(isFinite(I)||isFinite(M))||!(o||(b>=0&&B>=0||b<=0&&B<=0)&&(v>=0&&F>=0||v<=0&&F<=0))?(v=F,b=B,p+=2):(v+=F,b+=B),e.coords[p]=v,e.coords[p+1]=b,I=M,a=l,u=d}f+=i}var E=(p+2-m)/2;E>=r&&(e.lengths.push(E),m=p+2)}else e.lengths.push(1),m=p+2}return e.coords.length>m&&(e.coords.length=m),e.coords.length?e:null}t.quantizeOptimizedGeometryForDisplay=d}.apply(null,n))||(e.exports=r)},1443:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(25),i(1414),i(14)],void 0===(r=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0});var r={minX:0,minY:0,maxX:0,maxY:0},o=function(){function e(){var e=this;this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=n(9,i("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._loadIndex=function(){if(e._indexInvalid){var t=new Array(e._idByBounds.size),i=0;e._idByBounds.forEach((function(e,n){t[i++]=n})),e._indexInvalid=!1,e._index.clear(),e._index.load(t)}else e._boundsToLoad.length&&(e._index.load(e._boundsToLoad.filter((function(t){return e._idByBounds.has(t)}))),e._boundsToLoad.length=0)}}return e.prototype.clear=function(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()},e.prototype.delete=function(e){var t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))},e.prototype.forEachInBounds=function(e,t){this._loadIndex();for(var i=0,n=function(e,t){return r.minX=t[0],r.minY=t[1],r.maxX=t[2],r.maxY=t[3],e.search(r)}(this._index,e);i<n.length;i++){var o=n[i];t(this._idByBounds.get(o))}},e.prototype.get=function(e){return this._boundsById.get(e)},e.prototype.has=function(e){return this._boundsById.has(e)},e.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)},e.prototype.set=function(e,t){if(!this._indexInvalid){var i=this._boundsById.get(e);i&&(this._index.remove(i),this._idByBounds.delete(i))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))},e}();t.BoundsStore=o}.apply(null,n))||(e.exports=r)},1470:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(0),i(25),i(8),i(697)],void 0===(r=function(e,t,i,n,r,o){Object.defineProperty(t,"__esModule",{value:!0}),t.createDrawingInfo=function(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?o.defaultPointSymbolJSON:"esriGeometryPolyline"===e?o.defaultPolylineSymbolJSON:o.defaultPolygonSymbolJSON}}},t.createDefaultAttributesFunction=function(e,t){if(n("csp-restrictions"))return function(){var n;return i.__assign(((n={})[t]=null,n),e)};try{var r="this."+t+" = null;";for(var o in e)r+="this."+o+" = "+JSON.stringify(e[o])+";";var s=new Function(r);return function(){return new s}}catch(n){return function(){var n;return i.__assign(((n={})[t]=null,n),e)}}},t.createDefaultTemplate=function(e){return void 0===e&&(e={}),[{name:"New Feature",description:"",prototype:{attributes:r.clone(e)}}]}}.apply(null,n))||(e.exports=r)},1647:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(0),i(76),i(66),i(14)],void 0===(r=function(e,t,n,r,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){this.code=null,this.description=null},a=function(e){this.error=new s,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e};function u(e){return new a(e)}t.createFeatureEditErrorResult=u;var l=function(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e};t.createFeatureEditSuccessResult=function(e){return new l(e)};var d,h=new Set;function c(e,t){var i=t;return"string"==typeof t&&o.isNumericField(e)?i=parseFloat(t):null!=t&&o.isStringField(e)&&"string"!=typeof t&&(i=String(t)),o.sanitizeNullFieldValue(i)}function f(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return d?[2,d]:[4,new Promise((function(e,t){Promise.all([i.e(8),i.e(23)]).then(function(){var t=[i(1523)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return[2,d=e.sent()]}}))}))}t.mixAttributes=function(e,t,i,n,r,s){for(var a in void 0===r&&(r=!1),h.clear(),n){var l=e.get(a);if(l){var d=n[a],f=c(l,d);if(f!==d&&s&&s.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:l,originalValue:d,sanitizedValue:f}}),h.add(l.name),l&&(r||l.editable)){var p=o.validateFieldValue(l,f);if(p)return u(o.validationErrorToString(p,l,f));i[l.name]=f}}}for(var m=0,y=t;m<y.length;m++){var g=y[m];if(!h.has(g.name))return u('missing required field "'+g.name+'"')}return null},t.simplify=function(e,t){if(!e||!r.isValid(t))return e;if("rings"in e||"paths"in e){if(!d)throw new TypeError("geometry engine not loaded");return d.simplify(t,e)}return e},t.loadGeometryEngine=f,t.loadGeometryEngineForSimplify=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(i){switch(i.label){case 0:return!r.isValid(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t?[3,2]:[4,f()];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))}}.apply(null,n))||(e.exports=r)}}]);