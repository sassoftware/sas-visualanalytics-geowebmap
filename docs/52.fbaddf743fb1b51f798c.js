(function(){var e={"esri/views/3d/layers/WMSLayerView3D":1382,"esri/views/3d/layers/support/projectExtentUtils":1410,"esri/views/3d/webgl-engine/shaders/ImageMaterial.glsl":1431,"esri/views/3d/layers/DynamicLayerView3D":1478,"esri/views/3d/layers/support/overlayImageUtils":1479,"esri/views/3d/webgl-engine/materials/ImageMaterial":1480,"esri/views/3d/webgl-engine/shaders/ImageMaterialTechnique":1481,"esri/layers/support/wmsUtils":1492,"esri/layers/support/ExportWMSImageParameters":1532,"esri/views/layers/WMSLayerView":1673},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1382:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(11),r(4),r(1),r(49),r(1532),r(1478),r(1673)],void 0===(a=function(e,t,r,n,a,i,o,s,l,u){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this.layer.supportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(a.reject(new n("layerview:spatial-reference-incompatible","The spatial references supported by this WMS layer are incompatible with the spatial reference of the view")));var t=this.layer,r=this.view;this._exportWMSImageParameters=new s({layer:t,view:r}),this.updatingHandles.add(this._exportWMSImageParameters,"version",(function(){e.updatingHandles.addPromise(e.refreshDebounced())}))},t.prototype.destroy=function(){this._exportWMSImageParameters&&(this._exportWMSImageParameters.layer=null,this._exportWMSImageParameters.destroy(),this._exportWMSImageParameters=null)},t.prototype.createFetchPopupFeaturesQuery=function(e){var t=this.findExtentInfoAt(e),r=t.extent,n=new o(r[0],r[1],r[2],r[3],t.spatialReference),a=t.imageSize,i=a.width,s=a.height,l=n.width/i;return{extent:n,width:i,height:s,x:Math.round((e.x-n.xmin)/l),y:Math.round((n.ymax-e.y)/l)}},r.__decorate([i.property({dependsOn:["view.spatialReference","layer.spatialReferences"]})],t.prototype,"suspended",void 0),r.__decorate([i.subclass("esri.views.3d.layers.WMSLayerView3D")],t)}(u.WMSLayerView(l))}.apply(null,n))||(e.exports=a)},1410:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(4),r(46),r(239)],void 0===(a=function(e,t,r,n,a){Object.defineProperty(t,"__esModule",{value:!0}),t.toViewIfLocal=function(e){var t=e.view.spatialReference,i=e.layer.fullExtent,o=i&&i.spatialReference;return o?o.equals(t)?r.resolve(i.clone()):n.canProject(o,t)?r.resolve(n.project(i,t)):e.view.state.isLocal?a.projectGeometry(i,t,e.layer.portalItem).then((function(t){return!e.destroyed&&t?t:void 0})).catch((function(){return null})):r.resolve(null):r.resolve(null)}}.apply(null,n))||(e.exports=a)},1431:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(44),r(64),r(148),r(10),r(51)],void 0===(a=function(e,t,r,n,a,i,o,s){var l,u;Object.defineProperty(t,"__esModule",{value:!0}),t.build=function(e){var t=new s.ShaderBuilder;return t.include(a.Transform,{linearDepth:!1}),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.varyings.add("vpos","vec3"),t.vertex.uniforms.add("textureCoordinateScaleFactor","vec2"),t.vertex.code.add(o.glsl(l||(l=r.__makeTemplateObject(["\n    void main(void) {\n      vpos = position;\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "],["\n    void main(void) {\n      vpos = position;\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  "])))),t.include(n.Slice,e),t.fragment.uniforms.add("tex","sampler2D"),t.fragment.uniforms.add("opacity","float"),t.varyings.add("vTexCoord","vec2"),t.fragment.code.add(o.glsl(u||(u=r.__makeTemplateObject(["\n    void main() {\n      discardBySlice(vpos);\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n    }\n    "],["\n    void main() {\n      discardBySlice(vpos);\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ",") {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n    }\n    "])),o.glsl.float(i.defaultMaskAlphaCutoff))),t}}.apply(null,n))||(e.exports=a)},1478:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(72),r(5),r(4),r(4),r(13),r(1),r(49),r(34),r(680),r(1479),r(1410),r(77),r(191),r(149),r(1480),r(678),r(679)],void 0===(a=function(e,t,r,n,a,i,o,s,l,u,c,p,d,h,f,y,m,g,v,_){var x=a.getLogger("esri.views.3d.layers.DynamicLayerView3D"),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.drapeSourceType=0,t.hasDraped=!0,t.fullExtentInLocalViewSpatialReference=null,t.maximumDataResolution=null,t._images=new Array,t._extents=new Array,t._overlayExtents=new Array,t.updateWhenStationary=!0,t}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(h.toViewIfLocal(this).then((function(t){return e._set("fullExtentInLocalViewSpatialReference",t)}))),this.updatingHandles.add(this,"suspended",(function(){return e._suspendedChangeHandler()})),this.handles.add(this.view.resourceController.scheduler.registerIdleStateCallbacks((function(){e._isScaleRangeActive()&&e.notifyChange("suspended")}),(function(){}))),this._isScaleRangeLayer()&&this.updatingHandles.add(this.layer,"scaleRangeId",(function(){return e.notifyChange("suspended")})),"local"===this.view.viewingMode&&this.updatingHandles.add(this.view.basemapTerrain,"extent",(function(){return e._overlayExtents.forEach((function(t,r){return e._updateImageExtent(r)}))}))},t.prototype.destroy=function(){this.clear()},t.prototype.setDrapingExtent=function(e,t,r,n,a,i){this._overlayExtents[e]={extent:c.create(t),spatialReference:r,resolution:n,renderLocalOrigin:a,pixelRatio:i},this._updateImageExtent(e)},t.prototype._updateImageExtent=function(e){var t=this._overlayExtents[e],r=this._clippedExtent(t.extent,w),n=d.computeImageExportSize(t.extent,r,t.resolution),a=t.pixelRatio*this.view.pixelRatio;if("imageMaxWidth"in this.layer||"imageMaxHeight"in this.layer){var o=this.layer.imageMaxWidth,s=this.layer.imageMaxHeight;if(n.width>o){var l=o/n.width;n.height=Math.floor(n.height*l),n.width=o,a*=l}n.height>s&&(l=s/n.height,n.width=Math.floor(n.width*l),n.height=s,a*=l)}var u=this._extents[e];u&&c.equals(u.extent,r)&&!this._imageSizeDiffers(r,u.imageSize,n)||(this._extents[e]={extent:c.create(r),spatialReference:t.spatialReference,imageSize:n,pixelRatio:a},this.suspended||this._fetch(e).catch((function(e){i.isAbortError(e)||x.error(e)})))},t.prototype.clear=function(){for(var e=0;e<this._images.length;e++)this._clearImage(e)},t.prototype.doRefresh=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:if(this.suspended)return[2];for(t=[],n=0;n<this._extents.length;n++)this._extents[n]&&t.push(this._fetch(n,e));return[4,i.eachAlways(t)];case 1:return r.sent(),[2]}}))}))},t.prototype.canResume=function(){if(!e.prototype.canResume.call(this))return!1;if(this._isScaleRangeLayer()){var t=this.layer,r=t.minScale,n=t.maxScale;if(r>0||n>0){var a=this.view.scale;if(a<n||r>0&&a>r)return!1}}return!0},t.prototype.isUpdating=function(){return this._images.some((function(e){return!!e.loadingPromise}))},t.prototype.processResult=function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&(e.image=t),[2]}))}))},t.prototype.findExtentInfoAt=function(e){for(var t=0,r=this._extents;t<r.length;t++){var n=r[t],a=n.extent;if(new u(a[0],a[1],a[2],a[3],n.spatialReference).contains(e))return n}return null},t.prototype.getFetchOptions=function(){},t.prototype.redraw=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var a=this;return r.__generator(this,(function(i){switch(i.label){case 0:return[4,n.forEach(this._images,(function(n,i){return r.__awaiter(a,void 0,void 0,(function(){return r.__generator(this,(function(r){switch(r.label){case 0:return n?[4,e(n,t)]:[2];case 1:return r.sent(),this._createStageObjects(i,n.image),this.emit("draped-data-change"),[2]}}))}))}))];case 1:return i.sent(),[2]}}))}))},t.prototype._imageSizeDiffers=function(e,t,r){if(!this.maximumDataResolution)return!0;if(f.TESTS_DISABLE_UPDATE_THRESHOLDS)return!0;var n=c.width(e)/this.maximumDataResolution.x,a=c.height(e)/this.maximumDataResolution.y,i=n/t.width,o=a/t.height,s=n/r.width,l=a/r.height,u=Math.abs(i-s),p=Math.abs(o-l);return u>1.5||p>1.5},t.prototype._fetch=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,a,s,l,p,d,h,f,y,m=this;return r.__generator(this,(function(g){switch(g.label){case 0:return this.suspended?[2]:(n=this._overlayExtents[e],a=this._extents[e],s=a.extent,l=new u(s[0],s[1],s[2],s[3],a.spatialReference),this._images[e]||(this._images[e]={texture:null,material:null,rendergeometry:null,loadingPromise:null,loadingAbortController:null,image:null,pixelData:null,renderExtent:c.create(s)}),(p=this._images[e]).loadingAbortController&&(p.loadingAbortController.abort(),p.loadingAbortController=null),0===l.width||0===l.height?(this._clearImage(e),[2]):(d=i.createAbortController(),p.loadingAbortController=d,i.onAbort(t,(function(){return d.abort()})),h=d.signal,f=this._waitFetchReady(h).then((function(){var e=r.__assign(r.__assign({requestAsImageElement:!0,pixelRatio:n.pixelRatio},m.getFetchOptions()),{signal:h}),t=a.imageSize,i=t.height,o=t.width;return m.layer.fetchImage(l,o,i,e)})).then((function(e){if(o.isAborted(h))throw x.warnOnce("A call to fetchImage resolved even though the request was aborted. fetchImage should not resolve if options.signal.aborted is true."),o.createAbortError();return m.processResult(p,e)})),p.loadingPromise=f,i.always(f,(function(){f===p.loadingPromise&&(p.loadingPromise=null,p.loadingAbortController=null)})),y=f.then((function(){c.set(p.renderExtent,s),m._createStageObjects(e,p.image),m.notifyChange("updating"),m.emit("draped-data-change")})).catch((function(e){throw e&&!i.isAbortError(e)&&x.error(e),m.notifyChange("updating"),e})),this.notifyChange("updating"),[4,y]));case 1:return g.sent(),[2]}}))}))},t.prototype.notifyGraphicUpdate=function(){},t.prototype._clearImage=function(e){var t=this._images[e],r=this.view._stage;t&&(t.rendergeometry&&(this.view.basemapTerrain.overlayManager.renderer.removeGeometries([t.rendergeometry],this,2),t.rendergeometry=null),t.texture&&(r.remove(4,t.texture.id),t.texture=null),t.material&&(r.remove(3,t.material.id),t.material=null),t.loadingAbortController&&(t.loadingAbortController.abort(),t.loadingAbortController=null),t.loadingPromise=null,t.image=null,t.pixelData=null)},t.prototype._createStageObjects=function(e,t){var r=this.view._stage,n=this._images[e];n.texture&&(r.remove(4,n.texture.id),n.texture=null),t?(n.texture=new m(t,"dynamicLayer",{width:t.width,height:t.height,preMultiplyAlpha:!0,wrap:{s:33071,t:33071}}),r.add(4,n.texture)):n.material&&(r.remove(3,n.material.id),n.material=null),!n.material&&n.texture?(n.material=new g({transparent:!0,textureId:n.texture.id},"dynamicLayer"),r.add(3,n.material)):n.material&&t&&n.material.setParameterValues({textureId:n.texture.id});var a=this.view.basemapTerrain.overlayManager.renderer;if(n.material){var i=void 0,o=this._overlayExtents[e].renderLocalOrigin;if(0===e)i=d.createGeometryForExtent(n.renderExtent,-1);else{if(1!==e)return void console.error("DynamicLayerView3D._createStageObjects: Invalid extent idx");var s=this._images[0].renderExtent;if(!s)return;i=d.createOuterImageGeometry(s,n.renderExtent,-1)}var l=new y(i);l.material=n.material,l.origin=o,a.addGeometries([l],this,2),n.rendergeometry&&a.removeGeometries([n.rendergeometry],this,2),n.rendergeometry=l}else n.rendergeometry&&(a.removeGeometries([n.rendergeometry],this,2),n.rendergeometry=null)},t.prototype._isScaleRangeLayer=function(){return"minScale"in this.layer&&"maxScale"in this.layer},t.prototype._isScaleRangeActive=function(){return!!this._isScaleRangeLayer()&&(this.layer.minScale>0||this.layer.maxScale>0)},t.prototype._clippedExtent=function(e,t){if("local"!==this.view.viewingMode)return c.set(t,e);var r=this.view.basemapTerrain,n=r.extent;return r.ready&&n?c.intersection(e,n,t):c.set(t,e)},t.prototype._suspendedChangeHandler=function(){this.suspended?(this.clear(),this.emit("draped-data-change")):this.refresh()},t.prototype._waitFetchReady=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.updateWhenStationary?[4,s.whenOnce(this.view,"stationary",e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},r.__decorate([l.property()],t.prototype,"layer",void 0),r.__decorate([l.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),r.__decorate([l.property({type:Boolean})],t.prototype,"hasDraped",void 0),r.__decorate([l.property({readOnly:!0})],t.prototype,"fullExtentInLocalViewSpatialReference",void 0),r.__decorate([l.property()],t.prototype,"updating",void 0),r.__decorate([l.subclass("esri.views.3d.layers.DynamicLayerView3D")],t)}(_.RefreshableLayerView(p.LayerView3D(v))),w=c.create();return b}.apply(null,n))||(e.exports=a)},1479:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(34),r(102),r(189),r(18)],void 0===(a=function(e,t,r,n,a,i){function o(e,t){var r=[[e[0],e[1],t],[e[2],e[1],t],[e[2],e[3],t],[e[0],e[3],t]];return a.createSquareGeometry(r)}Object.defineProperty(t,"__esModule",{value:!0}),t.computeImageExportSize=function(e,t,n){var a=r.width(e)/r.height(e),i={width:n,height:n};return a>1.0001?i.height=n/a:a<.9999&&(i.width=n*a),i.width=Math.round(i.width/(r.width(e)/r.width(t))),i.height=Math.round(i.height/(r.height(e)/r.height(t))),i},t.createGeometryForExtent=o,t.createOuterImageGeometry=function(e,t,a){if(!r.intersects(e,t))return o(t,a);for(var l=[e[1]-t[1],Math.min(e[3],t[3])-Math.max(e[1],t[1]),t[3]-e[3],123456],u=[e[0]-t[0],Math.min(e[2],t[2])-Math.max(e[0],t[0]),t[2]-e[2],123456],c=t[2]-t[0],p=t[3]-t[1],d=u[0]>0&&u[2]>0?3:2,h=l[0]>0&&l[2]>0?3:2,f=(h+1)*(d+1),y=new Float64Array(3*f),m=new Float32Array(2*f),g=new Uint32Array(6*(h*d-1)),v=0,_=0,x=0,b=0,w=0,S=0;S<4;S++){var E=l[S];if(!(E<=0)){for(var P=0,O=0;O<4;O++){var M=u[O];M<=0||(y[_++]=t[0]+P,y[_++]=t[1]+v,y[_++]=a,m[x++]=P/c,m[x++]=v/p,O<3&&S<3&&(1!==O||1!==S)&&(g[w++]=b,g[w++]=b+1,g[w++]=b+d+1,g[w++]=b+1,g[w++]=b+d+2,g[w++]=b+d+1),b++,P+=M)}v+=E}}var A={};A[i.VertexAttrConstants.POSITION]={size:3,data:y},A[i.VertexAttrConstants.NORMAL]={size:3,data:s},A[i.VertexAttrConstants.UV0]={size:2,data:m};for(var C={},R=new Uint32Array(g.length),N=0;N<R.length;N++)R[N]=0;return C[i.VertexAttrConstants.POSITION]=g,C[i.VertexAttrConstants.NORMAL]=R,C[i.VertexAttrConstants.UV0]=g,new n.GeometryData(A,C)};var s=new Float32Array([0,0,1])}.apply(null,n))||(e.exports=a)},1480:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(435),r(109),r(317),r(58),r(58),r(130),r(1481)],void 0===(a=function(e,t,r,n,a,i,o,s,l,u){var c=function(e){function t(t,r){var n=e.call(this,r)||this;return n.supportsEdges=!0,n.techniqueConfig=new u.ImageMaterialTechniqueConfiguration,n.params=s.copyParameters(t,d),n}return r.__extends(t,e),t.prototype.setParameterValues=function(e){o.updateParameters(this.params,e)&&this.parametersChanged()},t.prototype.getParameters=function(){return this.params},t.prototype.getTechniqueConfig=function(e){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig},t.prototype.intersect=function(e,t,r,n,a,i,o){s.intersectTriangleGeometry(e,t,n,a,i,void 0,o)},t.prototype.getGLMaterial=function(e){return 0===e.output||4===e.output?new p(e):void 0},t.prototype.createBufferWriter=function(){return new i.DefaultBufferWriter(i.PositionUVLayout)},t.prototype.createRenderer=function(e,t){return new l(e,t,this)},t}(a.Material),p=function(e){function t(t){var n=e.call(this,r.__assign(r.__assign({},t),t.material.getParameters()))||this;return n.updateParameters(),n}return r.__extends(t,e),t.prototype.updateParameters=function(){var e=this.material.getParameters();this.updateTexture(e.textureId),this.technique=this.techniqueRep.acquireAndReleaseExisting(u.ImageMaterialTechnique,this.material.getTechniqueConfig(this.output),this.technique)},t.prototype.beginSlot=function(e){return 4===this.output?3===e:e===(this.technique.configuration.transparent?this.technique.configuration.writeDepth?5:8:3)},t.prototype._updateOccludeeState=function(e){e.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters())},t.prototype.ensureParameters=function(e){0===this.output&&this._updateOccludeeState(e)},t.prototype.bind=function(e,t){e.bindProgram(this.technique.program),this.bindTexture(e,this.technique.program),this.bindTextureScale(e,this.technique.program),this.technique.bindPass(e,this.material.getParameters(),t)},t.prototype.getPipelineState=function(e,t){return t?this.technique.opaqueOccludeeState:this.technique.pipeline},t}(n),d={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0};return c}.apply(null,n))||(e.exports=a)},1481:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(44),r(64),r(52),r(55),r(59),r(43),r(150),r(1431),r(45),r(41),r(41),r(14)],void 0===(a=function(e,t,n,a,i,o,s,l,u,c,p,d,h,f){Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.initializeProgram=function(e){var r=t.shader.get(),n=this.configuration,a=r.build({slicePlaneEnabled:n.slicePlaneEnabled,sliceHighlightDisabled:n.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1});return new d(e.rctx,a.generateSource("vertex"),a.generateSource("fragment"),u.Default3D)},t.prototype.bindPass=function(e,t,r){this.program.setUniform1f("opacity",t.opacity)},t.prototype.bindDraw=function(e){i.Transform.bindUniforms(this.program,e),a.Slice.bindUniformsWithOrigin(this.program,this.configuration,e)},t.prototype.initializePipeline=function(){var e=this.configuration,t=0===e.output&&e.transparent?h.simpleBlendingParams(1,771):null,r=function(r){return f.makePipelineState({blending:t,polygonOffset:e.polygonOffset&&m,culling:(n=e.cullFace,0!==n&&{face:1===n?1028:1029,mode:2305}),depthTest:c.depthCompareLess,depthWrite:e.writeDepth&&f.defaultDepthWriteParams,colorWrite:f.defaultColorWriteParams,stencilWrite:e.sceneHasOcludees?c.stencilWriteMaskOn:null,stencilTest:e.sceneHasOcludees?r?c.stencilToolMaskBaseParams:c.stencilBaseAllZerosParams:null});var n};return this._occludeeState=r(!0),r(!1)},Object.defineProperty(t.prototype,"opaqueOccludeeState",{get:function(){return this._occludeeState},enumerable:!0,configurable:!0}),t.shader=new o.ReloadableShaderModule(p,(function(){return new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(1431)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))})),t}(s.ShaderTechnique);t.ImageMaterialTechnique=y;var m={factor:1,units:1},g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.output=0,t.cullFace=0,t.slicePlaneEnabled=!1,t.sliceHighlightDisabled=!1,t.transparent=!1,t.polygonOffset=!1,t.writeDepth=!0,t.sceneHasOcludees=!1,t}return n.__extends(t,e),n.__decorate([l.parameter({count:7})],t.prototype,"output",void 0),n.__decorate([l.parameter({count:3})],t.prototype,"cullFace",void 0),n.__decorate([l.parameter()],t.prototype,"slicePlaneEnabled",void 0),n.__decorate([l.parameter()],t.prototype,"sliceHighlightDisabled",void 0),n.__decorate([l.parameter()],t.prototype,"transparent",void 0),n.__decorate([l.parameter()],t.prototype,"polygonOffset",void 0),n.__decorate([l.parameter()],t.prototype,"writeDepth",void 0),n.__decorate([l.parameter()],t.prototype,"sceneHasOcludees",void 0),t}(l.ShaderTechniqueConfiguration);t.ImageMaterialTechniqueConfiguration=g}.apply(null,n))||(e.exports=a)},1492:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(11),r(26),r(49),r(40)],void 0===(a=function(e,t,r,n,a,i){Object.defineProperty(t,"__esModule",{value:!0});var o=[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],s={84:4326,83:4269,27:4267};function l(e){return o.some((function(t){var r=t[0],n=t[1];return e>=r&&e<=n}))}function u(e,t){var r=t&&t.getElementsByTagName(e);return r&&r.length>0?r[0]:null}function c(e,t,r){var n=u(e,t);return n?n.textContent:r}function p(e,t,r){if(!e)return null;var n,o,s,l,u=parseFloat(e.getAttribute("minx")),c=parseFloat(e.getAttribute("miny")),p=parseFloat(e.getAttribute("maxx")),d=parseFloat(e.getAttribute("maxy"));r?(n=isNaN(c)?-Number.MAX_VALUE:c,o=isNaN(u)?-Number.MAX_VALUE:u,s=isNaN(d)?Number.MAX_VALUE:d,l=isNaN(p)?Number.MAX_VALUE:p):(n=isNaN(u)?-Number.MAX_VALUE:u,o=isNaN(c)?-Number.MAX_VALUE:c,s=isNaN(p)?Number.MAX_VALUE:p,l=isNaN(d)?Number.MAX_VALUE:d);var h=new i({wkid:t});return new a({xmin:n,ymin:o,xmax:s,ymax:l,spatialReference:h})}function d(e,t){var r=u(t,e),a=u("DCPType",r);if(a){var i=u("HTTP",a);if(i){var o=u("Get",i);if(o){var s=function(e,t,r,n){var a=u("OnlineResource",r);return a?a.getAttribute("xlink:href"):null}(0,0,o);if(s)return s.indexOf("&")===s.length-1&&(s=s.substring(0,s.length-1)),function(e,t){var r=[],a=n.urlToObject(e);for(var i in a.query)a.query.hasOwnProperty(i)&&-1===t.indexOf(i.toLowerCase())&&r.push(i+"="+a.query[i]);return a.path+(r.length?"?"+r.join("&"):"")}(s,["service","request"])}}}return null}function h(e,t){var r=e.getElementsByTagName("Operation");if(!r||!r.length){var n=u(t,e).getElementsByTagName("Format");return Array.prototype.slice.call(n).map((function(e){return e.textContent}))}var a=Array.prototype.slice.call(r),i=[];return a.forEach((function(e){if(e.getAttribute("name")===t){var r=e.getElementsByTagName("Format");Array.prototype.slice.call(r).forEach((function(e){i.push(e.textContent)}))}})),i}function f(e,t,r){var n=function(e,t){for(var r=0;r<t.childNodes.length;r++){var n=t.childNodes[r];if(n.nodeType===Node.ELEMENT_NODE&&n.nodeName===e)return n}return null}(t,e);if(!n)return r;var a=n.textContent;if(null==a||""===a)return r;var i=Number(a);return isNaN(i)?r:i}function y(e,t,r){if(!e)return null;var n={id:r.idCounter++,fullExtents:[],parentLayerId:null,queryable:"1"===e.getAttribute("queryable"),spatialReferences:[],sublayers:null},o=u("LatLonBoundingBox",e),d=u("EX_GeographicBoundingBox",e),h=null;o&&(h=p(o,4326)),d&&((h=new a(0,0,0,0,new i({wkid:4326}))).xmin=parseFloat(c("westBoundLongitude",d,0)),h.ymin=parseFloat(c("southBoundLatitude",d,0)),h.xmax=parseFloat(c("eastBoundLongitude",d,0)),h.ymax=parseFloat(c("northBoundLatitude",d,0))),o||d||(h=new a(-180,-90,180,90,new i({wkid:4326}))),n.minScale=f(e,"MaxScaleDenominator",0),n.maxScale=f(e,"MinScaleDenominator",0);var m=["1.0.0","1.1.0","1.1.1"].indexOf(t)>-1?"SRS":"CRS";return Array.prototype.slice.call(e.childNodes).forEach((function(e){if("Name"===e.nodeName)n.name=e.textContent||"";else if("Title"===e.nodeName)n.title=e.textContent||"";else if("Abstract"===e.nodeName)n.description=e.textContent||"";else if("BoundingBox"===e.nodeName){var a=e.getAttribute(m);a&&0===a.indexOf("EPSG:")&&(0===(o=parseInt(a.substring(5),10))||isNaN(o)||h||(h="1.3.0"===t?p(e,o,l(o)):p(e,o)));var i=a&&a.indexOf(":");if(i&&i>-1){var o;0===(o=parseInt(a.substring(i+1,a.length),10))||isNaN(o)||(o=s[o]?s[o]:o);var c="1.3.0"===t?p(e,o,l(o)):p(e,o);n.fullExtents.push(c)}}else if(e.nodeName===m)e.textContent.split(" ").forEach((function(e){0===(e=e.indexOf(":")>-1?parseInt(e.split(":")[1],10):parseInt(e,10))||isNaN(e)||(s[e]&&(e=s[e]),-1===n.spatialReferences.indexOf(e)&&n.spatialReferences.push(e))}));else if("Style"!==e.nodeName||n.legendURL){if("Layer"===e.nodeName){var d=y(e,t,r);d&&(d.parentLayerId=n.id,n.sublayers||(n.sublayers=[]),n.sublayers.push(d))}}else{var f=u("LegendURL",e);if(f){var g=u("OnlineResource",f);g&&(n.legendURL=g.getAttribute("xlink:href"))}}})),n.extent=h&&h.toJSON(),n}t.parseCapabilities=function(e){if(!e)return null;var t={idCounter:-1};"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));var n=e.documentElement;if("ServiceExceptionReport"===n.nodeName){var i=Array.prototype.slice.call(n.childNodes).map((function(e){return e.textContent})).join("\r\n");throw new r("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",i)}var o=u("Layer",n);if(!o)return null;var s,l,p,f,m="WMS_Capabilities"===n.nodeName||"WMT_MS_Capabilities"===n.nodeName?n.getAttribute("version"):"1.3.0",g=u("Service",n),v=c("Title",g,"")||c("Name",g,""),_=c("AccessConstraints",g,""),x=c("Abstract",g,""),b=parseInt(c("MaxWidth",g,5e3),10),w=parseInt(c("MaxHeight",g,5e3),10),S=u("Capability",n),E=h(n,"GetMap"),P=d(n,"GetMap"),O=y(o,m,t),M=0;if(Array.prototype.slice.call(S.childNodes).forEach((function(e){"Layer"===e.nodeName&&(0===M?s=e:1===M?(O.name&&(O.name="",O.sublayers.push(y(s,m,t))),O.sublayers.push(y(e,m,t))):O.sublayers.push(y(e,m,t)),M++)})),!O)return null;var A=O.fullExtents;if((l=O.sublayers)||(l=[]),0===l.length&&l.push(O),!(p=O.extent)){var C=new a(l[0].extent);O.extent=C.toJSON(),p=O.extent}if(!(f=O.spatialReferences).length&&l.length>0){var R=function(e){var t=[];return e.sublayers.forEach((function(e){!t.length&&e.spatialReferences.length&&(t=e.spatialReferences||R(e))})),t};l.forEach((function(e){f.length||(f=e.spatialReferences||R(e))}))}var N,I=d(n,"GetFeatureInfo");if(I){var L=h(n,"GetFeatureInfo");L.indexOf("text/html")>-1?N="text/html":L.indexOf("text/plain")>-1&&(N="text/plain")}if(!N){var T=function(e){e&&(e.queryable=!1,e.sublayers&&e.sublayers.forEach((function(e){T(e)})))};T(O)}var D=function e(t){var r=[];return t.forEach((function(t){r.push(t),t.sublayers&&t.sublayers.length&&(r=r.concat(e(t.sublayers)),delete t.sublayers)})),r}(l),F=O.minScale||0;return{copyright:_,description:x,extent:p,fullExtents:A,featureInfoFormat:N,featureInfoUrl:I,mapUrl:P,maxImageWidth:b,maxImageHeight:w,maxScale:O.maxScale||0,minScale:F,layers:D,spatialReferences:f,supportedImageFormatTypes:E,title:v,version:m}},t.coordsReversed=l,t.getPopupLayers=function(e){return e.length?e.filter((function(e){return e.popupEnabled&&e.name&&e.queryable})).map((function(e){return e.name})).join(","):""}}.apply(null,n))||(e.exports=a)},1532:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(9),r(17),r(1),r(1492)],void 0===(a=function(e,t,r,n,a,i,o){var s={visible:"visibleSublayers"},l=[102100,3857,102113,900913],u=[3395,54004];return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._layerHandles=new a,t.extent=null,t._scale=null,t.view=null,t}return r.__extends(t,e),Object.defineProperty(t.prototype,"layer",{set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this._layerHandles&&(this._layerHandles.removeAll(),this._layerHandles=null),e&&(this._layerHandles||(this._layerHandles=new a),this._layerHandles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(s[e.propertyName])}))])))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join(",")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(e){this.view||(this._scale=e,this.notifyChange("scale"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visibleSublayers",{get:function(){var e=this.layer,t=this.scale,r=e.sublayers,n=[],a=function(e){var r=e.minScale,i=e.maxScale,o=e.sublayers;e.visible&&(0===t||(0===r||t<=r)&&(0===i||t>=i))&&(n.unshift(e),o&&o.forEach(a))};return r&&r.forEach(a),n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wkid",{get:function(){var e=this.extent,t=this.layer.spatialReferences,r=e.spatialReference&&e.spatialReference.wkid;t&&-1===t.indexOf(r)&&e.spatialReference.latestWkid&&(r=e.spatialReference.latestWkid);var n=l.some((function(e){return e===r}));if(!t)return r;if(n){var a=[];t.forEach((function(e){l.indexOf(e)>-1&&a.push(e)})),a.length||t.forEach((function(e){u.indexOf(e)>-1&&a.push(e)})),r=a.length>0?a[0]:l[0]}return r},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){var e=this.extent,t=this.layer,n=this.layers,a=t.imageFormat,i=t.imageTransparency,s=t.spatialReferences,l=t.version,u=this.wkid;s&&-1===s.indexOf(u)&&e.spatialReference.latestWkid&&(u=e.spatialReference.latestWkid);var c=e.xmin,p=e.ymin,d=e.xmax,h=e.ymax,f={bbox:"1.3.0"===t.version&&o.coordsReversed(u)?p+","+c+","+h+","+d:c+","+p+","+d+","+h,format:a,request:"GetMap",service:"WMS",styles:"",transparent:i,version:l};return isNaN(u)||("1.3.0"===l?f.crs="EPSG:"+u:f.srs="EPSG:"+u),r.__assign(r.__assign({},f),{layers:n})},r.__decorate([i.property()],t.prototype,"extent",void 0),r.__decorate([i.property()],t.prototype,"layer",null),r.__decorate([i.property({readOnly:!0,dependsOn:["visibleSublayers"]})],t.prototype,"layers",null),r.__decorate([i.property({type:Number,dependsOn:["view.scale"]})],t.prototype,"scale",null),r.__decorate([i.property()],t.prototype,"view",void 0),r.__decorate([i.property({dependsOn:["layers","layer.imageTransparency"],readOnly:!0})],t.prototype,"version",null),r.__decorate([i.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],t.prototype,"visibleSublayers",null),r.__decorate([i.property()],t.prototype,"wkid",null),r.__decorate([i.subclass("esri.layers.support.ExportWMSImageParameters")],t)}(n)}.apply(null,n))||(e.exports=a)},1673:function(e,t,r){var n,a;n=[r.dj.c(e.i),t,r(0),r(11),r(4),r(1)],void 0===(a=function(e,t,r,n,a,i){Object.defineProperty(t,"__esModule",{value:!0}),t.WMSLayerView=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.fetchPopupFeatures=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i,o,s,l,u,c,p,d;return r.__generator(this,(function(r){if(t=this.layer,!e)return[2,a.reject(new n("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}))];if(!(i=t.popupEnabled))return[2,a.reject(new n("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:i}))];if(o=this.createFetchPopupFeaturesQuery(e),s=o.extent,l=o.width,u=o.height,c=o.x,p=o.y,!(s&&l&&u))throw new n("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:s,width:l,height:u});return[2,(d=t.fetchFeatureInfo(s,l,u,c,p))?d.then((function(e){return[e]})):a.resolve([])]}))}))},r.__decorate([i.property()],t.prototype,"layer",void 0),r.__decorate([i.subclass("esri.layers.mixins.WMSLayerView")],t)}(e)}}.apply(null,n))||(e.exports=a)}}]);