(function(){var e={"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":1442,"esri/views/2d/engine/FeatureContainer":1635,"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":1707,"esri/views/2d/layers/features/tileRenderers/SymbolTileRenderer":2176,"esri/views/2d/layers/features/tileRenderers/support/WGLFeatureView":2177},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1442:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(15),r(675),r(677),r(246)],void 0===(n=function(e,t,r,i,n,a,s){Object.defineProperty(t,"__esModule",{value:!0});var o=n.enums.WGLVVFlag;function l(e){return{value:e.value,size:i.toPt(e.size)}}function u(e){return e.map((function(e){return l(e)}))}function p(e){if("string"==typeof e||"number"==typeof e)return i.toPt(e);var t=e;return{type:"size",expression:t.expression,stops:u(t.stops)}}t.getVisualVariableSizeValueRepresentationRatio=function(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e},t.stopToSizeStop=l,t.normalizeSizeStops=u,t.normalizeSizeElement=p,t.getVisualVariablesFields=function(e){var t=e&&e.length>0?{}:null;return t&&e.forEach((function(e){var r=e.type;e.field&&(t[r]=e.field)})),t};var c=function(e){for(var t=[],r=[],n=u(e),s=n.length,o=0;o<6;o++){var l=n[Math.min(o,s-1)];t.push(l.value),r.push(null==l.size?a.NAN_MAGIC_NUMBER:i.pt2px(l.size))}return{values:new Float32Array(t),sizes:new Float32Array(r)}};function d(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(n.Utils.isString(e.field)){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,i=0;i<8;++i){var a=r[Math.min(i,r.length-1)];t.values[i]=a.value,t.opacities[i]=a.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;var s=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(i=0;i<8;i++)t.values[i]=1/0,t.opacities[i]=s}return t}t.convertVisualVariables=function(e){var t=e&&e.length>0?{}:null,i=t?{}:null;if(!t)return{vvFields:t,vvRanges:i};for(var a=0,l=e;a<l.length;a++){var f=l[a],h=f.type;if(f.field&&(t[h]=f.field),"size"===h){i.size||(i.size={});var y=f;switch(n.getTypeOfSizeVisualVariable(y)){case o.SIZE_MINMAX_VALUE:i.size.minMaxValue={minDataValue:y.minDataValue,maxDataValue:y.maxDataValue,minSize:p(y.minSize),maxSize:p(y.maxSize)};break;case o.SIZE_SCALE_STOPS:i.size.scaleStops={stops:u(y.stops)};break;case o.SIZE_FIELD_STOPS:if(y.levels){var v={};for(var b in y.levels)v[b]=c(y.levels[b]);i.size.fieldStops={type:"level-dependent",levels:v}}else i.size.fieldStops=r.__assign({type:"static"},c(y.stops));break;case o.SIZE_UNIT_VALUE:i.size.unitValue={unit:y.valueUnit,valueRepresentation:y.valueRepresentation}}}else if("color"===h){var w=s.convertVisualVariables([f],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});if(!w)continue;i.color=w.color;for(var _=0;_<32;_+=4)n.color.premultiplyAlpha(i.color.colors,_,!0)}else if("opacity"===h)i.opacity=d(f);else if("rotation"===h){var g=f;i.rotation={type:g.rotationType}}}return{vvFields:t,vvRanges:i}}}.apply(null,i))||(e.exports=n)},1635:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(4),r(4),r(34),r(675)],void 0===(n=function(e,t,r,i,n,a,s){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var r=e.call(this,t)||this;return r._rendererInfo=new s.WGLRendererInfo,r._attachedResolver=i.createResolver(),r.attributeView=new s.AttributeStoreView,r}return r.__extends(t,e),t.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(e){return e.destroy()})),this.attributeView.destroy()},t.prototype.whenAttached=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,this._attachedResolver.promise];case 1:return e.sent(),[2]}}))}))},t.prototype.setRendererInfo=function(e,t,r){this._rendererInfo.setInfo(e,t,r),this.requestRender()},t.prototype.getMaterialItems=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,a;return r.__generator(this,(function(r){switch(r.label){case 0:return e&&0!==e.length?[4,this.whenAttached()]:[2,null];case 1:return r.sent(),i=this.stage.painter.textureManager,a=e.map((function(e){return i.rasterizeItem(e.symbol,e.glyphIds,t)})),[4,n.all(a)];case 2:return[2,r.sent().map((function(t,r){return{id:e[r].id,mosaicItem:t}}))]}}))}))},t.prototype.onTileData=function(e,t){if(t.addOrUpdate&&"tileDisplayData"in t.addOrUpdate)e.setData(t,this.hasLabels,this.labelsVisible);else{var i=t.addOrUpdate&&s.TileData.decode(t.addOrUpdate),n=r.__assign(r.__assign({},t),{addOrUpdate:i});e.setData(n,this.hasLabels,this.labelsVisible)}this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.onTileError=function(e){e.clear(),this.contains(e)||this.addChild(e)},t.prototype.renderChildren=function(t){this._rendererInfo.update(t.state),this.attributeView.bindTextures(this.stage.context),e.prototype.renderChildren.call(this,t)},t.prototype.createTile=function(e){var t=this._tileInfoView.getTileBounds(a.create(),e);return new s.WGLTile(e,t)},t.prototype.destroyTile=function(e){this.removeChild(e),e.destroy()},t.prototype.createRenderParams=function(t){return r.__assign(r.__assign({},e.prototype.createRenderParams.call(this,t)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})},t.prototype.onAttach=function(){e.prototype.onAttach.call(this);var t=this.stage.context.capabilities;t.textureFloat,t.vao,this._attachedResolver()},t.prototype.onDetach=function(){e.prototype.onDetach.call(this),this._attachedResolver=i.createResolver()},t}(s.TileContainer);t.FeatureContainer=o}.apply(null,i))||(e.exports=n)},1707:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(145),r(1)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var r=e.call(this,t)||this;return r.tiles=new Map,r}return r.__extends(t,e),t.prototype.destroy=function(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null},Object.defineProperty(t.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0}),t.prototype.acquireTile=function(e){var t=this,r=this.createTile(e);return r.once("isReady",(function(){return t.notifyChange("updating")})),this.tiles.set(e.id,r),r},t.prototype.lockAttributeTextureUpload=function(){},t.prototype.unlockAttributeTextureUpload=function(){},t.prototype.forceAttributeTextureUpload=function(){},t.prototype.forEachTile=function(e){this.tiles.forEach(e)},t.prototype.releaseTile=function(e){this.tiles.delete(e.key.id),this.disposeTile(e)},t.prototype.isUpdating=function(){var e=!0;return this.tiles.forEach((function(t){e=e&&t.isReady})),!e},t.prototype.setHighlight=function(){},t.prototype.invalidateLabels=function(){},t.prototype.requestUpdate=function(){this.layerView.requestUpdate()},r.__decorate([n.property()],t.prototype,"layer",void 0),r.__decorate([n.property()],t.prototype,"layerView",void 0),r.__decorate([n.property()],t.prototype,"tileInfoView",void 0),r.__decorate([n.property()],t.prototype,"updating",null),r.__decorate([n.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],t)}(i.HandleOwner);t.default=a}.apply(null,i))||(e.exports=n)},2176:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1),r(34),r(675),r(1765),r(1707),r(1442),r(2177)],void 0===(n=function(e,t,r,i,n,a,s,o,l,u){Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.install=function(e){var t=new u.WGLFeatureView(this.tileInfoView,this.layerView,this.layer);this.featuresView=t,e.addChild(t)},t.prototype.uninstall=function(e){e.removeChild(this.featuresView),this.featuresView.destroy()},t.prototype.hitTest=function(e,t){return this.featuresView.hitTest(e,t)},t.prototype.supportsRenderer=function(e){return null!=e&&-1!==["simple","class-breaks","unique-value","dot-density","dictionary"].indexOf(e.type)},t.prototype.onConfigUpdate=function(e){var t=null;if("visualVariables"in e){var r=(s.simplifyVVRenderer(e).visualVariables||[]).map((function(e){var t=e.clone();return"normalizationField"in e&&(t.normalizationField=null),e.valueExpression&&"$view.scale"!==e.valueExpression&&(t.valueExpression=null,t.field="nop"),t}));t=l.convertVisualVariables(r)}this.featuresView.setRendererInfo(e,t,this.layerView.effects)},t.prototype.onTileData=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileData(t,e.data),this.layerView.view.labelManager.requestUpdate()},t.prototype.onTileError=function(e){var t=this.tiles.get(e.tileKey);t&&this.featuresView.onTileError(t)},t.prototype.forceAttributeTextureUpload=function(){this.featuresView.attributeView.forceTextureUpload()},t.prototype.lockAttributeTextureUpload=function(){this.featuresView.attributeView.lockTextureUpload()},t.prototype.unlockAttributeTextureUpload=function(){this.featuresView.attributeView.unlockTextureUpload()},t.prototype.getMaterialItems=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,this.featuresView.getMaterialItems(e)]}))}))},t.prototype.invalidateLabels=function(){this.featuresView.hasLabels&&(this.tiles.forEach((function(e){return e.isDirty=!0})),this.layerView.view.labelManager.requestUpdate())},t.prototype.createTile=function(e){var t=this.tileInfoView.getTileBounds(n.create(),e),r=new a.WGLTile(e,t);return this.featuresView.hasLabels&&this.layerView.view.labelManager.addTile(this.layerView,r),r},t.prototype.disposeTile=function(e){this.featuresView.removeChild(e),this.featuresView.hasLabels&&this.layerView.view.labelManager.removeTile(this.layerView,e.key.id),e.destroy(),this.layerView.view.labelManager.requestUpdate()},r.__decorate([i.subclass("esri.views.2d.layers.features.tileRenderers.SymbolTileRenderer")],t)}(o.default);t.default=p}.apply(null,i))||(e.exports=n)},2177:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(4),r(675),r(1635),r(1390)],void 0===(n=function(e,t,r,i,n,a,s){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r,i){var n=e.call(this,t)||this;return n._pointToCallbacks=new Map,n._layer=i,n._layerView=r,n}return r.__extends(t,e),t.prototype.renderChildren=function(t){this.hasAnimation&&t.painter.effects.integrate.draw(t,t.attributeView),e.prototype.renderChildren.call(this,t)},t.prototype.hitTest=function(e,t){var r=[e,t],n=i.createResolver();return this._pointToCallbacks.set(r,n),this.requestRender(),n.promise},t.prototype.doRender=function(t){var r=this._layer,i=r.minScale,n=r.maxScale,a=t.state.scale;a<=(i||1/0)&&a>=n&&e.prototype.doRender.call(this,t)},Object.defineProperty(t.prototype,"hasAnimation",{get:function(){return this.hasLabels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasLabels",{get:function(){var e=this._layer.featureReduction,t=e&&"cluster"===e.type&&e.labelsVisible&&e.labelingInfo&&e.labelingInfo.length;return!!(this._layer.labelingInfo&&this._layer.labelingInfo.length||t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return this._layer.labelsVisible},enumerable:!0,configurable:!0}),t.prototype.prepareRenderPasses=function(t){var i=this,a=t.registerRenderPass({name:"label",brushes:[n.brushes.Label],target:function(){return i._layer.labelsVisible?i.children:null},drawPhase:s.WGLDrawPhase.LABEL|s.WGLDrawPhase.LABEL_ALPHA}),o=t.registerRenderPass({name:"geometry",brushes:[n.brushes.Fill,n.brushes.Line,n.brushes.Marker,n.brushes.Text],target:function(){return i.children},effects:[{apply:t.effects.highlight,enable:function(){return!!i._layerView.hasHighlight()}},{apply:t.effects.hittest,enable:function(){return!!i._pointToCallbacks.size},args:function(){return i._pointToCallbacks}}]});return r.__spreadArrays(e.prototype.prepareRenderPasses.call(this,t),[o,a])},t}(a.FeatureContainer);t.WGLFeatureView=o}.apply(null,i))||(e.exports=n)}}]);