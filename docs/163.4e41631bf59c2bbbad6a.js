(function(){var e={"esri/views/3d/layers/WMTSLayerView3D":1383},t=this||window,i=t.webpackJsonp=t.webpackJsonp||[];i.registerAbsMids?i.registerAbsMids(e):(i.absMidsWaiting=i.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{1383:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(0),i(11),i(5),i(13),i(1),i(680),i(712),i(678),i(679)],void 0===(n=function(e,t,i,r,n,o,a,s,l,p,d){var u=n.getLogger("esri.views.3d.layers.WMTSLayerView3d");return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"hasMixedImageFormats",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){var e=this,t=o.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeDone").then((function(){var t=function(){return new r("layerview:no-compatible-tiling-scheme","None of the tiling schemes supported by the service are compatible with the scene.")};if(!e.view.basemapTerrain.tilingSchemeLocked)throw t();var i,n=e.view.basemapTerrain.tilingScheme,o=e.layer.activeLayer;if(o&&o.tileMatrixSet){var a=(i=o.tileMatrixSet).tileInfo,s=e._getTileInfoSupportError(a,i.fullExtent)||e._getTileInfoCompatibilityError(a,n);if(s)throw s}else{if(!(i=e._getCompatibleTileMatrixSet()))throw t();o.tileMatrixSetId=i.id}e._set("tileInfo",i.tileInfo),e._set("fullExtent",i.fullExtent),e.layer.fullExtent=i.fullExtent}));this.addResolvingPromise(t),this.when((function(){return e._initialized()}))},t.prototype.refresh=function(){this.emit("data-changed")},t.prototype.canResume=function(){if(!e.prototype.canResume.call(this))return!1;var t=this.layer.activeLayer.tileMatrixSet;return t&&!this._getTileInfoError(t.tileInfo,t.fullExtent)},t.prototype.doRefresh=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.suspended||this.emit("data-changed"),[2]}))}))},t.prototype._initialized=function(){var e=this;this.updatingHandles.add(this,"layer.activeLayer.styleId",(function(){return e.refresh()})),this.updatingHandles.add(this,"tileMatrixSet",(function(){return e.refresh()})),this.updatingHandles.add(this.layer,"activeLayer",(function(t){var i=t.tileMatrixSet;if(i){var r=e._getTileInfoError(i.tileInfo,i.fullExtent);r&&(u.error("The selected tile matrix set is not compatible with the view",r),i=null)}else(i=e._getCompatibleTileMatrixSet())?t.tileMatrixSetId=i.id:u.error("The layer does not provide a tiling scheme that is compatible with the view");e.notifyChange("suspended"),e.canResume()&&e.refresh()}))},t.prototype._getCompatibleTileMatrixSet=function(){var e=this;return this.layer.activeLayer.tileMatrixSets.find((function(t){var i=t.tileInfo;return!e._getTileInfoError(i,t.fullExtent)}))},t.prototype._getTileInfoError=function(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)},i.__decorate([a.property({readOnly:!0})],t.prototype,"hasMixedImageFormats",null),i.__decorate([a.property()],t.prototype,"fullExtent",void 0),i.__decorate([a.property()],t.prototype,"layer",void 0),i.__decorate([a.property({dependsOn:["layer.activeLayer"]})],t.prototype,"suspended",void 0),i.__decorate([a.property()],t.prototype,"tileInfo",void 0),i.__decorate([a.subclass("esri.views.3d.layers.WMTSLayerView3D")],t)}(d.RefreshableLayerView(l.TiledLayerView3D(s.LayerView3D(p))))}.apply(null,r))||(e.exports=n)}}]);