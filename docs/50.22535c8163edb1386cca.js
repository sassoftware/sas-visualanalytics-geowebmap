(function(){var e={"esri/views/3d/layers/BuildingSceneLayerView3D":1371,"esri/views/layers/support/popupUtils":1398,"esri/layers/support/PromiseQueue":1417,"esri/layers/graphics/centroid":1428,"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":1429,"esri/views/3d/layers/support/DefinitionExpressionSceneLayerView":1546,"esri/views/3d/layers/BuildingSublayerView3D":1768,"esri/views/3d/layers/i3s/BuildingFilterUtil":1769,"esri/views/3d/layers/BuildingComponentSublayerView3D":1997,"esri/views/3d/layers/BuildingGroupSublayerView3D":1998},r=this||window,t=r.webpackJsonp=r.webpackJsonp||[];t.registerAbsMids?t.registerAbsMids(e):(t.absMidsWaiting=t.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{1371:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(91),t(23),t(5),t(2),t(4),t(4),t(13),t(1),t(1997),t(1998),t(680),t(1769),t(1395),t(691),t(678)],void 0===(n=function(e,r,t,i,n,o,s,a,l,u,p,d,c,f,y,h,g,v){var _=o.getLogger("esri.views.3d.layers.BuildingSceneLayerView3D");return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.componentLayerViews=new n,r.groupLayerViews=new n,r._abortController=a.createAbortController(),r._loadingComponents=0,r}return t.__extends(r,e),Object.defineProperty(r.prototype,"filterExpression",{get:function(){var e=this.layer.activeFilterId,r=null!=e?this.layer.filters.find((function(r){return r.id===e})):null,t=null!=r?r.filterBlocks.find((function(e){return"solid"===e.filterMode.type})):null;return t?t.filterExpression:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"filterExpressions",{get:function(){var e=this.layer.activeFilterId,r=null!=e?this.layer.filters.find((function(r){return r.id===e})):null;return r&&r.filterBlocks?r.filterBlocks.toArray().map((function(e){return[e.filterExpression,y.parseFilterMode(e)]})):[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"updatingProgressValue",{get:function(){var e=this.componentLayerViews,r=this._loadingComponents+(e?e.length:0);return e.reduce((function(e,r){return e+r.updatingProgress}),0)/r},enumerable:!0,configurable:!0}),r.prototype.isUpdating=function(){return this._loadingComponents>0||this.componentLayerViews&&this.componentLayerViews.some((function(e){return e.updating}))},r.prototype.initialize=function(){h.checkSpatialReference(this.layer.spatialReference,this.view.spatialReference,this.view.viewingMode),this.initializeSubLayerViews(this.layer.sublayers,this)},r.prototype.destroy=function(){this.groupLayerViews&&(this.groupLayerViews.forEach((function(e){return e.destroy()})),this.groupLayerViews=null),this.componentLayerViews&&(this.componentLayerViews.forEach((function(e){return e.destroy()})),this.componentLayerViews=null),this._abortController.abort(),this._abortController=null},r.prototype.initializeSubLayerViews=function(e,r){var t=this,i=this,n=this.view;e.forEach((function(e){if(!e.isEmpty)if("building-group"===e.type){var o=new c({layer:e,view:n,parent:r});t.groupLayerViews.push(o),t.initializeSubLayerViews(e.sublayers,o)}else"mesh"===e.geometryType&&(t._loadingComponents++,e.load({signal:t._abortController.signal}).then((function(){var o=new d({layer:e,layerView:i,view:n,parent:r});t.componentLayerViews.push(o),t.handles.add([u.init(o,"updating",(function(){return t.notifyChange("updating")}),!0),u.init(o,"updatingProgress",(function(){return t.notifyChange("updatingProgressValue")}),!0)])})).catch((function(r){l.isAbortError(r)||_.error("Error while creating view for sublayer "+e.id+"\nLayer: "+t.layer.url+"\n",r)})).then((function(){t._loadingComponents--,t.notifyChange("updating"),t.notifyChange("updatingProgressValue")})))}))},r.prototype.getGraphicFromIntersectorMetadata=function(e){for(var r=0,t=this.componentLayerViews.items;r<t.length;r++){var i=t[r];if(i.layer.uid===e.sublayerUid)return i.getGraphicFromIntersectorMetadata(e)}return null},r.prototype.fetchPopupFeatures=function(e,r){return t.__awaiter(this,void 0,void 0,(function(){var i;return t.__generator(this,(function(t){return s.isSome(r)&&r.clientGraphics&&0!==r.clientGraphics.length?(i=this._findComponent(r.clientGraphics[0].sourceLayer),s.isNone(i)?[2,void 0]:[2,i.fetchPopupFeatures(e,r)]):[2,void 0]}))}))},r.prototype.whenGraphicBounds=function(e){var r=this._findComponent(e.sourceLayer);return s.isNone(r)?a.reject():r.whenGraphicBounds(e)},r.prototype._findComponent=function(e){return this.componentLayerViews.find((function(r){return e===r.layer}))},r.prototype.highlight=function(e){e instanceof i?e=[e]:e instanceof n&&(e=e.toArray());var r=[];if(Array.isArray(e)&&e.length>0&&e[0]instanceof i){for(var t=e,o=new Map,s=0,a=t;s<a.length;s++){var l=a[s],u=o.get(l.sourceLayer);null==u&&(u=[],o.set(l.sourceLayer,u)),u.push(l)}this.componentLayerViews.forEach((function(e){var t=o.get(e.layer);t&&r.push(e.highlight(t))}))}return{remove:function(){return r.forEach((function(e){return e.remove()}))},pause:function(){return r.forEach((function(e){return e.pause()}))},resume:function(){return r.forEach((function(e){return e.resume()}))}}},r.prototype.getUsedMemory=function(){return this.componentLayerViews.reduce((function(e,r){return e+r.getUsedMemory()}),0)},r.prototype.getUnloadedMemory=function(){return this.componentLayerViews.reduce((function(e,r){return e+r.getUnloadedMemory()}),0)},r.prototype.ignoresMemoryFactor=function(){return!1},t.__decorate([p.property()],r.prototype,"layer",void 0),t.__decorate([p.property()],r.prototype,"componentLayerViews",void 0),t.__decorate([p.property()],r.prototype,"groupLayerViews",void 0),t.__decorate([p.property({readOnly:!0,dependsOn:["layer.filters","layer.activeFilterId"]})],r.prototype,"filterExpression",null),t.__decorate([p.property({readOnly:!0,dependsOn:["layer.filters","layer.activeFilterId"]})],r.prototype,"filterExpressions",null),t.__decorate([p.property(g.updatingProgress)],r.prototype,"updatingProgress",void 0),t.__decorate([p.property({readOnly:!0})],r.prototype,"updatingProgressValue",null),t.__decorate([p.subclass("esri.views.3d.layers.BuildingSceneLayerView3D")],r)}(f.LayerView3D(v))}.apply(null,i))||(e.exports=n)},1398:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(234),t(2),t(66)],void 0===(n=function(e,r,t,i,n,o){Object.defineProperty(r,"__esModule",{value:!0}),r.getRequiredFields=function(e,r){return void 0===r&&(r=e.popupTemplate),t.__awaiter(this,void 0,void 0,(function(){var s,a,l,u,p,d,c,f,y;return t.__generator(this,(function(h){switch(h.label){case 0:return n.isSome(r)?[4,r.getRequiredFields(e.fields)]:[2,[]];case 1:return s=h.sent(),a=r.lastEditInfoEnabled,l=e.objectIdField,u=e.typeIdField,p=e.globalIdField,d=e.relationships,i.includes(s,"*")?[2,["*"]]:a?[4,o.getFeatureEditFields(e)]:[3,3];case 2:return f=h.sent(),[3,4];case 3:f=[],h.label=4;case 4:return c=f,y=o.fixFields(e.fields,t.__spreadArrays(s,c)),u&&y.push(u),y&&l&&o.hasField(e.fields,l)&&-1===y.indexOf(l)&&y.push(l),y&&p&&o.hasField(e.fields,p)&&-1===y.indexOf(p)&&y.push(p),d&&d.forEach((function(r){var t=r.keyField;y&&t&&o.hasField(e.fields,t)&&-1===y.indexOf(t)&&y.push(t)})),[2,y]}}))}))},r.getFetchPopupTemplate=function(e,r){return e.popupTemplate?e.popupTemplate:n.isSome(r)&&r.defaultPopupTemplateEnabled&&n.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}.apply(null,i))||(e.exports=n)},1417:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(4)],void 0===(n=function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(){this._tasks=new Array}return Object.defineProperty(e.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0}),e.prototype.push=function(e){var r=this;return t.create((function(t,i){return r._tasks.push(new n(t,i,e))}))},e.prototype.unshift=function(e){var r=this;return t.create((function(t,i){return r._tasks.unshift(new n(t,i,e))}))},e.prototype.process=function(){if(0===this._tasks.length)return!1;var e=this._tasks.shift();try{var r=e.callback();r&&"then"in r&&"function"==typeof r.then?r.then(e.resolve,e.reject):e.resolve(r)}catch(r){e.reject(r)}return!0},e.prototype.cancelAll=function(){for(var e=t.createAbortError(),r=0,i=this._tasks;r<i.length;r++)i[r].reject(e);this._tasks.length=0},e}();r.default=i;var n=function(e,r,t){this.resolve=e,this.reject=r,this.callback=t}}.apply(null,i))||(e.exports=n)},1428:function(e,r,t){var i,n;i=[t.dj.c(e.i),r],void 0===(n=function(e,r){function t(e,r){return e?r?4:3:r?3:2}function i(e,r,i,n,o,s){for(var a=t(o,s),l=i,u=i+a,p=0,d=0,c=0,f=0,y=0,h=0,g=n-1;h<g;h++,l+=a,u+=a){var v=r[l],_=r[l+1],b=r[l+2],w=r[u],m=r[u+1],E=r[u+2],F=v*m-w*_;f+=F,p+=(v+w)*F,d+=(_+m)*F,o&&(c+=(b+E)*(F=v*E-w*b),y+=F),v<e[0]&&(e[0]=v),v>e[1]&&(e[1]=v),_<e[2]&&(e[2]=_),_>e[3]&&(e[3]=_),o&&(b<e[4]&&(e[4]=b),b>e[5]&&(e[5]=b))}if(f>0&&(f*=-1),y>0&&(y*=-1),!f)return null;var x=[p,d,.5*f];return o&&(x[3]=c,x[4]=.5*y),x}function n(e,r,i,n,u){for(var p=t(n,u),d=r,c=r+p,f=0,y=0,h=0,g=0,v=0,_=i-1;v<_;v++,d+=p,c+=p){var b,w=e[d],m=e[d+1],E=e[d+2],F=e[c],x=e[c+1],O=e[c+2],I=n?s(w,m,E,F,x,O):o(w,m,F,x);I&&(f+=I,n?(y+=I*(b=l(w,m,E,F,x,O))[0],h+=I*b[1],g+=I*b[2]):(y+=I*(b=a(w,m,F,x))[0],h+=I*b[1]))}return f>0?n?[y/f,h/f,g/f]:[y/f,h/f]:i>0?n?[e[r],e[r+1],e[r+2]]:[e[r],e[r+1]]:null}function o(e,r,t,i){var n=t-e,o=i-r;return Math.sqrt(n*n+o*o)}function s(e,r,t,i,n,o){var s=i-e,a=n-r,l=o-t;return Math.sqrt(s*s+a*a+l*l)}function a(e,r,t,i){return[e+.5*(t-e),r+.5*(i-r)]}function l(e,r,t,i,n,o){return[e+.5*(i-e),r+.5*(n-r),t+.5*(o-t)]}Object.defineProperty(r,"__esModule",{value:!0}),r.getCentroidOptimizedGeometry=function(e,r,o,s){if(!r||!r.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var a=e.coords,l=[],u=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=r.lengths,d=r.coords,c=t(o,s),f=0,y=0,h=p;y<h.length;y++){var g=h[y],v=i(u,d,f,g,o,s);v&&l.push(v),f+=g*c}if(l.sort((function(e,r){var t=e[2]-r[2];return 0===t&&o&&(t=e[4]-r[4]),t})),l.length){var _=6*l[0][2];a[0]=l[0][0]/_,a[1]=l[0][1]/_,o&&(_=6*l[0][4],a[2]=0!==_?l[0][3]/_:0),(a[0]<u[0]||a[0]>u[1]||a[1]<u[2]||a[1]>u[3]||o&&(a[2]<u[4]||a[2]>u[5]))&&(a.length=0)}if(!a.length){var b=r.lengths[0]?n(d,0,p[0],o,s):null;if(!b)return null;a[0]=b[0],a[1]=b[1],o&&b.length>2&&(a[2]=b[2])}return e},r.lineCentroid=n}.apply(null,i))||(e.exports=n)},1429:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(1428),t(419),t(414)],void 0===(n=function(e,r,t,i,n){Object.defineProperty(r,"__esModule",{value:!0}),r.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,r){return e.attributes[r]},cloneWithGeometry:function(e,r){return new i.default(r,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,r){return e.centroid||(e.centroid=t.getCentroidOptimizedGeometry(new n.default,e.geometry,r.hasZ,r.hasM)),e.centroid}},r.default=r.optimizedFeatureQueryEngineAdapter}.apply(null,i))||(e.exports=n)},1546:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(5),t(1),t(681),t(1395)],void 0===(n=function(e,r,t,i,n,o,s){Object.defineProperty(r,"__esModule",{value:!0});var a=i.getLogger("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView");r.DefinitionExpressionSceneLayerView=function(e){return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._definitionExpressionErrors=0,r._maxDefinitionExpressionErrors=20,r.logError=function(e){r._definitionExpressionErrors<r._maxDefinitionExpressionErrors&&a.error("Error while evaluating definitionExpression: "+e),r._definitionExpressionErrors++,r._definitionExpressionErrors===r._maxDefinitionExpressionErrors&&a.error("Further errors are ignored")},r}return t.__extends(r,e),Object.defineProperty(r.prototype,"parsedDefinitionExpression",{get:function(){if(!this.layer||!this.layer.definitionExpression)return null;try{var e=o.WhereClause.create(this.layer.definitionExpression,this.layer.fieldsIndex);if(!e.isStandardized)return a.error("definitionExpression is using non standard function"),null;var r=[],t=e.fieldNames;return s.findFieldsCaseInsensitive(t,this.layer.fields,{missingFields:r}),r.length>0?(a.error("definitionExpression references unknown fields: "+r.join(", ")),null):(this._definitionExpressionErrors=0,e)}catch(e){return a.error("Failed to parse definitionExpression: "+e),null}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"definitionExpressionFields",{get:function(){return this.parsedDefinitionExpression?this.parsedDefinitionExpression.fieldNames:null},enumerable:!0,configurable:!0}),r.prototype._evaluateClause=function(e,r){try{return e.testFeature(r)}catch(e){return this.logError(e),!1}},r.prototype._addDefinitionExpressionToQuery=function(e){if(!this.parsedDefinitionExpression)return e;var r=this.layer.definitionExpression,t=e.clone();return t.where?t.where="("+r+") AND ("+t.where+")":t.where=r,t},t.__decorate([n.property()],r.prototype,"layer",void 0),t.__decorate([n.property({readOnly:!0,dependsOn:["layer.definitionExpression","layer.fieldsIndex"]})],r.prototype,"parsedDefinitionExpression",null),t.__decorate([n.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],r.prototype,"definitionExpressionFields",null),t.__decorate([n.subclass("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView")],r)}(e)}}.apply(null,i))||(e.exports=n)},1768:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(9),t(38),t(145),t(132),t(127),t(1)],void 0===(n=function(e,r,t,i,n,o,s,a,l){return function(e){function r(r){var t=e.call(this,r)||this;return t.layer=null,t.parent=null,t.view=null,t}return t.__extends(r,e),r.prototype.initialize=function(){},r.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(r.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),r.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.visible||!1},r.prototype.isUpdating=function(){return!1},t.__decorate([l.property()],r.prototype,"layer",void 0),t.__decorate([l.property()],r.prototype,"parent",void 0),t.__decorate([l.property({readOnly:!0,dependsOn:["view","visible","parent.suspended"]})],r.prototype,"suspended",null),t.__decorate([l.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],r.prototype,"updating",null),t.__decorate([l.property()],r.prototype,"view",void 0),t.__decorate([l.property({dependsOn:["layer.visible"]})],r.prototype,"visible",null),t.__decorate([l.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],r.prototype,"fullOpacity",null),t.__decorate([l.subclass("esri.views.3d.layers.BuildingSublayerView3D")],r)}(a.EsriPromiseMixin(o.HandleOwnerMixin(s.IdentifiableMixin(n.EventedMixin(i)))))}.apply(null,i))||(e.exports=n)},1769:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(2),t(31),t(427)],void 0===(n=function(e,r,t,i,n,o){Object.defineProperty(r,"__esModule",{value:!0}),r.parseFilterMode=function(e){switch(e.filterMode.type){case"solid":return{mode:0};case"wire-frame":return{mode:1,edgeMaterial:o.createMaterialFromEdges(e.filterMode.edges,{})};case"x-ray":return{mode:2}}},r.applyFilterMode=function(e,r){if(i.isNone(r))return e.color[3]=0,e.edgeMaterial=null,void(e.pickable=!1);switch(r.mode){case 0:return;case 1:return e.color[3]=0,e.edgeMaterial=r.edgeMaterial,void(e.pickable=!1);case 2:return e.color[0]=1,e.color[1]=1,e.color[2]=1,e.color[3]*=.15,e.colorMixMode=3,e.castShadows=!1,e.pickable=!1,void(e.edgeMaterial=function(e){return i.isNone(e)?null:(s.lastMaterial!==e&&(s.cachedMaterial=function(e){var r=n.vec4f64.clone(e.color);return r[3]*=.075,t.__assign(t.__assign({},e),{color:r})}(e),s.lastMaterial=e),s.cachedMaterial)}(e.edgeMaterial))}};var s={cachedMaterial:null,lastMaterial:null}}.apply(null,i))||(e.exports=n)},1997:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(91),t(11),t(5),t(2),t(4),t(92),t(1),t(681),t(66),t(1768),t(1590),t(1769),t(1395),t(1546),t(1398)],void 0===(n=function(e,r,t,i,n,o,s,a,l,u,p,d,c,f,y,h,g,v){var _=o.getLogger("esri.views.3d.layers.BuildingComponentSublayerView3D");return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.layerView=null,r._elevationContext="scene",r._isIntegratedMesh=!1,r._supportsLabeling=!1,r.lodFactor=1,r.progressiveLoadFactor=1,r}return t.__extends(r,e),Object.defineProperty(r.prototype,"layerUid",{get:function(){return this.layer.layer.uid},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sublayerUid",{get:function(){return this.layer.uid},enumerable:!0,configurable:!0}),r.prototype.initialize=function(){var e=this;this.updatingHandles.add(this,"layer.renderer",(function(){return e._updateRequiredFields()})),this.updatingHandles.add(this,"definitionExpressionFields",(function(){return e._updateRequiredFields()})),this.updatingHandles.add(this,"filterExpressionFields",(function(){return e._updateRequiredFields()})),this.updatingHandles.add(this.layer,"renderer",(function(r){return e._rendererChange(r)}),2),this.updatingHandles.add(this,"parsedDefinitionExpression",(function(){return e._filterChange()})),this.updatingHandles.add(this,"parsedFilterExpressions",(function(){return e._updateSymbologyOverride()}),2),this.addResolvingPromise(this._updateRequiredFields())},Object.defineProperty(r.prototype,"parsedFilterExpressions",{get:function(){var e=this;return"Overview"===this.layer.modelName?[]:this.layerView.filterExpressions.map((function(r){var t,i=r[0],n=r[1];try{t=p.WhereClause.create(i,e.layer.fieldsIndex)}catch(e){return _.error("Failed to parse filterExpression: "+e),null}if(!t.isStandardized)return _.error("filterExpression is using non standard function"),null;var o=[],s=t.fieldNames;return h.findFieldsCaseInsensitive(s,e.layer.fields,{missingFields:o}),o.length>0?(_.error("filterExpression references unknown fields: "+o.join(", ")),null):[t,n]})).filter((function(e){return null!=e}))},enumerable:!0,configurable:!0}),r.prototype._updateSymbologyOverride=function(){var e=this,r=this.parsedFilterExpressions;r.length>0?this._setSymbologyOverride((function(t,i){for(var n=0,o=r;n<o.length;n++){var s=o[n],a=s[0],l=s[1];try{if(a.testFeature(t))return y.applyFilterMode(i,l)}catch(r){e.logError(r)}}return y.applyFilterMode(i,null)}),this.filterExpressionFields):this._setSymbologyOverride(null,null)},Object.defineProperty(r.prototype,"filterExpressionFields",{get:function(){return d.fixFields(this.layer.fields,this.parsedFilterExpressions.reduce((function(e,r){var t=r[0];return e.concat(t.fieldNames)}),[]))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availableFields",{get:function(){var e=this.layer,r=e.fields,i=this.requiredFields;if(e.outFields||e.layer.outFields){var n=t.__spreadArrays(e.outFields||[],e.layer.outFields||[]);i=t.__spreadArrays(d.unpackFieldNames(r,n),i)}return d.fixFields(r,i)},enumerable:!0,configurable:!0}),r.prototype._createLayerGraphic=function(e){var r=new i(null,null,e);return r.layer=this.layer.layer,r.sourceLayer=this.layer,r},r.prototype.canResume=function(){return e.prototype.canResume.call(this)&&(!this._controller||this._controller.rootNodeVisible)},r.prototype.isUpdating=function(){return this.updatingMeshView3D},r.prototype.fetchPopupFeatures=function(e,r){return t.__awaiter(this,void 0,void 0,(function(){var e,i,n,o,u,p,c,f,y,h;return t.__generator(this,(function(t){switch(t.label){case 0:return(e=this._validateFetchPopupFeatures(r))?[2,a.reject(e)]:s.isSome(r)&&r.clientGraphics&&0!==r.clientGraphics.length?(i=[],n=[],u=d.unpackFieldNames,p=[this.layer.fields],[4,v.getRequiredFields(this.layer,v.getFetchPopupTemplate(this.layer,r))]):[2,[]];case 1:for(o=u.apply(void 0,p.concat([t.sent()])),c=new Set,f=0,y=r.clientGraphics;f<y.length;f++)h=y[f],d.populateMissingFields(o,h,c)?n.push(h):i.push(h);return 0===n.length?[2,a.resolve(i)]:[2,this.whenGraphicAttributes(n,l.valuesOfSet(c)).catch((function(){return n})).then((function(e){return i.concat(e)}))]}}))}))},r.prototype._updateRequiredFields=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,r,i,n;return t.__generator(this,(function(o){switch(o.label){case 0:return r=d.fixFields,i=[this.layer.fields],this.layer.renderer?[4,this.layer.renderer.getRequiredFields(this.layer.fields)]:[3,2];case 1:return n=o.sent(),[3,3];case 2:n=[],o.label=3;case 3:return e=r.apply(void 0,i.concat([t.__spreadArrays.apply(void 0,[n,this.definitionExpressionFields||[],this.filterExpressionFields||[]])])),this._set("requiredFields",e),[2]}}))}))},r.prototype._validateFetchPopupFeatures=function(e){var r=this.layer;return r.popupEnabled?v.getFetchPopupTemplate(r,e)?void 0:new n("buildingscenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:r}):new n("buildingscenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:r})},r.prototype.getFilters=function(){var r=e.prototype.getFilters.call(this);return this.addSqlFilter(r,this.parsedDefinitionExpression,this.definitionExpressionFields,this.logError),r},t.__decorate([u.property()],r.prototype,"layer",void 0),t.__decorate([u.property()],r.prototype,"layerView",void 0),t.__decorate([u.property({dependsOn:["updatingMeshView3D"]})],r.prototype,"updating",void 0),t.__decorate([u.property({dependsOn:["_controller.rootNodeVisible"]})],r.prototype,"suspended",void 0),t.__decorate([u.property({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.3dObject.lodFactor"})],r.prototype,"lodFactor",void 0),t.__decorate([u.property({readOnly:!0,dependsOn:["layerView.filterExpressions","layer.fieldsIndex"]})],r.prototype,"parsedFilterExpressions",null),t.__decorate([u.property({type:[String],readOnly:!0,dependsOn:["parsedFilterExpressions"]})],r.prototype,"filterExpressionFields",null),t.__decorate([u.property({type:[String],readOnly:!0})],r.prototype,"requiredFields",void 0),t.__decorate([u.property({type:[String],readOnly:!0,dependsOn:["layer.outFields","layer.layer.outFields","requiredFields"]})],r.prototype,"availableFields",null),t.__decorate([u.subclass("esri.views.3d.layers.BuildingComponentSublayerView3D")],r)}(g.DefinitionExpressionSceneLayerView(f.I3SMeshView3D(c)))}.apply(null,i))||(e.exports=n)},1998:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(0),t(1),t(1768)],void 0===(n=function(e,r,t,i,n){return function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t.__extends(r,e),t.__decorate([i.subclass("esri.views.3d.layers.BuildingGroupSublayerView3D")],r)}(n)}.apply(null,i))||(e.exports=n)}}]);