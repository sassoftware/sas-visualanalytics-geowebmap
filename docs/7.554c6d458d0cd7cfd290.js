(function(){var e={"esri/layers/graphics/data/projectionSupport":1397,"esri/core/libs/quickselect/quickselect":1409,"esri/geometry/projection":1413,"esri/core/libs/rbush/rbush":1414,"esri/geometry/geometryAdapters/json":1426,"esri/geometry/pe":1439,"esri/geometry/support/GeographicTransformation":1440,"esri/geometry/support/GeographicTransformationStep":1441,"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":1442,"esri/views/2d/layers/features/support/AttributeStore":1466,"esri/views/2d/layers/graphics/graphicsUtils":1467,"esri/views/2d/layers/graphics/GraphicsView2D":1488,"esri/views/2d/layers/features/support/Tile":1518,"esri/views/2d/layers/features/support/TileStore":1634,"esri/views/2d/engine/FeatureContainer":1635,"esri/views/layers/GraphicsView":1636,"esri/core/MapPool":1923,"esri/views/2d/layers/graphics/GraphicContainer":1924,"esri/views/2d/layers/graphics/GraphicProcessingQueue":1925,"esri/views/2d/layers/graphics/GraphicStore":1926,"esri/views/2d/layers/graphics/GraphicStoreItem":1927},t=this||window,r=t.webpackJsonp=t.webpackJsonp||[];r.registerAbsMids?r.registerAbsMids(e):(r.absMidsWaiting=r.absMidsWaiting||[]).push(e)})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1397:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(11),r(4),r(1413),r(1426),r(76),r(46)],void 0===(n=function(e,t,r,i,n,o,a,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=[0,0];function p(e,t){var r,i,n;if(!t)return null;if("x"in t){var o={x:0,y:0};return r=e(t.x,t.y,l),o.x=r[0],o.y=r[1],null!=t.z&&(o.z=t.z),null!=t.m&&(o.m=t.m),o}return"xmin"in t?(o={xmin:0,ymin:0,xmax:0,ymax:0},i=e(t.xmin,t.ymin,l),o.xmin=i[0],o.ymin=i[1],n=e(t.xmax,t.ymax,l),o.xmax=n[0],o.ymax=n[1],t.hasZ&&(o.zmin=t.zmin,o.zmax=t.zmax,o.hasZ=!0),t.hasM&&(o.mmin=t.mmin,o.mmax=t.mmax,o.hasM=!0),o):"rings"in t?{rings:h(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:h(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:c(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function h(e,t){for(var r=[],i=0,n=e;i<n.length;i++){var o=n[i];r.push(c(o,t))}return r}function c(e,t){for(var r=[],i=0,n=e;i<n.length;i++){var o=n[i],a=t(o[0],o[1],[0,0]);r.push(a),o.length>2&&a.push(o[2]),o.length>3&&a.push(o[3])}return r}function d(e,t){return!(!s.isValid(e)||!s.isValid(t)||s.equals(e,t)||u.canProject(e,t))}t.doesBrowserSupportProjection=function(e,t){return!d(e,t)||o.isSupported()},t.checkProjectionSupport=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,a,s;return r.__generator(this,(function(r){if(!t)return[2];if(Array.isArray(e)){for(n=0,a=e;n<a.length;n++)if(d((s=a[n]).geometry&&s.geometry.spatialReference,t)){if(o.isSupported())return[2,o.load()];throw new i("feature-store:unsupported-query","projection not supported",{inSpatialReference:e,outSpatialReference:t})}return[2]}if(!d(e,t))return[2];if(o.isSupported())return[2,o.load()];throw new i("feature-store:unsupported-query","projection not supported",{inSpatialReference:e,outSpatialReference:t})}))}))};var _=p.bind(null,u.lngLatToXY),f=p.bind(null,u.xyToLngLat);t.project=function(e,t,r){return e?(r||(r=t,t=e.spatialReference),s.isValid(t)&&s.isValid(r)&&!s.equals(t,r)?u.canProject(t,r)?s.isWebMercator(r)?_(e):f(e):o.projectMany(a.jsonAdapter,[e],t,r,null)[0]:e):e};var g=new(function(){function e(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return e.prototype.push=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){var o,a=this;return r.__generator(this,(function(r){return e&&e.length&&t&&i&&!s.equals(t,i)||n.resolve(e),o={geometries:e,inSpatialReference:t,outSpatialReference:i,resolve:null},this._jobs.push(o),[2,n.create((function(e){o.resolve=e,null===a._timer&&(a._timer=setTimeout(a._process,10))}))]}))}))},e.prototype._process=function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,i=e.outSpatialReference,n=e.resolve;u.canProject(r,i)?s.isWebMercator(i)?n(t.map(_)):n(t.map(f)):n(o.projectMany(a.jsonAdapter,t,r,i,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}},e}());t.projectMany=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return[2,g.push(e,t,i)]}))}))}}.apply(null,i))||(e.exports=n)},1409:function(e,t,r){var i;void 0===(i=function(){"use strict";function e(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function t(e,t){return e<t?-1:e>t?1:0}return function(r,i,n,o,a){!function t(r,i,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,u=i-n+1,l=Math.log(s),p=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*p*(s-p)/s)*(u-s/2<0?-1:1);t(r,i,Math.max(n,Math.floor(i-u*p/s+h)),Math.min(o,Math.floor(i+(s-u)*p/s+h)),a)}var c=r[i],d=n,_=o;for(e(r,n,i),a(r[o],c)>0&&e(r,n,o);d<_;){for(e(r,d,_),d++,_--;a(r[d],c)<0;)d++;for(;a(r[_],c)>0;)_--}0===a(r[n],c)?e(r,n,_):e(r,++_,o),_<=i&&(n=_+1),i<=_&&(o=_-1)}}(r,i,n||0,o||r.length-1,a||t)}}.apply(null,[]))||(e.exports=i)},1413:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4),r(1439),r(1440),r(14)],void 0===(n=function(e,t,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=null,s=null;t.isLoaded=function(){return!!a&&n.isLoaded()},t.isSupported=function(){return n.isSupported()};var u=null;t.load=function(){return u||(u=i.all([n.load(),new Promise((function(e,t){r.e(8).then(function(){var t=[r(1458)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})),new Promise((function(e,t){r.e(106).then(function(){var t=[r(1483)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))]).then((function(e){var t=e[1],r=e[2].hydratedAdapter;s=r,(a=t)._enableProjection(n)})))},t.project=function(e,t,r){return void 0===r&&(r=null),e instanceof Array?0===e.length?[]:p(s,e,e[0].spatialReference,t,r):p(s,[e],e.spatialReference,t,r)[0]};var l={};function p(e,t,r,i,n){if(void 0===n&&(n=null),null===n){var s=o.cacheKey(r,i);void 0!==l[s]?n=l[s]:(null===(n=h(r,i,null))&&(n=new o),l[s]=n)}return a._project(e,t,r,i,n)}function h(e,t,r){void 0===r&&(r=null);var i=a._getTransformation(s,e,t,r,null==r?void 0:r.spatialReference);return null!==i?o.fromGE(i):null}t.projectMany=p,t.getTransformation=h,t.getTransformations=function(e,t,r){void 0===r&&(r=null);var i=a._getTransformationBySuitability(s,e,t,r,null==r?void 0:r.spatialReference);if(null!==i){for(var n=[],u=0,l=i;u<l.length;u++){var p=l[u];n.push(o.fromGE(p))}return n}return[]}}.apply(null,i))||(e.exports=n)},1414:function(e,t,r){var i,n;i=[r(1409)],void 0===(n=function(e){"use strict";function t(e,r){if(!(this instanceof t))return new t(e,r);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this.toBBox=r:this._initFormat(r)),this.clear()}function r(e,t,r){if(!r)return t.indexOf(e);for(var i=0;i<t.length;i++)if(r(e,t[i]))return i;return-1}function i(e,t){n(e,0,e.children.length,t,e)}function n(e,t,r,i,n){n||(n=c(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,s=t;s<r;s++)a=e.children[s],o(n,e.leaf?i(a):a);return n}function o(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function a(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function l(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function h(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function c(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(t,r,i,n,o){for(var a,s=[r,i];s.length;)(i=s.pop())-(r=s.pop())<=n||(a=r+Math.ceil((i-r)/n/2)*n,e(t,a,r,i,o),s.push(r,a,a,i))}return t.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],i=this.toBBox;if(!h(e,t))return r;for(var n,o,a,s,u=[];t;){for(n=0,o=t.children.length;n<o;n++)a=t.children[n],h(e,s=t.leaf?i(a):a)&&(t.leaf?r.push(a):p(e,s)?this._all(a,r):u.push(a));t=u.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!h(e,t))return!1;for(var i,n,o,a,s=[];t;){for(i=0,n=t.children.length;i<n;i++)if(o=t.children[i],h(e,a=t.leaf?r(o):o)){if(t.leaf||p(e,a))return!0;s.push(o)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=c([]),this},remove:function(e,t){if(!e)return this;for(var i,n,o,a,s=this.data,u=this.toBBox(e),l=[],h=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],i=h.pop(),a=!0),s.leaf&&-1!==(o=r(e,s.children,t)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!p(s,u)?n?(i++,s=n.children[i],a=!1):s=null:(l.push(s),h.push(i),i=0,n=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:a,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var o,a=r-t+1,s=this._maxEntries;if(a<=s)return i(o=c(e.slice(t,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(o=c([])).leaf=!1,o.height=n;var u,l,p,h,_=Math.ceil(a/s),f=_*Math.ceil(Math.sqrt(s));for(d(e,t,r,f,this.compareMinX),u=t;u<=r;u+=f)for(d(e,u,p=Math.min(u+f-1,r),_,this.compareMinY),l=u;l<=p;l+=_)h=Math.min(l+_-1,p),o.children.push(this._build(e,l,h,n-1));return i(o,this.toBBox),o},_chooseSubtree:function(e,t,r,i){for(var n,o,a,s,l,p,h,c,d,_;i.push(t),!t.leaf&&i.length-1!==r;){for(h=c=1/0,n=0,o=t.children.length;n<o;n++)l=u(a=t.children[n]),d=e,_=a,(p=(Math.max(_.maxX,d.maxX)-Math.min(_.minX,d.minX))*(Math.max(_.maxY,d.maxY)-Math.min(_.minY,d.minY))-l)<c?(c=p,h=l<h?l:h,s=a):p===c&&l<h&&(h=l,s=a);t=s||t.children[0]}return t},_insert:function(e,t,r){var i=this.toBBox,n=r?e:i(e),a=[],s=this._chooseSubtree(n,this.data,t,a);for(s.children.push(e),o(s,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)},_split:function(e,t){var r=e[t],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var a=this._chooseSplitIndex(r,o,n),s=c(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,i(r,this.toBBox),i(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(r,s)},_splitRoot:function(e,t){this.data=c([e,t]),this.data.height=e.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var i,o,a,s,l,p,h,c,d,_,f,g,m,y;for(p=h=1/0,i=t;i<=r-t;i++)d=o=n(e,0,i,this.toBBox),_=a=n(e,i,r,this.toBBox),void 0,void 0,void 0,void 0,f=Math.max(d.minX,_.minX),g=Math.max(d.minY,_.minY),m=Math.min(d.maxX,_.maxX),y=Math.min(d.maxY,_.maxY),s=Math.max(0,m-f)*Math.max(0,y-g),l=u(o)+u(a),s<p?(p=s,c=i,h=l<h?l:h):s===p&&l<h&&(h=l,c=i);return c},_chooseSplitAxis:function(e,t,r){var i=e.leaf?this.compareMinX:a,n=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,r,i)<this._allDistMargin(e,t,r,n)&&e.children.sort(i)},_allDistMargin:function(e,t,r,i){e.children.sort(i);var a,s,u=this.toBBox,p=n(e,0,t,u),h=n(e,r-t,r,u),c=l(p)+l(h);for(a=t;a<r-t;a++)s=e.children[a],o(p,e.leaf?u(s):s),c+=l(p);for(a=r-t-1;a>=t;a--)s=e.children[a],o(h,e.leaf?u(s):s),c+=l(h);return c},_adjustParentBBoxes:function(e,t,r){for(var i=r;i>=0;i--)o(t[i],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():i(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},t}.apply(null,i))||(e.exports=n)},1426:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.jsonAdapter={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,i){var n=new r(e.getPointX(t),e.getPointY(t),i),o=e.hasZ(t),a=e.hasM(t);return o&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new i(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new n(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new o(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var i=e.hasZ(t),n=e.hasM(t),o=new a(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(i){var s=e.getZExtent(t);o.zmin=s.vmin,o.zmax=s.vmax}if(n){var u=e.getMExtent(t);o.mmin=u.vmin,o.mmax=u.vmax}return o}};var r=function(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0},i=function(e,t,r,i){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},n=function(e,t,r,i){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},o=function(e,t,r,i){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),i&&(this.hasM=i)},a=function(e,t,r,i,n){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=i,this.spatialReference=n,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}.apply(null,i))||(e.exports=n)},1439:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(128),r(25),r(4),r(14)],void 0===(n=function(e,t,i,n,o,a){var s,u,l,p,h,c;function d(e){function r(e,t,r){e[t]=r(e[t])}t._pe=e,u.init(),l.init(),p.init(),h.init(),c.init(),t.PeGCSExtent=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),r.prototype.destroy=function(){t._pe.destroy(this)},r}(t._pe.PeGCSExtent);for(var n=0,o=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];n<o.length;n++)r(o[n].prototype,"getName",(function(e){return function(){return e.call(this,new Array(u.PE_NAME_MAX))}}));for(var a=0,s=[t._pe.PeGeogtran,t._pe.PeProjcs];a<s.length;a++)r(s[a].prototype,"getParameters",(function(e){return function(){for(var r=new Array(u.PE_PARM_MAX),i=e.call(this),n=0;n<r.length;n++){var o=t._pe.getValue(i,"*");r[n]=o?t._pe.wrapPointer(o,t._pe.PeParameter):null,i+=Int32Array.BYTES_PER_ELEMENT}return r}}));r(t._pe.PeHorizon.prototype,"getCoord",(function(e){return function(){var t=this.getSize();if(!t)return null;var r=[];return m(r,t,e.call(this)),r}})),r(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",(function(e){var r=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){var i=null,n=e.call(this);if(!t._pe.compare(n,t._pe.NULL)){i=[n];var o=this.getSteps();if(o>1)for(var a=t._pe.getPointer(n),s=1;s<o;s++)i.push(t._pe.wrapPointer(a+r*s,t._pe.PeGTlistExtendedGTs))}return i}}));var d=t._pe._pe_getPeHorizonSize(),_=function(e){return function(){var r=this._cache;if(r||(r=new Map,this._cache=r),r.has(e))return r.get(e);var i=null,n=e.call(this);if(!t._pe.compare(n,t._pe.NULL)){i=[n];var o=n.getNump();if(o>1)for(var a=t._pe.getPointer(n),s=1;s<o;s++)i.push(t._pe.wrapPointer(a+d*s,t._pe.PeHorizon))}return r.set(e,i),i}};r(t._pe.PeProjcs.prototype,"horizonGcsGenerate",_),r(t._pe.PeProjcs.prototype,"horizonPcsGenerate",_),t._pe.PeObject.prototype.toString=function(e){void 0===e&&(e=u.PE_STR_OPTS_NONE),t._pe.ensureCache.prepare();var r=t._pe.getPointer(this),i=t._pe.ensureInt8(new Array(u.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(r,e,i))}}function _(e){if(e){var r=t._pe.getClass(e);if(r){var i=t._pe.getCache(r);if(i){var n=t._pe.getPointer(e);n&&delete i[n]}}}}function f(e,r){for(var i=[],n=new Array(r),o=0;o<e;o++)i.push(t._pe.ensureInt8(n));return i}function g(e){var t;return Array.isArray(e[0])?(t=[],e.forEach((function(e){t.push(e[0],e[1])}))):t=e,t}function m(e,r,i,n){if(void 0===n&&(n=!1),n)for(var o=0;o<2*r;o++)e[o]=t._pe.getValue(i+o*Float64Array.BYTES_PER_ELEMENT,"double");else{var a=0===e.length;for(o=0;o<r;o++)a&&(e[o]=new Array(2)),e[o][0]=t._pe.getValue(i,"double"),e[o][1]=t._pe.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(t,"__esModule",{value:!0}),t._pe=null,t.isLoaded=function(){return!!t._pe},t.isSupported=function(){return!!o("esri-wasm")},t.load=function(){return s||(s=a.create((function(e,t){new Promise((function(e,t){r.e(89).then(function(){var t=[r(1567)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})).then((function(r){r({locateFile:function(e){return n.getAssetUrl("esri/geometry/support/"+e)},onAbort:function(e){t(new Error(e))}}).then((function(t){d(t),e()}))}))})))},function(e){function r(e,r,i){t._pe.ensureCache.prepare();var n=g(i),o=i===n,a=t._pe.ensureFloat64(n),s=t._pe._pe_geog_to_proj(t._pe.getPointer(e),r,a);return s&&m(i,r,a,o),s}function i(e,t,r){return n(e,t,r,0)}function n(e,r,i,n){t._pe.ensureCache.prepare();var o=g(i),a=i===o,s=t._pe.ensureFloat64(o),u=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),r,s,n);return u&&m(i,r,s,a),u}e.geogToProj=r,e.projGeog=function(e,t,n,o){switch(o){case u.PE_TRANSFORM_P_TO_G:return i(e,t,n);case u.PE_TRANSFORM_G_TO_P:return r(e,t,n)}return 0},e.projToGeog=i,e.projToGeogCenter=n}(t.PeCSTransformations||(t.PeCSTransformations={})),function(e){e.init=function(){e.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,e.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}}(u=t.PeDefs||(t.PeDefs={})),function(e){var r={},i={};function n(e,i){var n=null,a=r[e];if(a||(a={},r[e]=a),a.hasOwnProperty(String(i)))n=a[i];else{var s=t._pe.PeFactory.prototype.factoryByType(e,i);t._pe.compare(s,t._pe.NULL)||(n=s,a[i]=n)}return o(n)}function o(e){if(e){var r=e.getType();switch(r){case u.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case u.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case u.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:r&u.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}}return e}e.initialize=function(){t._pe.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return n(u.PE_TYPE_COORDSYS,e)},e.factoryByType=n,e.fromString=function(e,r){var n=null,a=i[e];if(a||(a={},i[e]=a),a.hasOwnProperty(r))n=a[r];else{var s=t._pe.PeFactory.prototype.fromString(e,r);t._pe.compare(s,t._pe.NULL)||(n=s,a[r]=n)}return o(n)},e.geogcs=function(e){return n(u.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return n(u.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return t._pe.PeFactory.prototype.getCode(e)},e.projcs=function(e){return n(u.PE_TYPE_PROJCS,e)},e.unit=function(e){return n(u.PE_TYPE_UNIT,e)}}(t.PeFactory||(t.PeFactory={})),t.PeGCSExtent=null,function(e){var r;e.init=function(){e.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,r=t._pe._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,i,n,o,a,s){var u=null,l=new t._pe.PeInteger(s);try{var p=t._pe.PeGTlistExtended.prototype.getGTlist(e,i,n,o,a,l);if((s=l.val)&&(u=[p],s>1))for(var h=t._pe.getPointer(p),c=1;c<s;c++)u.push(t._pe.wrapPointer(h+r*c,t._pe.PeGTlistExtendedEntry))}finally{t._pe.destroy(l)}return u}}(l=t.PeGTlistExtended||(t.PeGTlistExtended={})),function(e){e.destroy=function(e){if(e&&e.length){for(var r=0,i=e;r<i.length;r++){var n=i[r];_(n),n.getEntries().forEach((function(e){_(e);var t=e.getGeogtran();_(t),t.getParameters().forEach(_),[t.getGeogcs1(),t.getGeogcs2()].forEach((function(e){_(e);var t=e.getDatum();_(t),_(t.getSpheroid()),_(e.getPrimem()),_(e.getUnit())}))}))}t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}}}(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={})),function(e){e.geogToGeog=function(e,r,i,n,o){t._pe.ensureCache.prepare();var a=g(i),s=i===a,u=t._pe.ensureFloat64(a),l=0;n&&(l=t._pe.ensureFloat64(n));var p=t._pe._pe_geog_to_geog(t._pe.getPointer(e),r,u,l,o);return p&&m(i,r,u,s),p}}(t.PeGTTransformations||(t.PeGTTransformations={})),function(e){function r(e,r,i,n,o,a){var s,l;switch(t._pe.ensureCache.prepare(),e){case"dd":s=t._pe._pe_geog_to_dd,l=u.PE_DD_MAX;break;case"ddm":s=t._pe._pe_geog_to_ddm,l=u.PE_DDM_MAX;break;case"dms":s=t._pe._pe_geog_to_dms,l=u.PE_DMS_MAX}var p=0;r&&(p=t._pe.getPointer(r));var h=g(n),c=t._pe.ensureFloat64(h),d=f(i,l),_=s(p,i,c,o,t._pe.ensureInt32(d));if(_)for(var m=0;m<i;m++)a[m]=t._pe.UTF8ToString(d[m]);return _}function i(e,r,i,n,o){var a;switch(t._pe.ensureCache.prepare(),e){case"dd":a=t._pe._pe_dd_to_geog;break;case"ddm":a=t._pe._pe_ddm_to_geog;break;case"dms":a=t._pe._pe_dms_to_geog}var s=0;r&&(s=t._pe.getPointer(r));var u=n.map((function(e){return t._pe.ensureString(e)})),l=t._pe.ensureInt32(u),p=t._pe.ensureFloat64(new Array(2*i)),h=a(s,i,l,p);return h&&m(o,i,p),h}e.geog_to_dms=function(e,t,i,n,o){return r("dms",e,t,i,n,o)},e.dms_to_geog=function(e,t,r,n){return i("dms",e,t,r,n)},e.geog_to_ddm=function(e,t,i,n,o){return r("ddm",e,t,i,n,o)},e.ddm_to_geog=function(e,t,r,n){return i("ddm",e,t,r,n)},e.geog_to_dd=function(e,t,i,n,o){return r("dd",e,t,i,n,o)},e.dd_to_geog=function(e,t,r,n){return i("dd",e,t,r,n)}}(t.PeNotationDms||(t.PeNotationDms={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},e.geog_to_mgrs_extended=function(e,r,i,n,o,a,s){t._pe.ensureCache.prepare();var l=0;e&&(l=t._pe.getPointer(e));var p=g(i),h=t._pe.ensureFloat64(p),c=f(r,u.PE_MGRS_MAX),d=t._pe.ensureInt32(c),_=t._pe._pe_geog_to_mgrs_extended(l,r,h,n,o,a,d);if(_)for(var m=0;m<r;m++)s[m]=t._pe.UTF8ToString(c[m]);return _},e.mgrs_to_geog_extended=function(e,r,i,n,o){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var s=i.map((function(e){return t._pe.ensureString(e)})),u=t._pe.ensureInt32(s),l=t._pe.ensureFloat64(new Array(2*r)),p=t._pe._pe_mgrs_to_geog_extended(a,r,u,n,l);return p&&m(o,r,l),p}}(p=t.PeNotationMgrs||(t.PeNotationMgrs={})),function(e){e.geog_to_usng=function(e,r,i,n,o,a,s){t._pe.ensureCache.prepare();var l=0;e&&(l=t._pe.getPointer(e));var p=g(i),h=t._pe.ensureFloat64(p),c=f(r,u.PE_MGRS_MAX),d=t._pe.ensureInt32(c),_=t._pe._pe_geog_to_usng(l,r,h,n,o,a,d);if(_)for(var m=0;m<r;m++)s[m]=t._pe.UTF8ToString(c[m]);return _},e.usng_to_geog=function(e,r,i,n){t._pe.ensureCache.prepare();var o=0;e&&(o=t._pe.getPointer(e));var a=i.map((function(e){return t._pe.ensureString(e)})),s=t._pe.ensureInt32(a),u=t._pe.ensureFloat64(new Array(2*r)),l=t._pe._pe_usng_to_geog(o,r,s,u);return l&&m(n,r,u),l}}(t.PeNotationUsng||(t.PeNotationUsng={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS},e.geog_to_utm=function(e,r,i,n,o){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var s=g(i),l=t._pe.ensureFloat64(s),p=f(r,u.PE_UTM_MAX),h=t._pe.ensureInt32(p),c=t._pe._pe_geog_to_utm(a,r,l,n,h);if(c)for(var d=0;d<r;d++)o[d]=t._pe.UTF8ToString(p[d]);return c},e.utm_to_geog=function(e,r,i,n,o){t._pe.ensureCache.prepare();var a=0;e&&(a=t._pe.getPointer(e));var s=i.map((function(e){return t._pe.ensureString(e)})),u=t._pe.ensureInt32(s),l=t._pe.ensureFloat64(new Array(2*r)),p=t._pe._pe_utm_to_geog(a,r,u,n,l);return p&&m(o,r,l),p}}(h=t.PeNotationUtm||(t.PeNotationUtm={})),function(e){var r=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(i,n){var o,a;return void 0===n&&(n=e.PE_PCSINFO_OPTION_DOMAIN),r.has(i)&&(a=r.get(i))[n]&&(o=a[n]),o||(o=t._pe.PePCSInfo.prototype.generate(i,n),a||(a=[],r.set(i,a)),a[n]=o),o}}(c=t.PePCSInfo||(t.PePCSInfo={})),function(e){e.version_string=function(){return t._pe.PeVersion.prototype.version_string()}}(t.PeVersion||(t.PeVersion={})),t._init=d}.apply(null,i))||(e.exports=n)},1440:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1441)],void 0===(n=function(e,t,r){return function(){function e(e){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,e&&e.steps)for(var t=0,i=e.steps;t<i.length;t++){var n=i[t];n instanceof r?this.steps.push(n):this.steps.push(new r({wkid:n.wkid,wkt:n.wkt,isInverse:n.isInverse}))}}return e.cacheKey=function(e,t){return[void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join(",")},e.fromGE=function(t){for(var i=new e,n="",o=0,a=t.steps;o<a.length;o++){var s=a[o],u=r.fromGE(s);i.steps.push(u),n+=u.uid.toString()+","}return i._cached_projection={},i._gtlistentry=null,i._chain=n,i},e.prototype.getInverse=function(){var t=new e;t.steps=[];for(var r=this.steps.length-1;r>=0;r--){var i=this.steps[r];t.steps.push(i.getInverse())}return t},e.prototype.getGTListEntry=function(){for(var e="",t=0,r=this.steps;t<r.length;t++)e+=r[t].uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e),this._gtlistentry},e.prototype.assignCachedGe=function(t,r,i){this._cached_projection[e.cacheKey(t,r)]=i},e.prototype.getCachedGeTransformation=function(t,r){for(var i="",n=0,o=this.steps;n<o.length;n++)i+=o[n].uid.toString()+",";i!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=i);var a=this._cached_projection[e.cacheKey(t,r)];return void 0===a?null:a},e}()}.apply(null,i))||(e.exports=n)},1441:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){var r=0;return function(){function e(e){void 0===e&&(e=null),this.uid=r++,e?(this._wkt=void 0!==e.wkt?e.wkt:null,this._wkid=void 0!==e.wkid?e.wkid:-1,this._isInverse=void 0!==e.isInverse&&!0===e.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}return e.fromGE=function(t){var r=new e;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r},Object.defineProperty(e.prototype,"wkt",{get:function(){return this._wkt},set:function(e){this._wkt=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wkid",{get:function(){return this._wkid},set:function(e){this._wkid=e,this.uid=r++},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInverse",{get:function(){return this._isInverse},set:function(e){this._isInverse=e,this.uid=r++},enumerable:!0,configurable:!0}),e.prototype.getInverse=function(){var t=new e;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t},e}()}.apply(null,i))||(e.exports=n)},1442:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(15),r(675),r(677),r(246)],void 0===(n=function(e,t,r,i,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=n.enums.WGLVVFlag;function u(e){return{value:e.value,size:i.toPt(e.size)}}function l(e){return e.map((function(e){return u(e)}))}function p(e){if("string"==typeof e||"number"==typeof e)return i.toPt(e);var t=e;return{type:"size",expression:t.expression,stops:l(t.stops)}}t.getVisualVariableSizeValueRepresentationRatio=function(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e},t.stopToSizeStop=u,t.normalizeSizeStops=l,t.normalizeSizeElement=p,t.getVisualVariablesFields=function(e){var t=e&&e.length>0?{}:null;return t&&e.forEach((function(e){var r=e.type;e.field&&(t[r]=e.field)})),t};var h=function(e){for(var t=[],r=[],n=l(e),a=n.length,s=0;s<6;s++){var u=n[Math.min(s,a-1)];t.push(u.value),r.push(null==u.size?o.NAN_MAGIC_NUMBER:i.pt2px(u.size))}return{values:new Float32Array(t),sizes:new Float32Array(r)}};function c(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(n.Utils.isString(e.field)){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,i=0;i<8;++i){var o=r[Math.min(i,r.length-1)];t.values[i]=o.value,t.opacities[i]=o.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;var a=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(i=0;i<8;i++)t.values[i]=1/0,t.opacities[i]=a}return t}t.convertVisualVariables=function(e){var t=e&&e.length>0?{}:null,i=t?{}:null;if(!t)return{vvFields:t,vvRanges:i};for(var o=0,u=e;o<u.length;o++){var d=u[o],_=d.type;if(d.field&&(t[_]=d.field),"size"===_){i.size||(i.size={});var f=d;switch(n.getTypeOfSizeVisualVariable(f)){case s.SIZE_MINMAX_VALUE:i.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:p(f.minSize),maxSize:p(f.maxSize)};break;case s.SIZE_SCALE_STOPS:i.size.scaleStops={stops:l(f.stops)};break;case s.SIZE_FIELD_STOPS:if(f.levels){var g={};for(var m in f.levels)g[m]=h(f.levels[m]);i.size.fieldStops={type:"level-dependent",levels:g}}else i.size.fieldStops=r.__assign({type:"static"},h(f.stops));break;case s.SIZE_UNIT_VALUE:i.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation}}}else if("color"===_){var y=a.convertVisualVariables([d],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});if(!y)continue;i.color=y.color;for(var v=0;v<32;v+=4)n.color.premultiplyAlpha(i.color.colors,v,!0)}else if("opacity"===_)i.opacity=c(d);else if("rotation"===_){var P=d;i.rotation={type:P.rotationType}}}return{vvFields:t,vvRanges:i}}}.apply(null,i))||(e.exports=n)},1466:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(11),r(25),r(5),r(12),r(2),r(4),r(413),r(107),r(675),r(421),r(677),r(1442),r(14)],void 0===(n=function(e,t,i,n,o,a,s,u,l,p,h,c,d,_,f){Object.defineProperty(t,"__esModule",{value:!0});var g=a.getLogger("esri.views.layers.2d.features.support.AttributeStore"),m=c.debug.createDebugLogger(c.debug.DEBUG_ATTR_UPDATES,g);t.LOCAL_ID_TYPE_AGGREGATE=1;var y=function(e){return(2147483648&e)>>>31},v=function(e){return 2147483647&e};t.isAggregateId=function(e){return y(e)===t.LOCAL_ID_TYPE_AGGREGATE};var P=function(e,t){return function(r,i,n){var o;try{o=t(r,i,n)}catch(e){o=NaN}return(null===o||isNaN(o)||o===1/0)&&e||o}},x={sharedArrayBuffer:o("esri-shared-array-buffer"),oesTextureFloat:o("esri-webgl-texture-float"),maxTextureSize:o("esri-webgl-max-texture-size"),atomics:o("esri-atomics")},b=function(){function e(e,t,r,i){this.texelSize=4;var n=i.pixelType,o=i.layout,a=i.textureOnly;this.textureOnly=a||!1,this.pixelType=n,this._ctype=t,this.layout=o,this._resetRange(),this._shared=e,a||(this.data=this._initData(n,r,e,t))}return Object.defineProperty(e.prototype,"buffer",{get:function(){return u.andThen(this.data,(function(e){return e.buffer}))},enumerable:!0,configurable:!0}),e.prototype.getData=function(e,t){var r=v(e);return u.unwrap(this.data)[r*this.texelSize+t]},e.prototype.setData=function(e,t,r){var i=v(e),n=1<<t;0!=(this.layout&n)?(this.data[i*this.texelSize+t]=r,this.dirtyStart=Math.min(this.dirtyStart,i),this.dirtyEnd=Math.max(this.dirtyEnd,i)):g.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},e.prototype.lock=function(){5121===this.pixelType?this._shared&&x.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,1):o("esri-2d-debug")&&g.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array")},e.prototype.unlock=function(){5121===this.pixelType?this._shared&&x.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,0):o("esri-2d-debug")&&g.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array")},e.prototype.expand=function(e){if(!this.textureOnly){var t=this._initData(this.pixelType,e,this._shared,this._ctype),r=u.unwrap(this.data);t.set(r),this.data=t}},e.prototype.toMessage=function(){var e=this.dirtyStart,t=this.dirtyEnd,r=this.texelSize;if(e>t)return null;this._resetRange();var i=!(this._shared||"local"===this._ctype),n=this.pixelType,o=this.layout,a=u.unwrap(this.data);return a.slice?{start:e,end:t,data:i&&a.slice(e*r,(t+1)*r)||null,pixelType:n,layout:o}:i?{start:e,end:t,data:new(c.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,e*r,(t+1)*r)),pixelType:n,layout:o}:{start:e,end:t,data:null,pixelType:n,layout:o}},e.prototype._initData=function(e,t,r,i){for(var n=r&&"local"!==i?SharedArrayBuffer:ArrayBuffer,o=c.Utils.getPixelArrayCtor(e),a=new o(new n(t*t*4*o.BYTES_PER_ELEMENT)),s=0;s<a.length;s+=4)a[s+1]=255;return a},e.prototype._resetRange=function(){this.dirtyStart=2147483647,this.dirtyEnd=0},e}(),S=function(){function e(e){this._attributeComputeMap=new Map,this._blocks=new Array,this._idMap=new Map,this._localToObjectId=new Map,this._filters=new Array(c.definitions.MAX_FILTERS),this._freeTexelsList=[],this._abortController=l.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idCounter=1,this._idsToHighlight=new Set;var t=x.oesTextureFloat?5126:5121;m("Creating AttributeStore "+(x.sharedArrayBuffer?"with":"without")+" shared memory"),o("esri-2d-debug")&&x.sharedArrayBuffer&&!x.atomics&&g.warn("Browser supports SharedArrayBuffer but not Atomics. Rendering may be impacted"),this._client=e,this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:t,layout:15},{pixelType:t,layout:15}],this._blocks=this._blockDescriptors.map((function(){return null}))}return e.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(e.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0}),e.prototype.invalidateResources=function(){this._createResourcesPromise=null,this._abortController.abort(),this._abortController=l.createAbortController()},e.prototype.createLocalId=function(e,t){if(void 0===t&&(t=!1),!this._idMap.has(e)){var r=function(e,t){return((t?2147483648:0)|e)>>>0}(this._getFreeTexel(),t);this._idMap.set(e,-1===r?0:r),this._localToObjectId.set(r,e)}return this._idMap.get(e)},e.prototype.addLocalId=function(e){this._getBlock(0).setData(e,0,0),this._freeTexelsList.push(v(e))},e.prototype.removeLocalId=function(e){var t=this._idMap.get(e);return this._idMap.delete(e),this._localToObjectId.delete(t),t},e.prototype.freeLocalId=function(e){var t=this._idMap.get(e);o("esri-2d-debug")&&!t&&console.debug("Called freeLocalId for an invalid id"),this._getBlock(0).setData(t,0,0),this._idMap.delete(e),this._localToObjectId.delete(t),this._freeTexelsList.push(v(t))},e.prototype.getFeatureId=function(e){return this._localToObjectId.get(e)},e.prototype.getLocalId=function(e){return this._idMap.has(e)?this._idMap.get(e):null},e.prototype.setHighlight=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r,n,o,a,s,u=this;return i.__generator(this,(function(i){switch(i.label){case 0:for(this._getBlock(0).lock(),this._idsToHighlight.forEach((function(e){var t=u.getLocalId(e);if(t){var r=u._getBlock(0).getData(t,0);u._getBlock(0).setData(t,0,-2&r)}})),this._idsToHighlight.clear(),t=0,r=e;t<r.length;t++)n=r[t],this._idsToHighlight.add(n);for(o=0;o<e.length;o++)null!=(a=this.getLocalId(e[o]))&&(s=this._getBlock(0).getData(a,0),this._getBlock(0).setData(a,0,1|s));return this._getBlock(0).unlock(),[4,this.sendUpdates()];case 1:return i.sent(),[2]}}))}))},e.prototype.addHighlight=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return[2]}))}))},e.prototype.removeHighlight=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return[2]}))}))},e.prototype.updateFilters=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r,n,o,a,s=this;return i.__generator(this,(function(i){switch(i.label){case 0:return t=e.config,r=e.service,n=e.spatialReference,o=t.filters,a=o.map((function(t,i){return s._updateFilter(e,t,i,r,n)})),[4,l.all(a)];case 1:return i.sent(),[2]}}))}))},e.prototype.setAttributeBindings=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(r){switch(this._hasScaleExpr=!1,e.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return[2,this._bindVVEvaluators(e.visualVariables,t)];case"dot-density":return[2,this._bindDDEvaluators(e.attributes,t)];case"heatmap":break;default:g.error(new n("attribute-store","Found invalid renderer type: "+e))}return[2]}))}))},e.prototype.setData=function(e,t,r,i){this._getBlock(t).setData(e,r,i)},e.prototype.getData=function(e,t,r){return this._getBlock(t).getData(e,r)},e.prototype.getHighlightFlag=function(e){return this._idsToHighlight.has(e)?_.HIGHLIGHT_FLAG:0},e.prototype.setAttributeData=function(e,t,r,i){var n=this,o=e;this._getBlock(0).setData(o,0,this.getFilterFlags(t));var a=this._attributeComputeMap,u=x.oesTextureFloat?1:2;a.forEach((function(e,a){var l=a*u%4,p=Math.floor(a*u/4),h=n._getBlock(p+_.ATTRIBUTE_DATA_VV),d=e(t,{$view:i},r);if(x.oesTextureFloat)h.setData(o,l,d);else if(d===c.definitions.NAN_MAGIC_NUMBER)h.setData(o,l,255),h.setData(o,l+1,255);else{var f=s.clamp(Math.round(d),-32767,32766)+32768,g=255&f,m=(65280&f)>>8;h.setData(o,l,g),h.setData(o,l+1,m)}}))},e.prototype.sendUpdates=function(){var e=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=l.createResolver(),this._nextUpdate.promise;var t={blocks:this._blocks.map((function(e){return u.isSome(e)?e.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var r=function(){if(e._currUpdate=null,e._nextUpdate){var t=e._nextUpdate;e._nextUpdate=null,e.sendUpdates().then((function(){return t.resolve()}))}},i=e._client.update(t,e._signal).then(r).catch(r);return e._client.render(),i})).catch((function(t){return l.isAbortError(t)?(e._createResourcesPromise=null,e._createResources()):(g.error(new n("mapview-attribute-store","Encountered an error during client update",t)),l.resolve())})),this._currUpdate},e.prototype._createResources=function(){var e=this;if(u.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(_.ATTRIBUTE_DATA_ANIMATION),m("Initializing AttributeStore");var t={shared:x.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:u.mapMany(this._blocks,(function(e){return{textureOnly:e.textureOnly,buffer:e.buffer,pixelType:e.pixelType}}))},r=this._client.initialize(t,this._signal).catch((function(t){l.isAbortError(t)?e._createResourcesPromise=null:g.error(new n("mapview-attribute-store","Encountered an error during client initialization",t))}));return this._createResourcesPromise=r,r.then((function(){return u.isNone(e._createResourcesPromise)?e._createResources():void 0})),r},e.prototype._getBlock=function(e){var t=this._blocks[e];if(u.isSome(t))return t;m("Initializing AttributeBlock at index "+e);var r=x.sharedArrayBuffer,i=this._client.type,n=new b(r,i,this._size,this._blockDescriptors[e]);return this._blocks[e]=n,this._createResourcesPromise=null,n},e.prototype._expand=function(){if(this._size<x.maxTextureSize){var e=this._size<<=1;return m("Expanding block size to",e,this._blocks),u.forEachSome(this._blocks,(function(t){return t.expand(e)})),this._createResourcesPromise=null,this._size=e,0}return g.error(new n("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},e.prototype._getFreeTexel=function(){return this._freeTexelsList.length?this._freeTexelsList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++},e.prototype._updateFilter=function(e,r,n,o,a){return i.__awaiter(this,void 0,void 0,(function(){var s,l,p,h,c,d,_,f=this;return i.__generator(this,(function(i){switch(i.label){case 0:return s=this._filters[n],(u.isSome(s)&&s.hash)===JSON.stringify(r)?[2]:(l=1<<n+1,u.isNone(r)?(this._filters[n]=null,this._idMap.forEach((function(e){var t=f._getBlock(0).getData(e,0);f._getBlock(0).setData(e,0,t|l)})),[2]):[4,e.queryObjectIds(r)]);case 1:return p=i.sent(),r.hiddenIds&&r.hiddenIds.length&&(p=p.filter((function(e){return-1===r.hiddenIds.indexOf(e)}))),h=p.map((function(e){return f._idMap.get(e)})),[4,this._getFilter(n,o)];case 2:for(i.sent().update(r,a),this._getBlock(0).lock(),this._idMap.forEach((function(e){if(y(e)!==t.LOCAL_ID_TYPE_AGGREGATE){var r=f._getBlock(0).getData(e,0);f._getBlock(0).setData(e,0,r&~l)}})),c=0;c<h.length;c++)null!=(d=h[c])&&(_=this._getBlock(0).getData(d,0),this._getBlock(0).setData(d,0,_|l));return this._getBlock(0).unlock(),[2]}}))}))},e.prototype._getFilter=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var n,o,a;return i.__generator(this,(function(i){switch(i.label){case 0:return n=this._filters[e],u.isSome(n)?[2,n]:[4,new Promise((function(e,t){Promise.all([r.e(2),r.e(3),r.e(112)]).then(function(){var t=[r(1597)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return o=i.sent().default,a=new o({geometryType:t.geometryType,hasM:!1,hasZ:!1,timeInfo:t.timeInfo,fieldsIndex:new p(t.fields)}),this._filters[e]=a,[2,a]}}))}))},e.prototype.isVisible=function(e){return!!(2&this._getBlock(0).getData(e.localId,0))},e.prototype.getFilterFlags=function(e){for(var r,i=0,n=(r=e.localId,y(r)===t.LOCAL_ID_TYPE_AGGREGATE?254:255),o=0;o<this._filters.length;o++){var a=!!(n&1<<o),s=this._filters[o];i|=(!a||u.isNone(s)||s.check(e)?1:0)<<o}var l=this.getFeatureId(e.localId);return i<<1|this.getHighlightFlag(l)},e.prototype._bindVVEvaluators=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r=this;return i.__generator(this,(function(n){switch(n.label){case 0:return this._attributeComputeMap.clear(),u.isSome(e)?[4,l.all(e.map((function(e){return i.__awaiter(r,void 0,void 0,(function(){var r,n;return i.__generator(this,(function(i){switch(i.label){case 0:return r=c.Utils.getVVType(e.type),[4,this._createGetValueFunction(e,t)];case 1:return n=i.sent(),u.isSome(n)&&this._attributeComputeMap.set(r,n),[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},e.prototype._bindDDEvaluators=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,n,o,a=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this._attributeComputeMap.clear(),e.length>c.definitions.DOT_DENSITY_MAX_FIELDS&&g.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+c.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+e.length),[4,l.all(e.map((function(e){return a._createNormalizedFunction(e,t)})))];case 1:for(r=i.sent().map((function(e){return P(0,e)})),n=0;n<c.definitions.DOT_DENSITY_MAX_FIELDS;n++)(o=n<e.length&&r[n])?this._attributeComputeMap.set(n,o):this._attributeComputeMap.has(n)&&this._attributeComputeMap.delete(n);return[2]}}))}))},e.prototype._createGetValueFunction=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,n,o,a,s,u,l;return i.__generator(this,(function(i){switch(i.label){case 0:return"size"!==e.type?[3,2]:(r=c.getTypeOfSizeVisualVariable(e))===c.enums.WGLVVFlag.SIZE_SCALE_STOPS?[2,null]:(n=r===c.enums.WGLVVFlag.SIZE_UNIT_VALUE,o=n&&function(t){return f.getVisualVariableSizeValueRepresentationRatio(t,e.valueRepresentation)},a=P,s=[c.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t,o)]);case 1:return[2,a.apply(void 0,s.concat([i.sent()]))];case 2:return u=P,l=[c.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t)];case 3:return[2,u.apply(void 0,l.concat([i.sent()]))]}}))}))},e.prototype._createNormalizedFunction=function(e,t,r){return i.__awaiter(this,void 0,void 0,(function(){var o,a,s;return i.__generator(this,(function(i){switch(i.label){case 0:return(o=e.field)?"string"==typeof o?(a=e.normalizationField)?[2,function(e){if(e.attributes[o]&&e.attributes[a]){var t=e.attributes[o]/e.attributes[a];return r?r(t):t}}]:[2,r?function(e){return r(e.attributes[o])}:function(e){return e.attributes[o]}]:(g.error(new n("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof o)),[2,function(){}]):e.valueExpression?(this._hasScaleExpr=this._hasScaleExpr||-1!==e.valueExpression.indexOf("scale"),[4,h.createVVExpression(e.valueExpression,t.spatialReference,t.fields)]):[3,2];case 1:return s=i.sent(),[2,d.callWithOptimizedFeature.bind(null,s)];case 2:return g.error("Unable to create a normalized function for visual variable: "+e),[2,function(){}]}}))}))},e}();t.default=S}.apply(null,i))||(e.exports=n)},1467:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(15),r(422),r(687),r(35),r(417),r(40),r(34),r(240),r(424),r(29),r(685),r(76),r(76),r(675),r(675)],void 0===(n=function(e,t,r,i,n,o,a,s,u,l,p,h,c,d,_,f,g,m){Object.defineProperty(t,"__esModule",{value:!0});var y=Math.PI/180,v=o.mat2df32.create(),P=s.vec2f32.create(),x=l.create();t.getBounds=function(e,t,r,i,n,o,a){if(!i||!r.symbol)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var s=i;if(!c.isPoint(s)){p.getBoundsXY(e,s);var u=t[0];0===u&&(u=function(e){var t=0;switch(e.symbol.type){case"simple-fill":case"picture-fill":var r=e.symbol.outline;if(!r)return 0;t=r.width;break;case"simple-line":t=e.symbol.width;break;case"simple-marker":t=e.symbol.size;break;case"picture-marker":t=Math.max(e.symbol.width,e.symbol.height);break;case"text":var i=[0,0,0,0];R(i,e.symbol,e.mosaicItem);var n=Math.max(Math.abs(i[0]),Math.abs(i[1]));t=Math.max(i[2],i[3])+n;break;case"cim":case"expanded-cim":var o=g.CIMSymbolHelper.getEnvelope(e.symbol.data);t=Math.sqrt(o.width*o.width+o.height*o.height)}return t}(r),t[0]=u);var l=n*u/2;return e[0]-=l,e[1]-=l,e[2]+=l,e[3]+=l,e}var h=s.x,_=s.y;return"text"===r.symbol.type&&0===t[2]&&0===t[3]&&R(t,r.symbol,r.mosaicItem),function(e,t,r,i,n,o,a,s){var u;switch(i.type){case"simple-marker":case"picture-marker":u=I(t,r,i,o,a,0);break;case"text":u=A(t,r,i,n,o,0);break;case"cim":case"expanded-cim":u=O(t,r,i,o,a,0)}for(var l,p,h=0,c=0;c<u.rings[0].length-1;c++)l=(t-(p=u.rings[0][c])[0])*(t-p[0])+(r-p[1])*(r-p[1]),h=Math.max(h,l);h=Math.sqrt(h);var _=d.normalizeMapX(t-h,s),g=d.normalizeMapX(t+h,s);if(_>g){var m=f.getInfo(s);if(m){var y=m.valid;_=y[0],g=y[1]}}e[0]=_,e[1]=r-h,e[2]=g,e[3]=r+h}(e,h,_,r.symbol,t,n,o,a),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(r.unwrap(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var b=s.vec2f32.create(),S=s.vec2f32.create(),T=s.vec2f32.create(),M=s.vec2f32.create(),E=s.vec2f32.create(),w=s.vec2f32.create(),G=s.vec2f32.create();function I(e,t,r,o,s,u){var l,p,h=i.pt2px(r.xoffset),c=i.pt2px(r.yoffset),d=y*r.angle,_=y*u;switch(r.type){case"simple-marker":var f=r;l=p=i.pt2px(f.size);break;case"picture-marker":var g=r;l=i.pt2px(g.width),p=i.pt2px(g.height)}s<.04&&(o=.04*o/s);var m=n.mat2d.identity(v);n.mat2d.translate(m,m,a.vec2.set(P,e,t)),n.mat2d.rotate(m,m,_-d),n.mat2d.scale(m,m,a.vec2.set(P,o,-o)),n.mat2d.translate(m,m,a.vec2.set(P,h,-c));var x=[0,0];a.vec2.transformMat2d(x,a.vec2.set(P,-.5*l,-.5*p),m);var b=[0,0];a.vec2.transformMat2d(b,a.vec2.set(P,-.5*l,.5*p),m);var S=[0,0];a.vec2.transformMat2d(S,a.vec2.set(P,.5*l,-.5*p),m);var T=[0,0];return a.vec2.transformMat2d(T,a.vec2.set(P,.5*l,.5*p),m),{rings:[[x,S,T,b,x]]}}function O(e,t,r,o,s,u){var l=g.CIMSymbolHelper.getEnvelope(r.data);if(!l)return null;s<.04&&(o=.04*o/s);var p=i.pt2px(l.width),h=i.pt2px(l.height),c=i.pt2px(l.x),d=i.pt2px(l.y),_=0*y,f=y*u,m=n.mat2d.identity(v);n.mat2d.translate(m,m,a.vec2.set(P,e,t)),n.mat2d.rotate(m,m,f-_),n.mat2d.scale(m,m,a.vec2.set(P,o,o));var x=[0,0];a.vec2.transformMat2d(x,a.vec2.set(P,c,d+h),m);var b=[0,0];a.vec2.transformMat2d(b,a.vec2.set(P,c,d),m);var S=[0,0];a.vec2.transformMat2d(S,a.vec2.set(P,c+p,d+h),m);var T=[0,0];return a.vec2.transformMat2d(T,a.vec2.set(P,c+p,d),m),{rings:[[x,S,T,b,x]]}}function A(e,t,r,o,s,u){var l=i.pt2px(r.xoffset),p=i.pt2px(r.yoffset),h=y*r.angle,c=y*u,d=n.mat2d.identity(v);n.mat2d.translate(d,d,a.vec2.set(P,e,t)),n.mat2d.rotate(d,d,c),n.mat2d.scale(d,d,a.vec2.set(P,s,-s));var _=o[0]+o[2]/2,f=o[1]+o[3]/2;n.mat2d.translate(d,d,a.vec2.set(P,l,-p)),n.mat2d.translate(d,d,a.vec2.set(P,_,f)),n.mat2d.rotate(d,d,h),n.mat2d.translate(d,d,a.vec2.set(P,-_,-f));var g=[0,0];a.vec2.transformMat2d(g,a.vec2.set(P,o[0],o[1]),d);var m=[0,0];a.vec2.transformMat2d(m,a.vec2.set(P,o[0],o[1]+o[3]),d);var x=[0,0];a.vec2.transformMat2d(x,a.vec2.set(P,o[0]+o[2],o[1]),d);var b=[0,0];return a.vec2.transformMat2d(b,a.vec2.set(P,o[0]+o[2],o[1]+o[3]),d),{rings:[[g,x,b,m,g]]}}function R(e,t,r){if(!r||0===r.glyphMosaicItems.length)return e;var n=g.bidiText(t.text)[1],o=r.glyphMosaicItems,a=m.shapeGlyphs(o,n,{scale:i.pt2px(t.font.size)/24,angle:t.angle,xOffset:t.xoffset,yOffset:t.yoffset,hAlign:m.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),vAlign:m.alignmentUtils.getYAnchorDirection(t.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(t.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(t.lineHeight||1,4)),decoration:t.font.decoration||"none",isCIM:!1}).bounds;return e[0]=a.x-a.halfWidth,e[1]=a.y-a.halfHeight,e[2]=a.width,e[3]=a.height,e}t.isPointOnPolyline=function(e,t,r,i){a.vec2.set(T,t,r);for(var n,o,s,u,l,p,h,c,d,_=e.paths,f=1/0,g=0;g<_.length;g++){var m=_[g];if(!(m.length<2))for(var y=1;y<m.length;y++)n=m[y-1][0],s=m[y-1][1],o=m[y][0],u=m[y][1],l=Math.min(n,o)-i,p=Math.min(s,u)-i,h=Math.max(n,o)+i,c=Math.max(s,u)+i,t<l||t>h||r<p||r>c||(a.vec2.set(b,n,s),a.vec2.set(S,o,u),a.vec2.subtract(M,S,b),a.vec2.subtract(E,b,T),a.vec2.scale(w,M,a.vec2.dot(M,E)/a.vec2.dot(M,M)),a.vec2.subtract(G,E,w),f>(d=a.vec2.dot(G,G))&&(f=d))}return Math.sqrt(f)<=i},t.getMarkerSymbolBounds=I,t.getCIMMarkerBounds=O,t.getTextSymbolBounds=A,t.normalizeCentralMeridian=function(e){var t,r,i,n,o,a,s,u,l,d=null;if(!e)return null;if("mesh"===e.type)return e.toJSON();if(t=e.spatialReference,!(r=_.getInfo(t)))return e.toJSON();i=t.isWebMercator,n=N[a=i?102100:4326].maxX,o=N[a].minX,s=N[a].plus180Line,u=N[a].minus180Line;var f=e.toJSON();if(c.isPoint(f))l=U(f,n,o);else if(c.isMultipoint(f))f.points=f.points.map((function(e){return U(e,n,o)})),l=f;else if(c.isExtent(f))l=function(e,t){if(!t)return e;var r=function(e,t){var r,i=[],n=e.ymin,o=e.ymax,a=e.xmax-e.xmin,s=e.xmin,u=e.xmax,l=t.valid,p=l[0],h=l[1],c=(r=k(e.xmin,t)).x,d=r.frameId,_=(r=k(e.xmax,t)).x,f=r.frameId,g=c===_&&a>0;if(a>2*h){var m={xmin:s<u?c:_,ymin:n,xmax:h,ymax:o},y={xmin:p,ymin:n,xmax:s<u?_:c,ymax:o},v={xmin:0,ymin:n,xmax:h,ymax:o},P={xmin:p,ymin:n,xmax:0,ymax:o},x=[],b=[];C(m,v)&&x.push(d),C(m,P)&&b.push(d),C(y,v)&&x.push(f),C(y,P)&&b.push(f);for(var S=d+1;S<f;S++)x.push(S),b.push(S);i.push({extent:m,frameIds:[d]},{extent:y,frameIds:[f]},{extent:v,frameIds:x},{extent:P,frameIds:b})}else c>_||g?i.push({extent:{xmin:c,ymin:n,xmax:h,ymax:o},frameIds:[d]},{extent:{xmin:p,ymin:n,xmax:_,ymax:o},frameIds:[f]}):i.push({extent:{xmin:c,ymin:n,xmax:_,ymax:o},frameIds:[d]});return i}(e,t).map((function(e){return e.extent}));return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}(f,r);else if(c.isPolygon(f)||c.isPolyline(f)){var g=x;p.getBoundsXY(g,f);var m={xmin:g[0],ymin:g[1],xmax:g[2],ymax:g[3]},y=D(m.xmin,o)*(2*n),v=0===y?f:function(e,t){for(var r=0,i=function(e){return c.isPolygon(e)?e.rings:e.paths}(e);r<i.length;r++)for(var n=0,o=i[r];n<o.length;n++)o[n][0]+=t;return e}(f,y);m.xmin+=y,m.xmax+=y,h.extentIntersectsPolyline(m,s)&&m.xmax!==n||h.extentIntersectsPolyline(m,u)&&m.xmin!==o?d=v:l=v}else l=e.clone();return null!==d?(new B).cut(d,n):l},t.getTextSymbolSize=R;var N={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}};function D(e,t){return Math.ceil((e-t)/(2*t))}function k(e,t){var r,i=t.valid,n=i[0],o=i[1],a=2*o,s=0;return e>o?(e-=(r=Math.ceil(Math.abs(e-o)/a))*a,s=r):e<n&&(e+=(r=Math.ceil(Math.abs(e-n)/a))*a,s=-r),{x:e,frameId:s}}function C(e,t){var r=t.xmin,i=t.ymin,n=t.xmax,o=t.ymax;return z(e,r,i)&&z(e,r,o)&&z(e,n,o)&&z(e,n,i)}function z(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}function U(e,t,r){var i;if(Array.isArray(e))if((i=e[0])>t){var n=D(i,t);e[0]=i+n*(-2*t)}else i<r&&(n=D(i,r),e[0]=i+n*(-2*r));else(i=e.x)>t?(n=D(i,t),e.x+=n*(-2*t)):i<r&&(n=D(i,r),e.x+=n*(-2*r));return e}var B=function(){function e(){}return e.prototype.cut=function(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var i=r.length,n=-2*t,o=0;o<i;o++){var a=r[o];if(a&&a.length>=this.minPts){for(var s=[],u=0,l=a;u<l.length;u++){var p=l[u];s.push([p[0]+n,p[1]])}r.push(s)}}return this.closed?e.rings=r:e.paths=r,e},e}()}.apply(null,i))||(e.exports=n)},1488:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(9),r(145),r(132),r(1923),r(67),r(2),r(4),r(4),r(15),r(1),r(174),r(40),r(34),r(194),r(29),r(76),r(1397),r(446),r(720),r(675),r(677),r(1466),r(1634),r(1924),r(1925),r(1926),r(1467),r(1636)],void 0===(n=function(e,t,r,i,n,o,a,s,u,l,p,h,c,d,_,f,g,m,y,v,P,x,b,S,T,M,E,w,G,I,O){function A(e,t,r){if(r.has(e))return r.get(e);var i={tile:t,addedOrModified:[],removed:[]};return r.set(e,i),i}Object.defineProperty(t,"__esModule",{value:!0});var R=function(e){function t(t){var r=e.call(this,t)||this;return r._tiles=new Map,r._graphicStoreUpdate=!1,r._graphicsSet=new Set,r._matcher=l.resolve(null),r._tileUpdateSet=new Set,r._tilesToUpdate=new Map,r._graphicIdToAbortController=new Map,r._attached=!1,r._highlightIds=new Map,r._updatingGraphicsTimer=null,r.lastUpdateId=-1,r.updateRequested=!1,r.graphicUpdateHandler=r.graphicUpdateHandler.bind(r),r.addOrUpdateGraphic=r.addOrUpdateGraphic.bind(r),r._processAnalyzedGraphics=r._processAnalyzedGraphics.bind(r),r._graphicsChangeHandler=r._graphicsChangeHandler.bind(r),r}return r.__extends(t,e),t.prototype.initialize=function(){var e=this;this._tileStore=new M.default(this.view.featuresTilingScheme),this.container=new E.default(this.view.featuresTilingScheme),this._attributeStore=new T.default({type:"local",initialize:function(t){return l.resolve(e.container.attributeView.initialize(t))},update:function(t){return e.container.attributeView.requestUpdate(t)},render:function(){return e.container.requestRender()}}),this._graphicStore=new G.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,(function(t){e._attributeStore.createLocalId(t.uid),e._setFilterState(t.uid,t.visible)}),(function(t){e._attributeStore.freeLocalId(t.uid)})),this._graphicProcessingQueue=new w.default({process:this.addOrUpdateGraphic});var t=new b.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0);this._matcher=u.isSome(this.renderer)?b.createMatcher(t,null,this.renderer):b.createMatcher(t,null),this._meshFactory=new b.WGLMeshFactory(null,this.uid,null,t),this._templateStore=t,this.watch("renderer",(function(r){r&&(e._matcher=u.isSome(e.renderer)?b.createMatcher(t,null,e.renderer):b.createMatcher(t,null))})),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",(function(){e.graphics.items.length>0&&e._graphicsChangeHandler({target:e.graphics,added:e.graphics.items,removed:[],moved:[]}),e.handles.add(e.graphics.on("change",e._graphicsChangeHandler),"graphics"),e._attached=!0,e.notifyChange("updating")})),this.container.on("detach",(function(){e._graphicProcessingQueue&&e._graphicProcessingQueue.clear()}))},t.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating")),this.container.destroy(),this._set("graphics",null),this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null),this._graphicStore.clear(),this._tileStore.destroy(),this._attributeStore=null},Object.defineProperty(t.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(e,t){if(!this.view||!this.view.position)return l.resolve();var r=this.view.toMap(h.createScreenPoint(e,t));return this.searchFeatures(r).then((function(e){return e&&e.length?e[0]:null}))},t.prototype.searchFeatures=function(e,t){var r=this;return void 0===t&&(t=2),l.create((function(i){i(r._graphicStore.hitTest(e.x,e.y,t,r.view.state.resolution,r.view.state.rotation))}))},t.prototype.update=function(e){var t=e.state,r=this.view.featuresTilingScheme.getClosestInfoForScale(t.scale).level;this._graphicStore.updateLevel(r),this._tileStore.setViewState(t),this._graphicStoreUpdate=!0,this.updateRequested=!1},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())},t.prototype.processUpdate=function(e){this.updateRequested&&(this.updateRequested=!1,this.update(e))},t.prototype.graphicUpdateHandler=function(e){var t=e.graphic,r=e.property,i=e.newValue,n=t;switch(r){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(n,"update");break;case"visible":this._setFilterState(n.uid,i),this._attributeStore.sendUpdates()}},t.prototype.addHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(this._highlightIds.has(i)){var n=this._highlightIds.get(i);this._highlightIds.set(i,n+1)}else this._highlightIds.set(i,1)}this._updateHighlight()},t.prototype.removeHighlight=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];if(this._highlightIds.has(i)){var n=this._highlightIds.get(i)-1;0===n?this._highlightIds.delete(i):this._highlightIds.set(i,n)}}this._updateHighlight()},t.prototype._updateHighlight=function(){this._attributeStore.setHighlight(s.keysOfMap(this._highlightIds))},t.prototype._getIntersectingTiles=function(e){var t=this._graphicStore.getBounds(e);return t&&0!==f.width(t)&&0!==f.height(t)?this._tileStore.boundsIntersections(t):[]},t.prototype._updateTile=function(e){var t=this,r=e.tile,i=this._getGraphicsData(this._templateStore,r,e.addedOrModified);return this._processGraphics(r.key,i).then((function(i){return t._patchTile(r.key,{addOrUpdate:i,remove:e.removed}),i}))},t.prototype._patchTile=function(e,t){if(this._tiles.has(e)){var r=this._tiles.get(e);this.container.onTileData(r,t),this.container.requestRender()}},t.prototype._graphicsChangeHandler=function(e){var t=this;if(!this._graphicStoreUpdate){var r=this.view.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(r.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(r)}for(var n=e.added,o=e.removed,a=e.moved,s=this._tilesToUpdate,u=[],p=new Array(n.length),h=0;h<n.length;h++){var c=n[h];p[h]=c,this._graphicsSet.add(c),u.push(this.addGraphic(c))}for(var d=0,_=o;d<_.length;d++){var f=_[d];this._abortProcessingGraphic(f.uid);for(var g=0,m=this._getIntersectingTiles(f);g<m.length;g++){var y=m[g];A(y.key.id,y,s).removed.push(this._attributeStore.getLocalId(f.uid))}this._graphicsSet.delete(f),this._graphicStore.remove(f)}for(var v=0,P=a;v<P.length;v++)for(var x=P[v],b=0,S=this._getIntersectingTiles(x);b<S.length;b++)A((y=S[b]).key.id,y,s).addedOrModified.push(x);this._flipUpdatingGraphics(),l.all(u).then((function(){for(var e,r=0;r<p.length;r++){e=p[r];for(var i=0,n=t._getIntersectingTiles(e);i<n.length;i++){var o=n[i];A(o.key.id,o,s).addedOrModified.push(e)}}t._graphicStore.updateZ();var a=[];return s.forEach((function(e){return a.push(t._updateTile(e))})),l.all(a).then((function(){s.clear(),t.notifyChange("updating")}))})).catch((function(){s.clear(),t.notifyChange("updating")}))},t.prototype._getArcadeInfo=function(e){var t=(e.attributes?Object.keys(e.attributes):[]).map((function(t){return{name:t,alias:t,type:"string"==typeof e.attributes[t]?"esriFieldTypeString":"esriFieldTypeDouble"}}));return u.isNone(e.geometry)?null:{geometryType:m.getJsonType(e.geometry),spatialReference:_.fromJSON(e.geometry.spatialReference),fields:t}},t.prototype._getSymbolForGraphic=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(r){return u.isSome(e.symbol)?[2,e.symbol]:u.isSome(this.renderer)?[2,this.renderer.getSymbolAsync(e,{scale:this.view.scale,abortOptions:t})]:[2,this._getNullSymbol(e)]}))}))},t.prototype._getSymbolResources=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,n,o,a,s,u,p,h,c;return r.__generator(this,(function(r){switch(r.label){case 0:return this.container.stage?(i=this._getArcadeInfo(e),o=P.expandSymbol,[4,this._getSymbolForGraphic(e,t)]):[2,l.resolve(null)];case 1:return[4,o.apply(void 0,[r.sent(),i,t])];case 2:if("text"!==(n=r.sent()).type)return[3,4];for(a=[],s=n,u=b.bidiText(s.text)[0],p=0;p<u.length;p++)a.push(u.charCodeAt(p));return h={symbol:n.toJSON(),id:0,glyphIds:a},[4,this.container.getMaterialItems([h])];case 3:return c=r.sent()[0].mosaicItem,[2,{symbol:n,mosaicItem:c}];case 4:return[2,{symbol:n,mosaicItem:null}]}}))}))},t.prototype._projectAndNormalizeGeometry=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,i,n,o=this;return r.__generator(this,(function(r){return u.isNone(e.geometry)?[2,l.resolve(null)]:(t=e.geometry,m.isPolygon(t)?(i=t.rings,t.rings=i):m.isPolyline(t)?(n=t.paths,t.paths=n):m.isExtent(t)&&(t=d.fromExtent(t)),[2,v.checkProjectionSupport(t.spatialReference,this.view.spatialReference).then((function(){var e=I.normalizeCentralMeridian(t),r=v.project(e,t.spatialReference,o.view.spatialReference);return g.closeRingsAndFixWinding(r),r}))])}))}))},t.prototype._onTileUpdate=function(e){var t=y.getInfo(this.view.spatialReference);if(e.added&&e.added.length>0)for(var r=0,i=e.added;r<i.length;r++){var n=i[r];this._addNewTile(n,t)}if(e.removed&&e.removed.length>0)for(var o=0,a=e.removed;o<a.length;o++){var s=a[o];this._removeTile(s.key)}},t.prototype.addOrUpdateGraphic=function(e,t,r){return this._addOrUpdateGraphic(e,t,r)},t.prototype.addGraphic=function(e){var t=this;this._abortProcessingGraphic(e.uid);var r=p.createAbortController();this._graphicIdToAbortController.set(e.uid,r);var i={signal:r.signal};return this._addOrUpdateGraphic(e,"add",i).then((function(){t._graphicIdToAbortController.delete(e.uid)})).catch((function(r){if(t._graphicIdToAbortController.delete(e.uid),!l.isAbortError(r))throw r}))},t.prototype._addOrUpdateGraphic=function(e,t,r){var i=this,n=this._projectAndNormalizeGeometry(e),o=this._getSymbolResources(e,r);return l.all([n,o]).then((function(n){var o=n[0],a=n[1];return"add"===t?i._addProjectedGraphic(e,a,o):i._updateGraphic(e,a,o,r)}))},t.prototype._addProjectedGraphic=function(e,t,r){this._graphicsSet.has(e)&&this._graphicStore.add(e,t,r)},t.prototype._updateGraphic=function(e,t,r,i){var n=this;if(!this._graphicStore.has(e)||l.isAborted(i))return l.resolve();for(var o=this._graphicStore.update(e,t,r),s=o.oldBounds,u=o.newBounds,p=0===f.width(s)&&0===f.height(s),h=0===f.width(u)&&0===f.height(u),c=p?[]:this._tileStore.boundsIntersections(s),d=h?[]:this._tileStore.boundsIntersections(u),_=a.acquire(),g=0,m=c;g<m.length;g++){var y=m[g];_.set(y.key,{addOrUpdate:null,remove:[this._attributeStore.getLocalId(e.uid)]})}for(var v=0,P=d;v<P.length;v++){y=P[v];var x=this._getGraphicData(this._templateStore,y,e);if(_.has(y.key)){var b=_.get(y.key);b.remove.length=0,b.addOrUpdate=x}else _.set(y.key,{addOrUpdate:x,remove:null})}var S=[];return _.forEach((function(e,t){var r=n._processGraphics(t,e.addOrUpdate,i).then((function(r){n._patchTile(t,{addOrUpdate:r,remove:e.remove})}));S.push(r)})),a.release(_),l.all(S).then((function(){}))},t.prototype._addTile=function(e,t){var r=f.create();this.view.featuresTilingScheme.getTileBounds(r,e);var i=new b.WGLTile(e,r,!0),n={clear:!0,addOrUpdate:t,remove:[]};this._tiles.set(e,i),this.container.addChild(i),i.setData(n,!1,!1)},t.prototype._addNewTile=function(e,t){var r=this,i=this._graphicStore.queryTileData(this._templateStore,e);if(t)for(var n=Math.round((t.valid[1]-t.valid[0])/e.resolution),o=0,a=i;o<a.length;o++){var s=a[o];s.geometry&&m.isPoint(s.geometry)&&this._wrapPoints(s,n)}var u=e.key;this._tileUpdateSet.add(e.key),this.notifyChange("updating"),this._processGraphics(u,i).then((function(e){r._addTile(u,e),r._tileUpdateSet.delete(u),r.notifyChange("updating")})).catch((function(e){if(r._tileUpdateSet.delete(u),r.notifyChange("updating"),!l.isAbortError(e))throw e}))},t.prototype._removeTile=function(e){if(this._tiles.has(e)){var t=this._tiles.get(e);this.container.removeChild(t),t.destroy(),this._tiles.delete(e)}},t.prototype._setFilterState=function(e,t){var r=this._attributeStore.getLocalId(e),i=this._attributeStore.getHighlightFlag(e);this._attributeStore.setData(r,0,0,i|(t?S.FILTER_FLAG_0:0))},t.prototype._getGraphicsData=function(e,t,r){var i=y.getInfo(this.view.spatialReference),n=this._graphicStore.getGraphicsData(e,t,r);if(i)for(var o=Math.round((i.valid[1]-i.valid[0])/t.resolution),a=0,s=n;a<s.length;a++){var u=s[a];u.geometry&&m.isPoint(u.geometry)&&this._wrapPoints(u,o)}return n.sort((function(e,t){return e.insertAfter-t.insertAfter})),n},t.prototype._getGraphicData=function(e,t,r){var i=this._graphicStore.getGraphicData(e,t,r),n=[i],o=y.getInfo(this.view.spatialReference);if(o){var a=Math.round((o.valid[1]-o.valid[0])/t.resolution);i.geometry&&m.isPoint(i.geometry)&&this._wrapPoints(i,a)}return n},t.prototype._wrapPoints=function(e,t){var r=e.geometry;512===t?r.x<20?e.geometry={points:[[r.x,r.y],[t,0]]}:r.x>492&&(e.geometry={points:[[r.x,r.y],[-t,0]]}):r.x<-20?e.geometry={points:[[r.x,r.y],[t,0]]}:r.x>532&&(e.geometry={points:[[r.x,r.y],[-t,0]]})},t.prototype._processGraphics=function(e,t,i){return r.__awaiter(this,void 0,void 0,(function(){var n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return t&&t.length&&this._meshFactory?(n=this._meshFactory,[4,this._matcher.then((function(e){return n.analyze(t,e,null,null,i)}))]):[2,null];case 1:return o=r.sent(),this._attributeStore.sendUpdates(),[2,this._processAnalyzedGraphics(e,o)]}}))}))},t.prototype._processAnalyzedGraphics=function(e,t){for(var r=this._meshFactory,i=r.createMeshData(t.length),n=this._attributeStore,o=0,a=t;o<a.length;o++){var s=a[o];s.insertAfter=-1===s.insertAfter?-1:n.getLocalId(s.insertAfter),s.localId=n.getLocalId(s.attributes[this.uid]),r.write(i,s,null,null,e.level,null)}return b.TileData.fromMeshData(i)},t.prototype._abortProcessingGraphic=function(e){this._graphicIdToAbortController.has(e)&&this._graphicIdToAbortController.get(e).abort()},t.prototype._getNullSymbol=function(e){var t=e.geometry;return m.isPolyline(t)?x.errorPolylineSymbol2D:m.isPolygon(t)||m.isExtent(t)?x.errorPolygonSymbol2D:x.errorPointSymbol2D},t.prototype._flipUpdatingGraphics=function(){var e=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=setTimeout((function(){e._updatingGraphicsTimer=null,e.notifyChange("updating")}),160),this.notifyChange("updating")},r.__decorate([c.property()],t.prototype,"_graphicProcessingQueue",void 0),r.__decorate([c.property({constructOnly:!0})],t.prototype,"requestUpdateCallback",void 0),r.__decorate([c.property({constructOnly:!0})],t.prototype,"graphics",void 0),r.__decorate([c.property({dependsOn:["_graphicProcessingQueue.updating"]})],t.prototype,"updating",null),r.__decorate([c.property()],t.prototype,"view",void 0),r.__decorate([c.property()],t.prototype,"updateRequested",void 0),r.__decorate([c.subclass("esri.views.2d.layers.support.GraphicsView2D")],t)}(O.GraphicsView(n.HandleOwnerMixin(o.IdentifiableMixin(i))));t.default=R}.apply(null,i))||(e.exports=n)},1518:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(247),r(49),r(34),r(431),r(175)],void 0===(n=function(e,t,r,i,n,o,a){function s(e,t){var r=e.bounds,i=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&r[0]<=i[0]&&r[1]<=i[1]&&r[2]>=i[2]&&r[3]>=i[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=s,t.isChildOf=function(e,t){return s(t,e)};var u=function(){function e(e,t){this.bounds=n.create(),this.key=new a(0,0,0,0),this.objectIds=new Set,this.key.set(t);var r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.scale=r.scale,this.level=r.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extent",{get:function(){return i.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),i=r.acquire(),n=0;n<t.length;n++)i[n]=new e(this.tileInfoView,t[n]);return i},e.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=u,t.default=u}.apply(null,i))||(e.exports=n)},1634:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(38),r(25),r(1414),r(1518),r(434),r(175)],void 0===(n=function(e,t,r,i,n,o,a,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l={added:[],removed:[]},p=new Set,h=new u(0,0,0,0),c=function(e){function t(t){var r=e.call(this)||this;return r._tiles=new Map,r._index=o(9,n("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileScheme=t,r}return r.__extends(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.clear=function(){this._tiles.clear(),this._index.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var r="string"==typeof e?this.get(e):e;if(!r)return[];for(var i=t*r.resolution,n=r.bounds[0]-i,o=r.bounds[1]-i,a=r.bounds[2]+i,s=r.bounds[3]+i,u=[],l=0,p=this._index.search({minX:n,minY:o,maxX:a,maxY:s});l<p.length;l++){var h=p[l],c=h.bounds.slice();c[0]=Math.max(c[0],n),c[1]=Math.max(c[1],o),c[2]=Math.min(c[2],a),c[3]=Math.min(c[3],s),c[2]-c[0]>0&&c[3]-c[1]>0&&u.push({bounds:c,tile:h})}return u},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var r=t.spans,i=t.lodInfo,n=i.level;if(r.length>0)for(var o=0,u=r;o<u.length;o++)for(var c=u[o],d=c.row,_=c.colFrom,f=c.colTo,g=_;g<=f;g++){var m=h.set(n,d,i.normalizeCol(g),i.getWorldForColumn(g)).id;if(p.add(m),!this.has(m)){var y=new a.default(this.tileScheme,m);this._tiles.set(m,y),this._index.insert(y),this.tiles.push(y),l.added.push(y)}}for(var v=this.tiles.length-1;v>=0;v--)y=this.tiles[v],p.has(y.id)||(this._tiles.delete(y.id),this.tiles.splice(v,1),this._index.remove(y),l.removed.push(y));(l.added.length||l.removed.length)&&this.emit("update",l),s.pool.release(t),p.clear(),l.added.length=0,l.removed.length=0}},t}(i);t.default=c}.apply(null,i))||(e.exports=n)},1635:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(4),r(4),r(34),r(675)],void 0===(n=function(e,t,r,i,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this,t)||this;return r._rendererInfo=new a.WGLRendererInfo,r._attachedResolver=i.createResolver(),r.attributeView=new a.AttributeStoreView,r}return r.__extends(t,e),t.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(e){return e.destroy()})),this.attributeView.destroy()},t.prototype.whenAttached=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,this._attachedResolver.promise];case 1:return e.sent(),[2]}}))}))},t.prototype.setRendererInfo=function(e,t,r){this._rendererInfo.setInfo(e,t,r),this.requestRender()},t.prototype.getMaterialItems=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return e&&0!==e.length?[4,this.whenAttached()]:[2,null];case 1:return r.sent(),i=this.stage.painter.textureManager,o=e.map((function(e){return i.rasterizeItem(e.symbol,e.glyphIds,t)})),[4,n.all(o)];case 2:return[2,r.sent().map((function(t,r){return{id:e[r].id,mosaicItem:t}}))]}}))}))},t.prototype.onTileData=function(e,t){if(t.addOrUpdate&&"tileDisplayData"in t.addOrUpdate)e.setData(t,this.hasLabels,this.labelsVisible);else{var i=t.addOrUpdate&&a.TileData.decode(t.addOrUpdate),n=r.__assign(r.__assign({},t),{addOrUpdate:i});e.setData(n,this.hasLabels,this.labelsVisible)}this.contains(e)||this.addChild(e),this.requestRender()},t.prototype.onTileError=function(e){e.clear(),this.contains(e)||this.addChild(e)},t.prototype.renderChildren=function(t){this._rendererInfo.update(t.state),this.attributeView.bindTextures(this.stage.context),e.prototype.renderChildren.call(this,t)},t.prototype.createTile=function(e){var t=this._tileInfoView.getTileBounds(o.create(),e);return new a.WGLTile(e,t)},t.prototype.destroyTile=function(e){this.removeChild(e),e.destroy()},t.prototype.createRenderParams=function(t){return r.__assign(r.__assign({},e.prototype.createRenderParams.call(this,t)),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})},t.prototype.onAttach=function(){e.prototype.onAttach.call(this);var t=this.stage.context.capabilities;t.textureFloat,t.vao,this._attachedResolver()},t.prototype.onDetach=function(){e.prototype.onDetach.call(this),this._attachedResolver=i.createResolver()},t}(a.TileContainer);t.FeatureContainer=s}.apply(null,i))||(e.exports=n)},1636:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0}),t.GraphicsView=function(e){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.graphics=null,t.renderer=null,t.view=null,t}return r.__extends(t,e),r.__decorate([i.property()],t.prototype,"graphics",void 0),r.__decorate([i.property()],t.prototype,"renderer",void 0),r.__decorate([i.property()],t.prototype,"updating",void 0),r.__decorate([i.property()],t.prototype,"view",void 0),r.__decorate([i.subclass("esri.views.layers.GraphicsView")],t)}(e)}}.apply(null,i))||(e.exports=n)},1923:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(65)],void 0===(n=function(e,t,r){var i=function(){function e(e,t){void 0===e&&(e=50),void 0===t&&(t=50),this._pool=new r(Map,null,(function(e){return e.clear()}),t,e)}return e.prototype.acquire=function(){return this._pool.acquire()},e.prototype.release=function(e){this._pool.release(e)},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}(),n=new i(100);return i}.apply(null,i))||(e.exports=n)},1924:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(1635)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),Object.defineProperty(t.prototype,"hasLabels",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelsVisible",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype._renderGraphics=function(e,t){for(var r=0,i=this.children;r<i.length;r++){var n=i[r];n.isReady&&n.hasData&&(n.commitChanges(),e.context.setStencilFunction(514,n.stencilRef,255),n._displayList.replay(e,n,t))}},t.prototype.renderChildren=function(t){var r=t.painter;if(this.children.some((function(e){return e.hasData}))){e.prototype.renderChildren.call(this,t),this._renderGraphics(t);var i=r.effects.highlight;i.bind(t),this._renderGraphics(t,i.defines),i.draw(t),i.unbind()}},t}(i.FeatureContainer);t.default=n}.apply(null,i))||(e.exports=n)},1925:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(9),r(4),r(54),r(1)],void 0===(n=function(e,t,r,i,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=new Map,r._queueArray=[],r._onGoingGraphic=null,r._onGoingPromise=null,r._scheduledNextHandle=null,r._next=r._next.bind(r),r._finalize=r._finalize.bind(r),r}return r.__extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queueArray.length>0||null!==this._onGoingPromise},enumerable:!0,configurable:!0}),t.prototype.cancel=function(e){if(this._onGoingGraphic&&this._onGoingGraphic.graphic===e&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.has(e)){var t=this._queue.get(e);this._queue.delete(e);var r=this._queueArray.indexOf(t);this._queueArray.slice(r,1)}this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._queueArray.length=0,this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingGraphic&&this._onGoingGraphic.graphic===e},t.prototype.push=function(e,t){if(!this._queue.has(e)){var r={graphic:e,addOrUpdate:t};this._queueArray.push(r),this._queue.set(e,r),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this.reset()},t.prototype.reset=function(){var e=this._onGoingGraphic;if(e){var t=e.graphic,r=e.addOrUpdate;this.push(t,r)}},t.prototype._finalize=function(){this._onGoingGraphic=null,this._ongoingAbortController=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=o.schedule(this._next))},t.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var e=this._peek(),t=e.graphic,r=e.addOrUpdate,i=n.createAbortController();this._queue.delete(t),this._onGoingGraphic=e,this._onGoingPromise=this.process(t,r,{signal:i.signal}),this._ongoingAbortController=i,this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},t.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()},r.__decorate([a.property({readOnly:!0})],t.prototype,"length",null),r.__decorate([a.property({readOnly:!0})],t.prototype,"updating",null),r.__decorate([a.property({constructOnly:!0})],t.prototype,"process",void 0),r.__decorate([a.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],t)}(i);t.default=s}.apply(null,i))||(e.exports=n)},1926:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(0),r(25),r(15),r(71),r(1414),r(34),r(176),r(443),r(29),r(685),r(1927),r(1467)],void 0===(n=function(e,t,r,i,n,o,a,s,u,l,p,h,c,d){Object.defineProperty(t,"__esModule",{value:!0});var _={minX:0,minY:0,maxX:0,maxY:0},f=s.create(),g=[];function m(e,t,r,i,n){return _.minX=t,_.minY=r,_.maxX=i,_.maxY=n,e.search(_)}var y=function(){function e(e,t,r,n,s,u){this._graphics=n,this._onAdd=s,this._onRemove=u,this._index=a(9,i("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new Map,this._currentLevel=-1/0,this._tileInfoView=e,this._uidFieldName=r;var l=e.getClosestInfoForScale(t);l&&(this._currentLevel=l.level,this._resolution=this._tileInfoView.getTileResolution(l.level)),this._metersPerUnit=o.getMetersPerUnit(e.spatialReference)}return e.prototype.hitTest=function(e,t,r,i,o){e=h.normalizeMapX(e,this._tileInfoView.spatialReference);var a=.5*i*r;f[0]=e-a,f[1]=t-a,f[2]=e+a,f[3]=t+a;var c=.5*i*(r+50),_=m(this._index,e-c,t-c,e+c,t+c);if(!_||0===_.length)return[];for(var g,y={x:e,y:t},v=[],P=0,x=_;P<x.length;P++){var b=x[P];if(b.graphic.visible)switch(p.getJsonType(b.geometry)){case"esriGeometryPoint":var S=b.symbol;if(!S)continue;var T=b.geometry,M=void 0;switch(S.type){case"text":M=d.getTextSymbolBounds(T.x,T.y,S,b.size,i,o);break;case"cim":case"expanded-cim":M=d.getCIMMarkerBounds(T.x,T.y,S,i,i*this._metersPerUnit,o);break;default:M=d.getMarkerSymbolBounds(T.x,T.y,S,i,i*this._metersPerUnit,o)}u.polygonContainsPoint(M,y)&&v.push(b);break;case"esriGeometryPolyline":var E=b.symbol;if(!E)continue;g=1.5*i*window.devicePixelRatio*n.pt2px(E.width),d.isPointOnPolyline(b.geometry,e,t,g)&&v.push(b);break;case"esriGeometryEnvelope":var w=b.geometry,G=s.fromValues(w.xmin,w.ymin,w.xmax,w.ymax);s.intersects(G,f)&&v.push(b);break;case"esriGeometryPolygon":if(u.polygonContainsPoint(b.geometry,y)){v.push(b);break}var I=l.getPolygonExtent(b.geometry);if(Math.abs(I.ymax-I.ymin)<5*i||Math.abs(I.xmax-I.xmin)<5*i){var O=s.fromValues(I.xmin,I.ymin,I.xmax,I.ymax);s.intersects(O,f)&&v.push(b)}break;case"esriGeometryMultipoint":var A=b.symbol;if(!A)continue;for(var R=b.geometry.points,N=void 0,D=0;D<R.length;D++){if("text"===A.type){var k=A;N=d.getTextSymbolBounds(R[D][0],R[D][1],k,b.size,i,o)}else N=d.getMarkerSymbolBounds(R[D][0],R[D][1],A,i,i*this._metersPerUnit,o);if(u.polygonContainsPoint(N,y)){v.push(b);break}}}}return v.sort((function(e,t){var r=d.graphicGeometryToNumber(e.graphic),i=d.graphicGeometryToNumber(t.graphic);return r===i?t.zorder-e.zorder:r-i})),v.map((function(e){return e.graphic}))},e.prototype.getGraphicsData=function(e,t,i){var n=m(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);if(0===n.length||0===i.length)return[];n.sort((function(e,t){return e.zorder-t.zorder})),n[0].insertAfter=-1;for(var o=1;o<n.length;o++)n[o].insertAfter=n[o-1].graphic.uid;n.sort((function(e,t){return e.graphic.uid-t.graphic.uid})),i.sort((function(e,t){return e.uid-t.uid}));for(var a,s=0,u=0,l=[],p={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},h=0,d=i;h<d.length;h++){var _=d[h];for(u=-2;s<n.length;)if(a=n[s],s++,_.uid===a.graphic.uid){u=a.insertAfter;break}if(a.geometry&&-2!==u){var f=a.getGeometryQuantized(p),g=r.__assign({},a.graphic.attributes);g[this._uidFieldName]=_.uid,null==a.groupId&&(a.groupId=e.createTemplateGroup(a.symbol,null,null)),l.push({centroid:c.default.getCentroidQuantized(a,p),geometry:f,attributes:g,symbol:a.symbol,groupId:a.groupId,insertAfter:u})}}return l},e.prototype.getGraphicData=function(e,t,i){var n=this._itemByGraphic.get(i);if(!n)return null;var o=m(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);o.sort((function(e,t){return e.zorder-t.zorder}));var a=o.indexOf(n),s=0===a||-1===a?-1:o[a-1].graphic.uid,u={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},l=n.getGeometryQuantized(u),p=r.__assign({},n.graphic.attributes);return p[this._uidFieldName]=i.uid,null==n.groupId&&(n.groupId=e.createTemplateGroup(n.symbol,null,null)),{centroid:c.default.getCentroidQuantized(n,u),geometry:l,attributes:p,symbol:n.symbol,groupId:n.groupId,insertAfter:s}},e.prototype.queryTileData=function(e,t){var r=50*t.resolution,i=s.pad(t.bounds,r,s.create()),n=m(this._index,i[0],i[1],i[2],i[3]),o=[];return this._createTileGraphics(o,e,n,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),o},e.prototype.has=function(e){return this._itemByGraphic.has(e)},e.prototype.getBounds=function(e){return this._itemByGraphic.has(e)?this._itemByGraphic.get(e).bounds:null},e.prototype.add=function(e,t,r){if(e){this._onAdd(e);var i=c.default.acquire(e,t,r,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);return this._itemByGraphic.set(e,i),r&&this._index.insert(i),i.bounds}},e.prototype.remove=function(e){if(this._itemByGraphic.has(e)){this._onRemove(e);var t=this._itemByGraphic.get(e);this._index.remove(t),this._itemByGraphic.delete(e)}},e.prototype.updateZ=function(){for(var e,t,r=this._graphics.items,i=0;i<r.length;i++)t=r[i],(e=this._itemByGraphic.get(t))&&(e.zorder=i)},e.prototype.update=function(e,t,r){var i=this._itemByGraphic.get(e);i.groupId=null;var n=s.clone(i.bounds);return i.size[0]=i.size[1]=0,this._index.remove(i),i.set(e,t,r,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),r&&this._index.insert(i),{oldBounds:n,newBounds:i.bounds}},e.prototype.updateLevel=function(e){var t=this;if(this._currentLevel!==e){this._currentLevel=e;var r=this._tileInfoView.getTileResolution(e);this._resolution=r,this._index.clear(),g.length=0,this._itemByGraphic.forEach((function(e){e.updateBounds(t._resolution,t._resolution*t._metersPerUnit,t._tileInfoView.spatialReference),e.geometry&&g.push(e)})),this._index.load(g)}},e.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},e.prototype._createTileGraphics=function(e,t,i,n){var o,a,s,u,l=this._uidFieldName;i.sort((function(e,t){return e.zorder-t.zorder}));for(var p=0;p<i.length;p++){o=(s=i[p]).graphic,a=s.getGeometryQuantized(n),u=0===p?-1:i[p-1].graphic.uid;var h=r.__assign({},s.graphic.attributes);h[l]=o.uid,null==s.groupId&&(s.groupId=t.createTemplateGroup(s.symbol,null,null)),e.push({centroid:c.default.getCentroidQuantized(s,n),geometry:a,attributes:h,symbol:s.symbol,groupId:s.groupId,insertAfter:u})}},e}();t.default=y}.apply(null,i))||(e.exports=n)},1927:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(34),r(455),r(29),r(316),r(412),r(414),r(1467)],void 0===(n=function(e,t,r,i,n,o,a,s,u,l){Object.defineProperty(t,"__esModule",{value:!0});var p=new u.default,h=new u.default;function c(e){e.coords.length=0,e.lengths.length=0}var d=function(){function e(){this.bounds=i.create(),this.graphic=null,this.size=[0,0,0,0]}return e.acquire=function(t,r,i,n,o,a){var s;return void 0===t&&(t=null),0===e._pool.length?s=new e:(s=e._pool.pop(),this._set.delete(s)),s.acquire(t,r,i,n,o,a),s},e.release=function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))},e.getCentroidQuantized=function(e,t){if(o.isPolygon(e.geometry)){var i=e.symbol;if(r.isNone(i))return null;if(l.isMarkerSymbol(i.type)){var s=n.polygonCentroid(e.geometry);return a.quantizePoint(t,{},{x:s[0],y:s[1]},!1,!1)}}return null},e.prototype.acquire=function(e,t,r,i,n,o){void 0===e&&(e=null),e&&this.set(e,t,r,i,n,o)},e.prototype.release=function(){this.graphic=null,this.symbolResource=null,this.geometry=null},Object.defineProperty(e.prototype,"symbol",{get:function(){return this.symbolResource.symbol},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t,r,i,n,o){this.graphic=e,this.geometry=r,this.symbolResource=t,this.updateBounds(i,n,o)},e.prototype.updateBounds=function(e,t,r){l.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,e,t,r)},e.prototype.getGeometryQuantized=function(e){if(o.isPolygon(this.geometry)){var t=this.geometry.rings;if(1===t.length&&2===t[0].length)return a.quantizeGeometry(e,{paths:[[t[0][0],t[0][1]]]})}else if(o.isPolyline(this.geometry))return c(p),c(h),s.convertFromPolyline(p,this.geometry),s.generalizeOptimizedGeometry(h,p,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",e.scale[0]),s.quantizeOptimizedGeometry(p,h,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",e),s.convertToPolyline(p,this.geometry.hasZ,this.geometry.hasM);return a.quantizeGeometry(e,this.geometry)},e._pool=[],e._set=new Set,e}();t.default=d}.apply(null,i))||(e.exports=n)}}]);