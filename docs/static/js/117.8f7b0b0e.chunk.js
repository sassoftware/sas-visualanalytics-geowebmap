(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[117],{1115:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var r=a(8),n=a.n(r),i=a(15),s=a(3),u=a(4),c=a(47),o=a(44),p=a(6),l=a(7),d=a(0),f=a(20),h=a(2),b=a(1),m=(a(17),a(18),a(16),a(9)),y=a(56),v=a(200),x=a(163),j=a(942),w=function(e){var t=function(e){Object(p.a)(a,e);var t=Object(l.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.apply(this,arguments)).view=null,e}return Object(u.a)(a,[{key:"fetchPopupFeatures",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a){var r,i,s,u,c,o,p,l,d,b,m;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.layer,t){e.next=3;break}throw new f.a("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r});case 3:if(i=r.popupEnabled,s=Object(j.a)(r,a),i&&Object(h.k)(s)){e.next=6;break}throw new f.a("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:i,popupTemplate:s});case 6:return e.next=8,s.getRequiredFields();case 8:return u=e.sent,(c=new x.a).timeExtent=this.timeExtent,c.geometry=t,c.outFields=u,c.outSpatialReference=t.spatialReference,o=this.view.resolution,p="2d"===this.view.type?new y.a(o,o,this.view.spatialReference):new y.a(.5*o,.5*o,this.view.spatialReference),l=s.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},d=l.returnTopmostRaster,b=l.showNoDataRecords,m={returnDomainValues:!0,returnTopmostRaster:d,pixelSize:p,showNoDataRecords:b,signal:Object(h.k)(a)?a.signal:null},e.abrupt("return",r.queryVisibleRasters(c,m).then((function(e){return e})));case 13:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e;return!!Object(c.a)(Object(o.a)(a.prototype),"canResume",this).call(this)&&(null==(e=this.timeExtent)||!e.isEmpty)}}]),a}(e);return Object(d.a)([Object(b.b)()],t.prototype,"layer",void 0),Object(d.a)([Object(b.b)()],t.prototype,"suspended",void 0),Object(d.a)([Object(b.b)(v.a)],t.prototype,"timeExtent",void 0),Object(d.a)([Object(b.b)()],t.prototype,"view",void 0),t=Object(d.a)([Object(m.a)("esri.views.layers.ImageryLayerView")],t)}},1299:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return v}));var r=a(8),n=a.n(r),i=a(15),s=a(3),u=a(4),c=a(6),o=a(7),p=a(0),l=a(2),d=a(23),f=a(27),h=(a(1),a(17),a(18),a(16),a(9)),b=a(1089),m=a(1115),y=function(e){Object(c.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.apply(this,arguments)).type="imagery-3d",e.redrawDebounced=Object(d.j)(function(){var t=Object(i.a)(n.a.mark((function t(a){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.redraw((function(t,a){return e._redrawImage(t,a)}),a);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),2e3),e}return Object(u.a)(a,[{key:"initialize",value:function(){var e=this;this.handles.add([Object(f.k)(this.view.basemapTerrain,"ready",(function(){return e.initializeMaximumDataResolution()})),this.layer.on("redraw",(function(){return e.redrawDebounced()}))]),this.updatingHandles.add(this.layer,"exportImageServiceParameters.version",(function(){e.updatingHandles.addPromise(e.refreshDebounced())})),this.updatingHandles.add(this,"timeExtent",(function(){return e.updatingHandles.addPromise(e.refreshDebounced())}))}},{key:"initializeMaximumDataResolution",value:function(){var e=this.view.basemapTerrain.spatialReference,t=this.layer.fullExtent;t&&e.equals(t.spatialReference)&&(this.maximumDataResolution={x:this.layer.pixelSizeX,y:this.layer.pixelSizeY})}},{key:"getFetchOptions",value:function(){return{timeExtent:this.timeExtent}}},{key:"processResult",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.imageElement){e.next=4;break}t.image=a.imageElement,e.next=8;break;case 4:return t.image=document.createElement("canvas"),t.pixelData=a.pixelData,e.next=8,this._redrawImage(t,r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"_redrawImage",value:function(){var e=Object(i.a)(n.a.mark((function e(t,a){var r,i,s,u,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.image instanceof HTMLCanvasElement&&!Object(l.j)(t.pixelData)){e.next=2;break}return e.abrupt("return",Promise.reject());case 2:return r=t.image,i=r.getContext("2d"),e.next=6,this.layer.applyRenderer(t.pixelData,{signal:a});case 6:if(s=e.sent,u=this.layer.applyFilter(s).pixelBlock,!Object(l.j)(u)){e.next=10;break}return e.abrupt("return",Promise.reject());case 10:r.width=u.width,r.height=u.height,(c=i.createImageData(u.width,u.height)).data.set(u.getAsRGBA()),i.putImageData(c,0,0);case 13:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),a}(Object(m.a)(b.a)),v=y=Object(p.a)([Object(h.a)("esri.views.3d.layers.ImageryLayerView3D")],y)},942:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return o}));var r=a(8),n=a.n(r),i=a(35),s=a(15),u=a(2),c=a(81);function o(e){return p.apply(this,arguments)}function p(){return p=Object(s.a)(n.a.mark((function e(t){var a,r,s,o,p,l,d,f,h,b=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=b.length>1&&void 0!==b[1]?b[1]:t.popupTemplate,Object(u.k)(a)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,a.getRequiredFields(t.fieldsIndex);case 5:if(r=e.sent,s=a.lastEditInfoEnabled,o=t.objectIdField,p=t.typeIdField,l=t.globalIdField,d=t.relationships,!r.includes("*")){e.next=13;break}return e.abrupt("return",["*"]);case 13:if(!s){e.next=19;break}return e.next=16,Object(c.n)(t);case 16:e.t0=e.sent,e.next=20;break;case 19:e.t0=[];case 20:return f=e.t0,h=Object(c.j)(t.fieldsIndex,[].concat(Object(i.a)(r),Object(i.a)(f))),e.abrupt("return",(p&&h.push(p),h&&o&&t.fieldsIndex.has(o)&&-1===h.indexOf(o)&&h.push(o),h&&l&&t.fieldsIndex.has(l)&&-1===h.indexOf(l)&&h.push(l),d&&d.forEach((function(e){var a=e.keyField;h&&a&&t.fieldsIndex.has(a)&&-1===h.indexOf(a)&&h.push(a)})),h));case 23:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function l(e,t){return e.popupTemplate?e.popupTemplate:Object(u.k)(t)&&t.defaultPopupTemplateEnabled&&Object(u.k)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}}}]);
//# sourceMappingURL=117.8f7b0b0e.chunk.js.map