(this.webpackJsonpgeowebmap=this.webpackJsonpgeowebmap||[]).push([[134],{1307:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return I}));var r=i(8),a=i.n(r),n=i(15),o=i(3),l=i(4),s=i(47),c=i(44),u=i(6),h=i(7),f=i(0),b=i(20),d=i(16),p=i(27),v=i(1),y=(i(17),i(18),i(9)),m=i(693),g=i(722),O=i(686),j=i(908),w=d.a.getLogger("esri.views.3d.layers.WMTSLayerView3d"),x=function(e){Object(u.a)(i,e);var t=Object(h.a)(i);function i(){var e;return Object(o.a)(this,i),(e=t.apply(this,arguments)).type="wmts-3d",e}return Object(l.a)(i,[{key:"hasMixedImageFormats",get:function(){return!0}},{key:"initialize",value:function(){var e=this,t=Object(p.m)(this.view,"basemapTerrain.tilingSchemeDone").then((function(){var t=function(){return new b.a("layerview:no-compatible-tiling-scheme","None of the tiling schemes supported by the service are compatible with the scene.")};if(!e.view.basemapTerrain.tilingSchemeLocked)throw t();var i,r=e.view.basemapTerrain.tilingScheme,a=e.layer.activeLayer;if(a&&a.tileMatrixSet){var n=(i=a.tileMatrixSet).tileInfo,o=e._getTileInfoSupportError(n,i.fullExtent)||e._getTileInfoCompatibilityError(n,r);if(o)throw o}else{if(!(i=e._getCompatibleTileMatrixSet()))throw t();a.tileMatrixSetId=i.id}e._set("tileInfo",i.tileInfo),e._set("fullExtent",i.fullExtent),e.layer.fullExtent=i.fullExtent}));this.addResolvingPromise(t),this.when((function(){return e._initialized()}))}},{key:"refresh",value:function(){this.emit("data-changed")}},{key:"canResume",value:function(){if(!Object(s.a)(Object(c.a)(i.prototype),"canResume",this).call(this))return!1;var e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}},{key:"doRefresh",value:function(){var e=Object(n.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.suspended||this.emit("data-changed");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_initialized",value:function(){var e=this;this.updatingHandles.add(this,"layer.activeLayer.styleId",(function(){return e.refresh()})),this.updatingHandles.add(this,"tileMatrixSet",(function(){return e.refresh()})),this.updatingHandles.add(this.layer,"activeLayer",(function(t){var i=t.tileMatrixSet;if(i){var r=e._getTileInfoError(i.tileInfo,i.fullExtent);r&&(w.error("The selected tile matrix set is not compatible with the view",r),i=null)}else(i=e._getCompatibleTileMatrixSet())?t.tileMatrixSetId=i.id:w.error("The layer does not provide a tiling scheme that is compatible with the view");e.notifyChange("suspended"),e.canResume()&&e.refresh()}))}},{key:"_getCompatibleTileMatrixSet",value:function(){var e=this;return this.layer.activeLayer.tileMatrixSets.find((function(t){var i=t.tileInfo;return!e._getTileInfoError(i,t.fullExtent)}))}},{key:"_getTileInfoError",value:function(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}}]),i}(Object(j.a)(Object(g.a)(Object(m.a)(O.a))));Object(f.a)([Object(v.b)({readOnly:!0})],x.prototype,"hasMixedImageFormats",null),Object(f.a)([Object(v.b)()],x.prototype,"fullExtent",void 0),Object(f.a)([Object(v.b)()],x.prototype,"layer",void 0),Object(f.a)([Object(v.b)()],x.prototype,"suspended",void 0),Object(f.a)([Object(v.b)()],x.prototype,"tileInfo",void 0);var I=x=Object(f.a)([Object(y.a)("esri.views.3d.layers.WMTSLayerView3D")],x)},908:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(3),a=i(4),n=i(6),o=i(7),l=i(0),s=i(16),c=i(23),u=i(27),h=i(1),f=(i(17),i(18),i(9)),b=function(e){var t=function(e){Object(n.a)(i,e);var t=Object(o.a)(i);function i(){return Object(r.a)(this,i),t.apply(this,arguments)}return Object(a.a)(i,[{key:"initialize",value:function(){var e=this;this.handles.add(Object(u.b)(this,"layer","refresh",(function(){e.doRefresh().catch((function(t){Object(c.n)(t)||s.a.getLogger(e.declaredClass).error(t)}))})),"RefreshableLayerView")}}]),i}(e);return Object(l.a)([Object(h.b)()],t.prototype,"layer",void 0),t=Object(l.a)([Object(f.a)("esri.layers.mixins.RefreshableLayerView")],t)}}}]);
//# sourceMappingURL=134.c79e5028.chunk.js.map